OBJECT Codeunit 50018 Admin Mail Queue Service
{
  OBJECT-PROPERTIES
  {
    Date=08.04.15;
    Time=16:59:14;
    Modified=Yes;
    Version List=HME2101,GOB,T0002;
  }
  PROPERTIES
  {
    TableNo=472;
    OnRun=BEGIN
            AdminMailQueueSetup.GET;
            CheckAlive;
            CheckFinanceStat;

            //H0536,H0633 23.10.13  FF +++++++++++++++
            //Weekly
            CheckERPStat(CREATEDATETIME(CALCDATE('<-1W>',WORKDATE),000000T),CREATEDATETIME(CALCDATE('<-1D>',WORKDATE),235959T),6);
            COMMIT;

            //Monthly
            CheckERPStat(CREATEDATETIME(CALCDATE('<-1M>',WORKDATE),000000T),CREATEDATETIME(CALCDATE('<-1D>',WORKDATE),235959T),7);
            COMMIT;

            //Yesterday
            CheckERPStat(CREATEDATETIME(CALCDATE('<-1D>',WORKDATE),000000T),CREATEDATETIME(CALCDATE('<-1D>',WORKDATE),235959T),0);
            COMMIT;

            //Morning
            CheckERPStat(CREATEDATETIME(WORKDATE,000000T),CREATEDATETIME(WORKDATE,TIME),1);
            COMMIT;

            //Midday
            CheckERPStat(CREATEDATETIME(WORKDATE,000000T),CREATEDATETIME(WORKDATE,TIME),2);
            COMMIT;

            //Evening
            CheckERPStat(CREATEDATETIME(WORKDATE,000000T),CREATEDATETIME(WORKDATE,TIME),3);
            COMMIT;

            //Early Morning
            CheckERPStat(CREATEDATETIME(WORKDATE,000000T),CREATEDATETIME(WORKDATE,TIME),4);
            COMMIT;

            //Late Evening
            CheckERPStat(CREATEDATETIME(WORKDATE,000000T),CREATEDATETIME(WORKDATE,TIME),5);
            COMMIT;
            //H0536,H0633 23.10.13  FF ---------------

            CheckMonitoring;

            //H0633,H0669 23.10.13  FF +++++++++++++++
            COMMIT;

            CheckChangeLog;
            COMMIT;
            CheckOMModification;
            COMMIT;

            CheckRhenus;
            COMMIT;
            CheckDocData;
            COMMIT;
            CheckFTP;
            COMMIT;
            CheckRheDown;
            COMMIT;
            CheckDDDown;
            COMMIT;
            CheckPPLDown;
            COMMIT;
            CheckRheUp;
            COMMIT;
            CheckDDUp;
            COMMIT;
            CheckRheWhs;
            COMMIT;
            CheckDDWhs;
            COMMIT;
            //H0633,H0669 23.10.13  FF ---------------

            //H2101 24.03.15 MSL +++++++++
            CheckDHLTrackNos;
            COMMIT;
            //H2101 24.03.15 MSL ---------

            AdminMailQueueLog.RESET;
            AdminMailQueueLog.SETRANGE(Status,AdminMailQueueLog.Status::Unprocessed);
            IF AdminMailQueueLog.FINDSET THEN
              REPEAT
                CLEARLASTERROR;
                CLEAR(AdminMailQueueFunctions);
                COMMIT;
                IF AdminMailQueueFunctions.RUN(AdminMailQueueLog) THEN BEGIN
                  AdminMailQueueLogSucc := AdminMailQueueLog;
                  AdminMailQueueLogSucc.Status := AdminMailQueueLogSucc.Status::Processed;
                  AdminMailQueueLogSucc."Processing Date/Time" := CREATEDATETIME(WORKDATE,TIME);
                  AdminMailQueueLogSucc.MODIFY;
                END ELSE BEGIN
                  AdminMailQueueLogError := AdminMailQueueLog;
                  AdminMailQueueLogError.Status := AdminMailQueueLogError.Status::Error;
                  AdminMailQueueLogError."Error Text" := COPYSTR(GETLASTERRORTEXT,1,250);
                  AdminMailQueueLogError."Processing Date/Time" := CREATEDATETIME(WORKDATE,TIME);
                  AdminMailQueueLogError.MODIFY;
                END;
              UNTIL AdminMailQueueLog.NEXT = 0;
          END;

  }
  CODE
  {
    VAR
      AdminMailQueueSetup@1000000004 : Record 50092;
      AdminMailQueueLog@1000000000 : Record 50093;
      AdminMailQueueLogSucc@1000000003 : Record 50093;
      AdminMailQueueLogError@1000000001 : Record 50093;
      AdminMailQueueFunctions@1000000002 : Codeunit 50019;
      TeamLeader@1000000005 : TextConst 'ENU=arthur.berganski@home24.de';
      FPCGeneralSetup@1000000006 : Record 50055;

    PROCEDURE CheckMonitoring@1000000000();
    VAR
      ConnectorLogL@1000000000 : Record 5096052;
      AdminMailQueueLogL@1000000001 : Record 50093;
      SendNAVConnectorMailL@1000000026 : Boolean;
      AdminMailQueueSetupL@1000000038 : Record 50092;
      AdminMailQueueCodesL@1000000039 : Record 50118;
    BEGIN
      AdminMailQueueSetup.GET;
      SendNAVConnectorMailL := TRUE;

      IF CheckMailDowntime(AdminMailQueueSetupL."Monitoring Mail Code") = TRUE THEN
      //H0535  29.08.13  FF  +++++++++++++++++++++++++++++++++++++++++++++++
        //EXIT;
        SendNAVConnectorMailL := FALSE;
      //H0535  29.08.13  FF  -----------------------------------------------

      //NAV CONNECTOR Mail
      AdminMailQueueLogL.RESET;
      //A/gob-adb/18.04.13
      AdminMailQueueLogL.SETCURRENTKEY("Mail Code");
      //E/gob-adb/18.04.13
      AdminMailQueueLogL.SETRANGE("Mail Code",AdminMailQueueSetup."Monitoring Mail Code");
      IF AdminMailQueueLogL.FINDLAST THEN BEGIN
        IF (FORMAT(AdminMailQueueLogL."Processing Date/Time") = '') THEN
           SendNAVConnectorMailL := FALSE
        ELSE
           IF ((TIME < DT2TIME(AdminMailQueueLogL."Processing Date/Time")) AND (TIME < 010000T)) OR
              (ROUND(ABS(TIME - DT2TIME(AdminMailQueueLogL."Processing Date/Time"))/1000/60,1) < 20) THEN
             SendNAVConnectorMailL := FALSE;

      END;

      ConnectorLogL.RESET;
      IF ConnectorLogL.FINDLAST THEN BEGIN
      //H0329 30.04.13 PAU ++++++++++++++++++++++++++++++++++++++++++++++++
        IF ((TIME < 040000T) AND (ROUND(ABS(CREATEDATETIME(WORKDATE,TIME) - ConnectorLogL."Conducted at")/1000/60,1) < 120)) OR
           ((TIME < 080000T) AND (ROUND(ABS(CREATEDATETIME(WORKDATE,TIME) - ConnectorLogL."Conducted at")/1000/60,1) < 90)) OR
           (ROUND(ABS(CREATEDATETIME(WORKDATE,TIME) - ConnectorLogL."Conducted at")/1000/60,1) < 20) THEN
           SendNAVConnectorMailL := FALSE;
      //H0329 30.04.13 PAU ------------------------------------------------

        IF SendNAVConnectorMailL = TRUE THEN BEGIN
          AdminMailQueueFunctions.InitMail(AdminMailQueueSetup."Monitoring Mail Code",TeamLeader);
          AdminMailQueueFunctions.AddSubject('NAV CONNECTOR DOES NOT WORK!');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('Last Post by %1',ConnectorLogL."Conducted at"));
          AdminMailQueueFunctions.AddText(STRSUBSTNO('Idle since %1 Min.',
                                  ROUND(ABS(CREATEDATETIME(WORKDATE,TIME) - ConnectorLogL."Conducted at")/1000/60,1)));

          AdminMailQueueFunctions.FinishMail;
        END;
      END;
    END;

    PROCEDURE CheckAlive@1000000005();
    VAR
      AdminMailQueueLogL@1000000000 : Record 50093;
      AdminMailQueueCodesL@1000000001 : Record 50118;
      AdminMailQueueSetupL@1000000002 : Record 50092;
    BEGIN
      //H0473  06.08.13  FF  +++++++++++++++++++++++++++++++++++++++++++++++
      AdminMailQueueSetupL.GET;
      IF CheckMailDowntime(AdminMailQueueSetupL."Alive Mail Code") = TRUE THEN
        EXIT;
      //H0473  06.08.13  FF  -----------------------------------------------

      AdminMailQueueLogL.RESET;
      //A/gob-adb/18.04.13
      AdminMailQueueLogL.SETCURRENTKEY("Mail Code");
      //E/gob-adb/18.04.13
      AdminMailQueueLogL.SETRANGE("Mail Code",AdminMailQueueSetup."Alive Mail Code");
      IF AdminMailQueueLogL.FINDLAST THEN BEGIN
        IF FORMAT(AdminMailQueueLogL."Processing Date/Time") = '' THEN
          EXIT;

        IF (TIME < DT2TIME(AdminMailQueueLogL."Processing Date/Time")) AND (TIME < 010000T) THEN
          EXIT;

        IF ROUND(ABS(TIME - DT2TIME(AdminMailQueueLogL."Processing Date/Time"))/1000/60,1) < 120 THEN
          EXIT;

      END;

      AdminMailQueueFunctions.InitMail(AdminMailQueueSetup."Alive Mail Code",TeamLeader);
      AdminMailQueueFunctions.AddSubject('Job Queue is alive :-)');
      AdminMailQueueFunctions.AddText('Next post should come in 2 hours ...');
      AdminMailQueueFunctions.FinishMail;
    END;

    PROCEDURE CheckFinanceStat@1000000002();
    VAR
      AdminMailQueueLogL@1000000000 : Record 50093;
      eBayNavCXMLLogL@1000000036 : Record 5096060;
      eBayNavCSalesHeaderL@1000000035 : Record 5251571;
      eBayNavCSalesHeaderFilterL@1000000009 : Record 5251571;
      eBayNavCSalesLineL@1000000037 : Record 5251572;
      eBayNavCPaymentModuleL@1000000002 : Record 5251556;
      StartFullHourL@1000000039 : Time;
      EndFullHourL@1000000040 : Time;
      DurationL@1000000041 : Duration;
      DurationSecondL@1000000008 : Duration;
      CompareDateL@1000000038 : Date;
      ColumnCounter1L@1000000003 : Integer;
      ColumnCounter2L@1000000005 : Integer;
      "***Hour***********************"@1000000017 : Integer;
      HourOrderCounterL@1000000001 : ARRAY [2,7] OF Integer;
      HourOrderValueL@1000000004 : ARRAY [2,7] OF Decimal;
      HourOrderItemL@1000000006 : ARRAY [2,7] OF Integer;
      HourBPInvoiceL@1000000007 : ARRAY [2,7] OF Decimal;
      HourCreditcardL@1000000010 : ARRAY [2,7] OF Decimal;
      HourPrepayL@1000000012 : ARRAY [2,7] OF Decimal;
      HourPayPalL@1000000014 : ARRAY [2,7] OF Decimal;
      HourBPHireL@1000000016 : ARRAY [2,7] OF Decimal;
      "***Day************************"@1000000034 : Integer;
      DayOrderCounterL@1000000033 : ARRAY [2,7] OF Integer;
      DayOrderValueL@1000000031 : ARRAY [2,7] OF Decimal;
      DayOrderItemL@1000000029 : ARRAY [2,7] OF Integer;
      DayBPInvoiceL@1000000027 : ARRAY [2,7] OF Decimal;
      DayCreditcardL@1000000025 : ARRAY [2,7] OF Decimal;
      DayPrepayL@1000000023 : ARRAY [2,7] OF Decimal;
      DayPayPalL@1000000021 : ARRAY [2,7] OF Decimal;
      DayBPHireL@1000000019 : ARRAY [2,7] OF Decimal;
      AdminMailQueueCodesL@1000000011 : Record 50118;
      AdminMailQueueSetupL@1000000013 : Record 50092;
    BEGIN

      AdminMailQueueSetup.GET;
      //H0473  06.08.13  FF  +++++++++++++++++++++++++++++++++++++++++++++++
      IF CheckMailDowntime(AdminMailQueueSetup."Finance Stat. Mail Code") = TRUE THEN
        EXIT;
      //H0473  06.08.13  FF  -----------------------------------------------

      AdminMailQueueLogL.RESET;
      //A/gob-adb/18.04.13
      AdminMailQueueLogL.SETCURRENTKEY("Mail Code");
      //E/gob-adb/18.04.13
      AdminMailQueueLogL.SETRANGE("Mail Code",AdminMailQueueSetup."Finance Stat. Mail Code");
      IF AdminMailQueueLogL.FINDLAST THEN BEGIN

        IF (DT2TIME(ROUNDDATETIME(AdminMailQueueLogL."Processing Date/Time",1000*3600,'<')) =
             DT2TIME(ROUNDDATETIME(CREATEDATETIME(WORKDATE,TIME),1000*3600,'<'))) AND
             (DT2DATE(AdminMailQueueLogL."Processing Date/Time") = WORKDATE) THEN
          EXIT;

      END;

      //Get Values
      //Array Description:

      //[1,x] = Workdate
      //[2,x] = Last Week

      //[x,1] = DE
      //[x,2] = FR
      //[x,3] = NL
      //[x,4] = AU
      //[x,5] = CH
      //[x,6] = BE
      //[x,7] = IT

      CLEAR(HourOrderCounterL);
      CLEAR(HourOrderValueL);
      CLEAR(HourOrderItemL);
      CLEAR(HourBPInvoiceL);
      CLEAR(HourCreditcardL);
      CLEAR(HourPrepayL);
      CLEAR(HourPayPalL);
      CLEAR(HourBPHireL);
      CLEAR(DayOrderCounterL);
      CLEAR(DayOrderValueL);
      CLEAR(DayOrderItemL);
      CLEAR(DayBPInvoiceL);
      CLEAR(DayCreditcardL);
      CLEAR(DayPrepayL);
      CLEAR(DayPayPalL);
      CLEAR(DayBPHireL);

      DurationL       := 1000 * 3600;   //1 Hour
      DurationSecondL := 1000;      //1 Second


      IF (DT2TIME(ROUNDDATETIME(CURRENTDATETIME,1000*3600,'<'))) <> 000000T THEN BEGIN
        EndFullHourL := DT2TIME(ROUNDDATETIME(CURRENTDATETIME,1000*3600,'<'));
        StartFullHourL := EndFullHourL - DurationL;
        CompareDateL := CALCDATE('<-1W>',WORKDATE);
      END ELSE BEGIN
        EndFullHourL := (DT2TIME(ROUNDDATETIME(CURRENTDATETIME,1000*3600,'<'))) - DurationSecondL;
        StartFullHourL := EndFullHourL - DurationL + DurationSecondL;
        CompareDateL := CALCDATE('<-1W-1D>',WORKDATE);
      END;

      //Check Hour Today
      IF EndFullHourL <> 235959T THEN
        eBayNavCSalesHeaderFilterL.SETRANGE("Order Date",WORKDATE)
      ELSE
        eBayNavCSalesHeaderFilterL.SETRANGE("Order Date",CALCDATE('<-1D>',WORKDATE));

      eBayNavCSalesHeaderFilterL.SETRANGE("Order Time",StartFullHourL,EndFullHourL);

      IF eBayNavCSalesHeaderFilterL.FINDSET THEN

        REPEAT
          eBayNavCSalesHeaderL.SETRANGE("No.",eBayNavCSalesHeaderFilterL."No.");

          IF eBayNavCSalesHeaderL.FINDFIRST THEN
            BEGIN
              eBayNavCPaymentModuleL.GET(eBayNavCSalesHeaderL."Webshop Code",eBayNavCSalesHeaderL."Webshop Payment Module");
              CASE eBayNavCSalesHeaderL."Webshop Code" OF
                '1':
                  BEGIN
                    HourOrderCounterL[1,1] += 1;
                    HourOrderValueL[1,1] += eBayNavCSalesHeaderL."Sub Total Gross Amount";

                    eBayNavCSalesLineL.SETRANGE("Webshop Code",eBayNavCSalesHeaderL."Webshop Code");
                    eBayNavCSalesLineL.SETRANGE("Document No.",eBayNavCSalesHeaderL."No.");

                    HourOrderItemL[1,1] += eBayNavCSalesLineL.COUNT;

                    CASE eBayNavCPaymentModuleL."Payment Method Code" OF
                      'RATENKAUF':HourBPHireL[1,1] += 1;
                      'RECHNUNG': HourBPInvoiceL[1,1] += 1;
                      'KK': HourCreditcardL[1,1] += 1;
                      'FREE':;
                      'PP': HourPayPalL[1,1] += 1;
                      'VORK': HourPrepayL[1,1] += 1;
                      'GSVERK':;
                    END;
                  END;
                '2':
                  BEGIN
                    HourOrderCounterL[1,2] += 1;
                    HourOrderValueL[1,2] += eBayNavCSalesHeaderL."Sub Total Gross Amount";

                    eBayNavCSalesLineL.SETRANGE("Webshop Code",eBayNavCSalesHeaderL."Webshop Code");
                    eBayNavCSalesLineL.SETRANGE("Document No.",eBayNavCSalesHeaderL."No.");

                    HourOrderItemL[1,2] += eBayNavCSalesLineL.COUNT;

                    CASE eBayNavCPaymentModuleL."Payment Method Code" OF
                      'RATENKAUF':HourBPHireL[1,2] += 1;
                      'RECHNUNG': HourBPInvoiceL[1,2] += 1;
                      'KK': HourCreditcardL[1,2] += 1;
                      'FREE':;
                      'PP': HourPayPalL[1,2] += 1;
                      'VORK': HourPrepayL[1,2] += 1;
                      'GSVERK':;
                    END;
                  END;
                '3':
                  BEGIN
                    HourOrderCounterL[1,3] += 1;
                    HourOrderValueL[1,3] += eBayNavCSalesHeaderL."Sub Total Gross Amount";

                    eBayNavCSalesLineL.SETRANGE("Webshop Code",eBayNavCSalesHeaderL."Webshop Code");
                    eBayNavCSalesLineL.SETRANGE("Document No.",eBayNavCSalesHeaderL."No.");

                    HourOrderItemL[1,3] += eBayNavCSalesLineL.COUNT;

                    CASE eBayNavCPaymentModuleL."Payment Method Code" OF
                      'RATENKAUF':HourBPHireL[1,3] += 1;
                      'RECHNUNG': HourBPInvoiceL[1,3] += 1;
                      'KK': HourCreditcardL[1,3] += 1;
                      'FREE':;
                      'PP': HourPayPalL[1,3] += 1;
                      'VORK': HourPrepayL[1,3] += 1;
                      'GSVERK':;
                    END;
                  END;
                //H0149 10.01.13  FF +++++++++++++++++++++++++++

                '4':
                  BEGIN
                    HourOrderCounterL[1,4] += 1;
                    HourOrderValueL[1,4] += eBayNavCSalesHeaderL."Sub Total Gross Amount";

                    eBayNavCSalesLineL.SETRANGE("Webshop Code",eBayNavCSalesHeaderL."Webshop Code");
                    eBayNavCSalesLineL.SETRANGE("Document No.",eBayNavCSalesHeaderL."No.");

                    HourOrderItemL[1,4] += eBayNavCSalesLineL.COUNT;

                    CASE eBayNavCPaymentModuleL."Payment Method Code" OF
                      'RATENKAUF':HourBPHireL[1,4] += 1;
                      'RECHNUNG': HourBPInvoiceL[1,4] += 1;
                      'KK': HourCreditcardL[1,4] += 1;
                      'FREE':;
                      'PP': HourPayPalL[1,4] += 1;
                      'VORK': HourPrepayL[1,4] += 1;
                      'GSVERK':;
                    END;
                  END;
                //H0149 10.01.13  FF ---------------------------
                //H0901 27.02.14  FF +++++++++++++++++++++++++++
                '5':
                  BEGIN
                    HourOrderCounterL[1,5] += 1;
                    HourOrderValueL[1,5] += eBayNavCSalesHeaderL."Sub Total Gross Amount";

                    eBayNavCSalesLineL.SETRANGE("Webshop Code",eBayNavCSalesHeaderL."Webshop Code");
                    eBayNavCSalesLineL.SETRANGE("Document No.",eBayNavCSalesHeaderL."No.");

                    HourOrderItemL[1,5] += eBayNavCSalesLineL.COUNT;

                    CASE eBayNavCPaymentModuleL."Payment Method Code" OF
                      'RATENKAUF':HourBPHireL[1,5] += 1;
                      'RECHNUNG': HourBPInvoiceL[1,5] += 1;
                      'KK': HourCreditcardL[1,5] += 1;
                      'FREE':;
                      'PP': HourPayPalL[1,5] += 1;
                      'VORK': HourPrepayL[1,5] += 1;
                      'GSVERK':;
                    END;
                  END;
                //H0901 27.02.14  FF ---------------------------
                //H1244 09.07.14  FF +++++++++++++++++++++++++++
                '6':
                  BEGIN
                    HourOrderCounterL[1,6] += 1;
                    HourOrderValueL[1,6] += eBayNavCSalesHeaderL."Sub Total Gross Amount";

                    eBayNavCSalesLineL.SETRANGE("Webshop Code",eBayNavCSalesHeaderL."Webshop Code");
                    eBayNavCSalesLineL.SETRANGE("Document No.",eBayNavCSalesHeaderL."No.");

                    HourOrderItemL[1,6] += eBayNavCSalesLineL.COUNT;

                    CASE eBayNavCPaymentModuleL."Payment Method Code" OF
                      'RATENKAUF':HourBPHireL[1,6] += 1;
                      'RECHNUNG': HourBPInvoiceL[1,6] += 1;
                      'KK': HourCreditcardL[1,6] += 1;
                      'FREE':;
                      'PP': HourPayPalL[1,6] += 1;
                      'VORK': HourPrepayL[1,6] += 1;
                      'GSVERK':;
                    END;
                  END;
                //H1244 09.07.14  FF ---------------------------
                //H1663 17.10.14  FF +++++++++++++++++++++++++++
                '7':
                  BEGIN
                    HourOrderCounterL[1,7] += 1;
                    HourOrderValueL[1,7] += eBayNavCSalesHeaderL."Sub Total Gross Amount";

                    eBayNavCSalesLineL.SETRANGE("Webshop Code",eBayNavCSalesHeaderL."Webshop Code");
                    eBayNavCSalesLineL.SETRANGE("Document No.",eBayNavCSalesHeaderL."No.");

                    HourOrderItemL[1,7] += eBayNavCSalesLineL.COUNT;

                    CASE eBayNavCPaymentModuleL."Payment Method Code" OF
                      'RATENKAUF':HourBPHireL[1,7] += 1;
                      'RECHNUNG': HourBPInvoiceL[1,7] += 1;
                      'KK': HourCreditcardL[1,7] += 1;
                      'FREE':;
                      'PP': HourPayPalL[1,7] += 1;
                      'VORK': HourPrepayL[1,7] += 1;
                      'GSVERK':;
                    END;
                  END;
                //H1663 17.10.14  FF ---------------------------
              END;
            END;

        UNTIL eBayNavCSalesHeaderFilterL.NEXT = 0;

      //Check Hour Last Week
      eBayNavCSalesHeaderFilterL.SETRANGE("Order Date",CompareDateL);
      eBayNavCSalesHeaderFilterL.SETRANGE("Order Time",StartFullHourL,EndFullHourL);

      IF eBayNavCSalesHeaderFilterL.FINDSET THEN

        REPEAT
          eBayNavCSalesHeaderL.SETRANGE("No.",eBayNavCSalesHeaderFilterL."No.");

          IF eBayNavCSalesHeaderL.FINDFIRST THEN
            BEGIN
              eBayNavCPaymentModuleL.GET(eBayNavCSalesHeaderL."Webshop Code",eBayNavCSalesHeaderL."Webshop Payment Module");
              CASE eBayNavCSalesHeaderL."Webshop Code" OF
                '1':
                  BEGIN
                    HourOrderCounterL[2,1] += 1;
                    HourOrderValueL[2,1] += eBayNavCSalesHeaderL."Sub Total Gross Amount";

                    eBayNavCSalesLineL.SETRANGE("Webshop Code",eBayNavCSalesHeaderL."Webshop Code");
                    eBayNavCSalesLineL.SETRANGE("Document No.",eBayNavCSalesHeaderL."No.");

                    HourOrderItemL[2,1] += eBayNavCSalesLineL.COUNT;

                    CASE eBayNavCPaymentModuleL."Payment Method Code" OF
                      'RATENKAUF':HourBPHireL[2,1] += 1;
                      'RECHNUNG': HourBPInvoiceL[2,1] += 1;
                      'KK': HourCreditcardL[2,1] += 1;
                      'FREE':;
                      'PP': HourPayPalL[2,1] += 1;
                      'VORK': HourPrepayL[2,1] += 1;
                      'GSVERK':;
                    END;
                  END;
                '2':
                  BEGIN
                    HourOrderCounterL[2,2] += 1;
                    HourOrderValueL[2,2] += eBayNavCSalesHeaderL."Sub Total Gross Amount";

                    eBayNavCSalesLineL.SETRANGE("Webshop Code",eBayNavCSalesHeaderL."Webshop Code");
                    eBayNavCSalesLineL.SETRANGE("Document No.",eBayNavCSalesHeaderL."No.");

                    HourOrderItemL[2,2] += eBayNavCSalesLineL.COUNT;

                    CASE eBayNavCPaymentModuleL."Payment Method Code" OF
                      'RATENKAUF':HourBPHireL[2,2] += 1;
                      'RECHNUNG': HourBPInvoiceL[2,2] += 1;
                      'KK': HourCreditcardL[2,2] += 1;
                      'FREE':;
                      'PP': HourPayPalL[2,2] += 1;
                      'VORK': HourPrepayL[2,2] += 1;
                      'GSVERK':;
                    END;
                  END;
                '3':
                  BEGIN
                    HourOrderCounterL[2,3] += 1;
                    HourOrderValueL[2,3] += eBayNavCSalesHeaderL."Sub Total Gross Amount";

                    eBayNavCSalesLineL.SETRANGE("Webshop Code",eBayNavCSalesHeaderL."Webshop Code");
                    eBayNavCSalesLineL.SETRANGE("Document No.",eBayNavCSalesHeaderL."No.");

                    HourOrderItemL[2,3] += eBayNavCSalesLineL.COUNT;

                    CASE eBayNavCPaymentModuleL."Payment Method Code" OF
                      'RATENKAUF':HourBPHireL[2,3] += 1;
                      'RECHNUNG': HourBPInvoiceL[2,3] += 1;
                      'KK': HourCreditcardL[2,3] += 1;
                      'FREE':;
                      'PP': HourPayPalL[2,3] += 1;
                      'VORK': HourPrepayL[2,3] += 1;
                      'GSVERK':;
                    END;
                  END;

                '4':
                  BEGIN
                    HourOrderCounterL[2,4] += 1;
                    HourOrderValueL[2,4] += eBayNavCSalesHeaderL."Sub Total Gross Amount";

                    eBayNavCSalesLineL.SETRANGE("Webshop Code",eBayNavCSalesHeaderL."Webshop Code");
                    eBayNavCSalesLineL.SETRANGE("Document No.",eBayNavCSalesHeaderL."No.");

                    HourOrderItemL[2,4] += eBayNavCSalesLineL.COUNT;

                    CASE eBayNavCPaymentModuleL."Payment Method Code" OF
                      'RATENKAUF':HourBPHireL[2,4] += 1;
                      'RECHNUNG': HourBPInvoiceL[2,4] += 1;
                      'KK': HourCreditcardL[2,4] += 1;
                      'FREE':;
                      'PP': HourPayPalL[2,4] += 1;
                      'VORK': HourPrepayL[2,4] += 1;
                      'GSVERK':;
                    END;
                  END;
                //H0901, H1244, H1663 17.10.14  FF +++++++++++++++++++++++++++
                '5':
                  BEGIN
                    HourOrderCounterL[2,5] += 1;
                    HourOrderValueL[2,5] += eBayNavCSalesHeaderL."Sub Total Gross Amount";

                    eBayNavCSalesLineL.SETRANGE("Webshop Code",eBayNavCSalesHeaderL."Webshop Code");
                    eBayNavCSalesLineL.SETRANGE("Document No.",eBayNavCSalesHeaderL."No.");

                    HourOrderItemL[2,5] += eBayNavCSalesLineL.COUNT;

                    CASE eBayNavCPaymentModuleL."Payment Method Code" OF
                      'RATENKAUF':HourBPHireL[2,5] += 1;
                      'RECHNUNG': HourBPInvoiceL[2,5] += 1;
                      'KK': HourCreditcardL[2,5] += 1;
                      'FREE':;
                      'PP': HourPayPalL[2,5] += 1;
                      'VORK': HourPrepayL[2,5] += 1;
                      'GSVERK':;
                    END;
                  END;
                '6':
                  BEGIN
                    HourOrderCounterL[2,6] += 1;
                    HourOrderValueL[2,6] += eBayNavCSalesHeaderL."Sub Total Gross Amount";

                    eBayNavCSalesLineL.SETRANGE("Webshop Code",eBayNavCSalesHeaderL."Webshop Code");
                    eBayNavCSalesLineL.SETRANGE("Document No.",eBayNavCSalesHeaderL."No.");

                    HourOrderItemL[2,6] += eBayNavCSalesLineL.COUNT;

                    CASE eBayNavCPaymentModuleL."Payment Method Code" OF
                      'RATENKAUF':HourBPHireL[2,6] += 1;
                      'RECHNUNG': HourBPInvoiceL[2,6] += 1;
                      'KK': HourCreditcardL[2,6] += 1;
                      'FREE':;
                      'PP': HourPayPalL[2,6] += 1;
                      'VORK': HourPrepayL[2,6] += 1;
                      'GSVERK':;
                    END;
                  END;
                '7':
                  BEGIN
                    HourOrderCounterL[2,7] += 1;
                    HourOrderValueL[2,7] += eBayNavCSalesHeaderL."Sub Total Gross Amount";

                    eBayNavCSalesLineL.SETRANGE("Webshop Code",eBayNavCSalesHeaderL."Webshop Code");
                    eBayNavCSalesLineL.SETRANGE("Document No.",eBayNavCSalesHeaderL."No.");

                    HourOrderItemL[2,7] += eBayNavCSalesLineL.COUNT;

                    CASE eBayNavCPaymentModuleL."Payment Method Code" OF
                      'RATENKAUF':HourBPHireL[2,7] += 1;
                      'RECHNUNG': HourBPInvoiceL[2,7] += 1;
                      'KK': HourCreditcardL[2,7] += 1;
                      'FREE':;
                      'PP': HourPayPalL[2,7] += 1;
                      'VORK': HourPrepayL[2,7] += 1;
                      'GSVERK':;
                    END;
                  END;
                //H0901, H1244, H1663 17.10.14  FF ---------------------------
              END;
            END;
        UNTIL eBayNavCSalesHeaderFilterL.NEXT = 0;

      //Check Day Today
      IF EndFullHourL <> 235959T THEN
        eBayNavCSalesHeaderFilterL.SETRANGE("Order Date",WORKDATE)
      ELSE
        eBayNavCSalesHeaderFilterL.SETRANGE("Order Date",CALCDATE('<-1D>',WORKDATE));

      eBayNavCSalesHeaderFilterL.SETRANGE("Order Time");

      IF eBayNavCSalesHeaderFilterL.FINDSET THEN
        REPEAT
          eBayNavCSalesHeaderL.SETRANGE("No.",eBayNavCSalesHeaderFilterL."No.");
          IF eBayNavCSalesHeaderL.FINDFIRST THEN
            BEGIN
              eBayNavCPaymentModuleL.GET(eBayNavCSalesHeaderL."Webshop Code",eBayNavCSalesHeaderL."Webshop Payment Module");
              CASE eBayNavCSalesHeaderL."Webshop Code" OF
                '1':
                  BEGIN
                    DayOrderCounterL[1,1] += 1;
                    DayOrderValueL[1,1] += eBayNavCSalesHeaderL."Sub Total Gross Amount";

                    eBayNavCSalesLineL.SETRANGE("Webshop Code",eBayNavCSalesHeaderL."Webshop Code");
                    eBayNavCSalesLineL.SETRANGE("Document No.",eBayNavCSalesHeaderL."No.");

                    DayOrderItemL[1,1] += eBayNavCSalesLineL.COUNT;

                    CASE eBayNavCPaymentModuleL."Payment Method Code" OF
                      'RATENKAUF':DayBPHireL[1,1] += 1;
                      'RECHNUNG': DayBPInvoiceL[1,1] += 1;
                      'KK': DayCreditcardL[1,1] += 1;
                      'FREE':;
                      'PP': DayPayPalL[1,1] += 1;
                      'VORK': DayPrepayL[1,1] += 1;
                      'GSVERK':;
                    END;
                  END;
                '2':
                  BEGIN
                    DayOrderCounterL[1,2] += 1;
                    DayOrderValueL[1,2] += eBayNavCSalesHeaderL."Sub Total Gross Amount";

                    eBayNavCSalesLineL.SETRANGE("Webshop Code",eBayNavCSalesHeaderL."Webshop Code");
                    eBayNavCSalesLineL.SETRANGE("Document No.",eBayNavCSalesHeaderL."No.");

                    DayOrderItemL[1,2] += eBayNavCSalesLineL.COUNT;

                    CASE eBayNavCPaymentModuleL."Payment Method Code" OF
                      'RATENKAUF':DayBPHireL[1,2] += 1;
                      'RECHNUNG': DayBPInvoiceL[1,2] += 1;
                      'KK': DayCreditcardL[1,2] += 1;
                      'FREE':;
                      'PP': DayPayPalL[1,2] += 1;
                      'VORK': DayPrepayL[1,2] += 1;
                      'GSVERK':;
                    END;
                  END;
                '3':
                  BEGIN
                    DayOrderCounterL[1,3] += 1;
                    DayOrderValueL[1,3] += eBayNavCSalesHeaderL."Sub Total Gross Amount";

                    eBayNavCSalesLineL.SETRANGE("Webshop Code",eBayNavCSalesHeaderL."Webshop Code");
                    eBayNavCSalesLineL.SETRANGE("Document No.",eBayNavCSalesHeaderL."No.");

                    DayOrderItemL[1,3] += eBayNavCSalesLineL.COUNT;

                    CASE eBayNavCPaymentModuleL."Payment Method Code" OF
                      'RATENKAUF':DayBPHireL[1,3] += 1;
                      'RECHNUNG': DayBPInvoiceL[1,3] += 1;
                      'KK': DayCreditcardL[1,3] += 1;
                      'FREE':;
                      'PP': DayPayPalL[1,3] += 1;
                      'VORK': DayPrepayL[1,3] += 1;
                      'GSVERK':;
                    END;
                  END;
                //H0149 10.01.13  FF ++++++++++++++++++++++
                '4':
                  BEGIN
                    DayOrderCounterL[1,4] += 1;
                    DayOrderValueL[1,4] += eBayNavCSalesHeaderL."Sub Total Gross Amount";

                    eBayNavCSalesLineL.SETRANGE("Webshop Code",eBayNavCSalesHeaderL."Webshop Code");
                    eBayNavCSalesLineL.SETRANGE("Document No.",eBayNavCSalesHeaderL."No.");

                    DayOrderItemL[1,4] += eBayNavCSalesLineL.COUNT;

                    CASE eBayNavCPaymentModuleL."Payment Method Code" OF
                      'RATENKAUF':DayBPHireL[1,4] += 1;
                      'RECHNUNG': DayBPInvoiceL[1,4] += 1;
                      'KK': DayCreditcardL[1,4] += 1;
                      'FREE':;
                      'PP': DayPayPalL[1,4] += 1;
                      'VORK': DayPrepayL[1,4] += 1;
                      'GSVERK':;
                    END;
                  END;
                //H0149 10.01.13  FF ----------------------
                //H0901  27.02.14  FF +++++++++++++++++++++++++++++++++++++
                '5':
                  BEGIN
                    DayOrderCounterL[1,5] += 1;
                    DayOrderValueL[1,5] += eBayNavCSalesHeaderL."Sub Total Gross Amount";

                    eBayNavCSalesLineL.SETRANGE("Webshop Code",eBayNavCSalesHeaderL."Webshop Code");
                    eBayNavCSalesLineL.SETRANGE("Document No.",eBayNavCSalesHeaderL."No.");

                    DayOrderItemL[1,5] += eBayNavCSalesLineL.COUNT;

                    CASE eBayNavCPaymentModuleL."Payment Method Code" OF
                      'RATENKAUF':DayBPHireL[1,5] += 1;
                      'RECHNUNG': DayBPInvoiceL[1,5] += 1;
                      'KK': DayCreditcardL[1,5] += 1;
                      'FREE':;
                      'PP': DayPayPalL[1,5] += 1;
                      'VORK': DayPrepayL[1,5] += 1;
                      'GSVERK':;
                    END;
                  END;
                //H0901  27.02.14  FF -------------------------------------
                //H1244  09.07.14  FF +++++++++++++++++++++++++++++++++++++
                '6':
                  BEGIN
                    DayOrderCounterL[1,6] += 1;
                    DayOrderValueL[1,6] += eBayNavCSalesHeaderL."Sub Total Gross Amount";

                    eBayNavCSalesLineL.SETRANGE("Webshop Code",eBayNavCSalesHeaderL."Webshop Code");
                    eBayNavCSalesLineL.SETRANGE("Document No.",eBayNavCSalesHeaderL."No.");

                    DayOrderItemL[1,6] += eBayNavCSalesLineL.COUNT;

                    CASE eBayNavCPaymentModuleL."Payment Method Code" OF
                      'RATENKAUF':DayBPHireL[1,6] += 1;
                      'RECHNUNG': DayBPInvoiceL[1,6] += 1;
                      'KK': DayCreditcardL[1,6] += 1;
                      'FREE':;
                      'PP': DayPayPalL[1,6] += 1;
                      'VORK': DayPrepayL[1,6] += 1;
                      'GSVERK':;
                    END;
                  END;
                //H1244  09.07.14  FF -------------------------------------
                //H1663  17.10.14  FF +++++++++++++++++++++++++++++++++++++
                '7':
                  BEGIN
                    DayOrderCounterL[1,7] += 1;
                    DayOrderValueL[1,7] += eBayNavCSalesHeaderL."Sub Total Gross Amount";

                    eBayNavCSalesLineL.SETRANGE("Webshop Code",eBayNavCSalesHeaderL."Webshop Code");
                    eBayNavCSalesLineL.SETRANGE("Document No.",eBayNavCSalesHeaderL."No.");

                    DayOrderItemL[1,7] += eBayNavCSalesLineL.COUNT;

                    CASE eBayNavCPaymentModuleL."Payment Method Code" OF
                      'RATENKAUF':DayBPHireL[1,7] += 1;
                      'RECHNUNG': DayBPInvoiceL[1,7] += 1;
                      'KK': DayCreditcardL[1,7] += 1;
                      'FREE':;
                      'PP': DayPayPalL[1,7] += 1;
                      'VORK': DayPrepayL[1,7] += 1;
                      'GSVERK':;
                    END;
                  END;
                //H1663  17.10.14  FF -------------------------------------
              END;
            END;
        UNTIL eBayNavCSalesHeaderFilterL.NEXT = 0;

      //Check Day Last Week
      eBayNavCSalesHeaderFilterL.SETRANGE("Order Date",CompareDateL);
      eBayNavCSalesHeaderFilterL.SETRANGE("Order Time");

      IF eBayNavCSalesHeaderFilterL.FINDSET THEN
        REPEAT
          eBayNavCSalesHeaderL.SETRANGE("No.",eBayNavCSalesHeaderFilterL."No.");
          IF eBayNavCSalesHeaderL.FINDFIRST THEN
            BEGIN
              eBayNavCPaymentModuleL.GET(eBayNavCSalesHeaderL."Webshop Code",eBayNavCSalesHeaderL."Webshop Payment Module");
              CASE eBayNavCSalesHeaderL."Webshop Code" OF
                '1':
                  BEGIN
                    DayOrderCounterL[2,1] += 1;
                    DayOrderValueL[2,1] += eBayNavCSalesHeaderL."Sub Total Gross Amount";

                    eBayNavCSalesLineL.SETRANGE("Webshop Code",eBayNavCSalesHeaderL."Webshop Code");
                    eBayNavCSalesLineL.SETRANGE("Document No.",eBayNavCSalesHeaderL."No.");

                    DayOrderItemL[2,1] += eBayNavCSalesLineL.COUNT;

                    CASE eBayNavCPaymentModuleL."Payment Method Code" OF
                      'RATENKAUF':DayBPHireL[2,1] += 1;
                      'RECHNUNG': DayBPInvoiceL[2,1] += 1;
                      'KK': DayCreditcardL[2,1] += 1;
                      'FREE':;
                      'PP': DayPayPalL[2,1] += 1;
                      'VORK': DayPrepayL[2,1] += 1;
                      'GSVERK':;
                    END;
                  END;
                '2':
                  BEGIN
                    DayOrderCounterL[2,2] += 1;
                    DayOrderValueL[2,2] += eBayNavCSalesHeaderL."Sub Total Gross Amount";

                    eBayNavCSalesLineL.SETRANGE("Webshop Code",eBayNavCSalesHeaderL."Webshop Code");
                    eBayNavCSalesLineL.SETRANGE("Document No.",eBayNavCSalesHeaderL."No.");

                    DayOrderItemL[2,2] += eBayNavCSalesLineL.COUNT;

                    CASE eBayNavCPaymentModuleL."Payment Method Code" OF
                      'RATENKAUF':DayBPHireL[2,2] += 1;
                      'RECHNUNG': DayBPInvoiceL[2,2] += 1;
                      'KK': DayCreditcardL[2,2] += 1;
                      'FREE':;
                      'PP': DayPayPalL[2,2] += 1;
                      'VORK': DayPrepayL[2,2] += 1;
                      'GSVERK':;
                    END;
                  END;
                '3':
                  BEGIN
                    DayOrderCounterL[2,3] += 1;
                    DayOrderValueL[2,3] += eBayNavCSalesHeaderL."Sub Total Gross Amount";

                    eBayNavCSalesLineL.SETRANGE("Webshop Code",eBayNavCSalesHeaderL."Webshop Code");
                    eBayNavCSalesLineL.SETRANGE("Document No.",eBayNavCSalesHeaderL."No.");

                    DayOrderItemL[2,3] += eBayNavCSalesLineL.COUNT;

                    CASE eBayNavCPaymentModuleL."Payment Method Code" OF
                      'RATENKAUF':DayBPHireL[2,3] += 1;
                      'RECHNUNG': DayBPInvoiceL[2,3] += 1;
                      'KK': DayCreditcardL[2,3] += 1;
                      'FREE':;
                      'PP': DayPayPalL[2,3] += 1;
                      'VORK': DayPrepayL[2,3] += 1;
                      'GSVERK':;
                    END;
                  END;
                //H0149 10.01.13  FF ++++++++++++++++++++++
                '4':
                  BEGIN
                    DayOrderCounterL[2,4] += 1;
                    DayOrderValueL[2,4] += eBayNavCSalesHeaderL."Sub Total Gross Amount";

                    eBayNavCSalesLineL.SETRANGE("Webshop Code",eBayNavCSalesHeaderL."Webshop Code");
                    eBayNavCSalesLineL.SETRANGE("Document No.",eBayNavCSalesHeaderL."No.");

                    DayOrderItemL[2,4] += eBayNavCSalesLineL.COUNT;

                    CASE eBayNavCPaymentModuleL."Payment Method Code" OF
                      'RATENKAUF':DayBPHireL[2,4] += 1;
                      'RECHNUNG': DayBPInvoiceL[2,4] += 1;
                      'KK': DayCreditcardL[2,4] += 1;
                      'FREE':;
                      'PP': DayPayPalL[2,4] += 1;
                      'VORK': DayPrepayL[2,4] += 1;
                      'GSVERK':;
                    END;
                  END;
                //H0149 10.01.13  FF ----------------------
                //H0901  27.02.14  FF +++++++++++++++++++++++++++++++++++++
                '5':
                  BEGIN
                    DayOrderCounterL[2,5] += 1;
                    DayOrderValueL[2,5] += eBayNavCSalesHeaderL."Sub Total Gross Amount";

                    eBayNavCSalesLineL.SETRANGE("Webshop Code",eBayNavCSalesHeaderL."Webshop Code");
                    eBayNavCSalesLineL.SETRANGE("Document No.",eBayNavCSalesHeaderL."No.");

                    DayOrderItemL[2,5] += eBayNavCSalesLineL.COUNT;

                    CASE eBayNavCPaymentModuleL."Payment Method Code" OF
                      'RATENKAUF':DayBPHireL[2,5] += 1;
                      'RECHNUNG': DayBPInvoiceL[2,5] += 1;
                      'KK': DayCreditcardL[2,5] += 1;
                      'FREE':;
                      'PP': DayPayPalL[2,5] += 1;
                      'VORK': DayPrepayL[2,5] += 1;
                      'GSVERK':;
                    END;
                  END;
                //H0901  27.02.14  FF -------------------------------------
                //H1244  09.07.14  FF +++++++++++++++++++++++++++++++++++++
                '6':
                  BEGIN
                    DayOrderCounterL[2,6] += 1;
                    DayOrderValueL[2,6] += eBayNavCSalesHeaderL."Sub Total Gross Amount";

                    eBayNavCSalesLineL.SETRANGE("Webshop Code",eBayNavCSalesHeaderL."Webshop Code");
                    eBayNavCSalesLineL.SETRANGE("Document No.",eBayNavCSalesHeaderL."No.");

                    DayOrderItemL[2,6] += eBayNavCSalesLineL.COUNT;

                    CASE eBayNavCPaymentModuleL."Payment Method Code" OF
                      'RATENKAUF':DayBPHireL[2,6] += 1;
                      'RECHNUNG': DayBPInvoiceL[2,6] += 1;
                      'KK': DayCreditcardL[2,6] += 1;
                      'FREE':;
                      'PP': DayPayPalL[2,6] += 1;
                      'VORK': DayPrepayL[2,6] += 1;
                      'GSVERK':;
                    END;
                  END;
                //H1244  09.07.14  FF -------------------------------------
                //H1663  17.10.14  FF +++++++++++++++++++++++++++++++++++++
                '7':
                  BEGIN
                    DayOrderCounterL[2,7] += 1;
                    DayOrderValueL[2,7] += eBayNavCSalesHeaderL."Sub Total Gross Amount";

                    eBayNavCSalesLineL.SETRANGE("Webshop Code",eBayNavCSalesHeaderL."Webshop Code");
                    eBayNavCSalesLineL.SETRANGE("Document No.",eBayNavCSalesHeaderL."No.");

                    DayOrderItemL[2,7] += eBayNavCSalesLineL.COUNT;

                    CASE eBayNavCPaymentModuleL."Payment Method Code" OF
                      'RATENKAUF':DayBPHireL[2,7] += 1;
                      'RECHNUNG': DayBPInvoiceL[2,7] += 1;
                      'KK': DayCreditcardL[2,7] += 1;
                      'FREE':;
                      'PP': DayPayPalL[2,7] += 1;
                      'VORK': DayPrepayL[2,7] += 1;
                      'GSVERK':;
                    END;
                  END;
                //H1663  17.10.14  FF -------------------------------------
              END;
            END;
        UNTIL eBayNavCSalesHeaderFilterL.NEXT = 0;

      //Calc Percent
      ColumnCounter1L := 1;

      REPEAT
        ColumnCounter2L := 1;

        REPEAT
          IF HourOrderCounterL[ColumnCounter1L,ColumnCounter2L] <> 0 THEN BEGIN
            HourBPInvoiceL[ColumnCounter1L,ColumnCounter2L] :=
                ROUND((HourBPInvoiceL[ColumnCounter1L,ColumnCounter2L] / HourOrderCounterL[ColumnCounter1L,ColumnCounter2L]) * 100,0.01)
      ;

            HourCreditcardL[ColumnCounter1L,ColumnCounter2L] :=
                ROUND((HourCreditcardL[ColumnCounter1L,ColumnCounter2L] / HourOrderCounterL[ColumnCounter1L,ColumnCounter2L]) * 100,0.01
      );

            HourPrepayL[ColumnCounter1L,ColumnCounter2L] :=
                ROUND((HourPrepayL[ColumnCounter1L,ColumnCounter2L] / HourOrderCounterL[ColumnCounter1L,ColumnCounter2L]) * 100,0.01);

            HourPayPalL[ColumnCounter1L,ColumnCounter2L] :=
                ROUND((HourPayPalL[ColumnCounter1L,ColumnCounter2L] / HourOrderCounterL[ColumnCounter1L,ColumnCounter2L]) * 100,0.01);

            HourBPHireL[ColumnCounter1L,ColumnCounter2L] :=
                ROUND((HourBPHireL[ColumnCounter1L,ColumnCounter2L] / HourOrderCounterL[ColumnCounter1L,ColumnCounter2L]) * 100,0.01);
          END ELSE BEGIN
            HourBPInvoiceL[ColumnCounter1L,ColumnCounter2L] := 0;
            HourCreditcardL[ColumnCounter1L,ColumnCounter2L] := 0;
            HourPrepayL[ColumnCounter1L,ColumnCounter2L] := 0;
            HourPayPalL[ColumnCounter1L,ColumnCounter2L] := 0;
            HourBPHireL[ColumnCounter1L,ColumnCounter2L] := 0;
          END;

          IF DayOrderCounterL[ColumnCounter1L,ColumnCounter2L] <> 0 THEN BEGIN
            DayBPInvoiceL[ColumnCounter1L,ColumnCounter2L] :=
                ROUND((DayBPInvoiceL[ColumnCounter1L,ColumnCounter2L] / DayOrderCounterL[ColumnCounter1L,ColumnCounter2L]) * 100,0.01);

            DayCreditcardL[ColumnCounter1L,ColumnCounter2L] :=
                ROUND((DayCreditcardL[ColumnCounter1L,ColumnCounter2L] / DayOrderCounterL[ColumnCounter1L,ColumnCounter2L]) * 100,0.01);

            DayPrepayL[ColumnCounter1L,ColumnCounter2L] :=
                ROUND((DayPrepayL[ColumnCounter1L,ColumnCounter2L] / DayOrderCounterL[ColumnCounter1L,ColumnCounter2L]) * 100,0.01);

            DayPayPalL[ColumnCounter1L,ColumnCounter2L] :=
                ROUND((DayPayPalL[ColumnCounter1L,ColumnCounter2L] / DayOrderCounterL[ColumnCounter1L,ColumnCounter2L]) * 100,0.01);

            DayBPHireL[ColumnCounter1L,ColumnCounter2L] :=
                ROUND((DayBPHireL[ColumnCounter1L,ColumnCounter2L] / DayOrderCounterL[ColumnCounter1L,ColumnCounter2L]) * 100,0.01);
          END ELSE BEGIN
            DayBPInvoiceL[ColumnCounter1L,ColumnCounter2L] := 0;
            DayCreditcardL[ColumnCounter1L,ColumnCounter2L] := 0;
            DayPrepayL[ColumnCounter1L,ColumnCounter2L] := 0;
            DayPayPalL[ColumnCounter1L,ColumnCounter2L] := 0;
            DayBPHireL[ColumnCounter1L,ColumnCounter2L] := 0;
          END;

          ColumnCounter2L += 1;
        UNTIL ColumnCounter2L = 4;

       ColumnCounter1L += 1;
      UNTIL ColumnCounter1L = 3;



      //Create Mail

      AdminMailQueueFunctions.InitMail(AdminMailQueueSetup."Finance Stat. Mail Code",TeamLeader);
      AdminMailQueueFunctions.AddSubject('[LIVE] Statistic Shops');

      AdminMailQueueFunctions.AddText('<h2>');
      IF EndFullHourL <> 235959T THEN
        AdminMailQueueFunctions.AddText(STRSUBSTNO('Date: %1 %2',WORKDATE,EndFullHourL))
      ELSE
        AdminMailQueueFunctions.AddText(STRSUBSTNO('Date: %1 %2',CALCDATE('<-1D>',WORKDATE),EndFullHourL));

      AdminMailQueueFunctions.AddText('</h2>');
      AdminMailQueueFunctions.AddText('<hr />');
      AdminMailQueueFunctions.AddText('<h3>');
      AdminMailQueueFunctions.AddText('Format: Last 1 Hour (Prev. Week Last 1 Hour)');
      AdminMailQueueFunctions.AddText('</h3>');
      AdminMailQueueFunctions.SetIgnoreLineBreak(TRUE);
      AdminMailQueueFunctions.AddText('<table>');

          AdminMailQueueFunctions.AddText('<tr>');            //Caption
          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<b>');
          AdminMailQueueFunctions.AddText('Country  ');
          AdminMailQueueFunctions.AddText('</b>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<b>');
          AdminMailQueueFunctions.AddText('#<font color="White">_</font>Orders<font color="White">__</font>');
          AdminMailQueueFunctions.AddText('</b>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<b>');
          AdminMailQueueFunctions.AddText('EUR<font color="White">__________</font>');
          AdminMailQueueFunctions.AddText('</b>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<b>');
          AdminMailQueueFunctions.AddText('#<font color="White">_</font>Products<font color="White">__</font>');
          AdminMailQueueFunctions.AddText('</b>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<b>');
          AdminMailQueueFunctions.AddText('PPay<font color="White">_</font>%<font color="White">__</font>');
          AdminMailQueueFunctions.AddText('</b>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<b>');
          AdminMailQueueFunctions.AddText('PPal<font color="White">_</font>%<font color="White">__</font>');
          AdminMailQueueFunctions.AddText('</b>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<b>');
          AdminMailQueueFunctions.AddText('CC<font color="White">_</font>%<font color="White">__</font>');
          AdminMailQueueFunctions.AddText('</b>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<b>');
          AdminMailQueueFunctions.AddText('Inv.<font color="White">_</font>%<font color="White">__</font>');
          AdminMailQueueFunctions.AddText('</b>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<b>');
          AdminMailQueueFunctions.AddText('Inst.<font color="White">_</font>%<font color="White">__</font>');
          AdminMailQueueFunctions.AddText('</b>');
          AdminMailQueueFunctions.AddText('</td>');

        AdminMailQueueFunctions.AddText('</tr>');

        AdminMailQueueFunctions.AddText('<tr>');            //Germany
          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText('Germany  ');
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(HourOrderCounterL[1,1],1),ROUND(HourOrderCounterL[2,1],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(HourOrderValueL[1,1],1),ROUND(HourOrderValueL[2,1],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(HourOrderItemL[1,1],1),ROUND(HourOrderItemL[2,1],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(HourPrepayL[1,1],1),ROUND(HourPrepayL[2,1],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(HourPayPalL[1,1],1),ROUND(HourPayPalL[2,1],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(HourCreditcardL[1,1],1),ROUND(HourCreditcardL[2,1],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(HourBPInvoiceL[1,1],1),ROUND(HourBPInvoiceL[2,1],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(HourBPHireL[1,1],1),ROUND(HourBPHireL[2,1],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

        AdminMailQueueFunctions.AddText('</tr>');

        AdminMailQueueFunctions.AddText('<tr>');            //France
          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText('France  ');
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(HourOrderCounterL[1,2],1),ROUND(HourOrderCounterL[2,2],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(HourOrderValueL[1,2],1),ROUND(HourOrderValueL[2,2],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(HourOrderItemL[1,2],1),ROUND(HourOrderItemL[2,2],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(HourPrepayL[1,2],1),ROUND(HourPrepayL[2,2],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(HourPayPalL[1,2],1),ROUND(HourPayPalL[2,2],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(HourCreditcardL[1,2],1),ROUND(HourCreditcardL[2,2],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(HourBPInvoiceL[1,2],1),ROUND(HourBPInvoiceL[2,2],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(HourBPHireL[1,2],1),ROUND(HourBPHireL[2,2],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

        AdminMailQueueFunctions.AddText('</tr>');

        AdminMailQueueFunctions.AddText('<tr>');            //Netherlands
          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText('Netherlands');
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(HourOrderCounterL[1,3],1),ROUND(HourOrderCounterL[2,3],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(HourOrderValueL[1,3],1),ROUND(HourOrderValueL[2,3],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(HourOrderItemL[1,3],1),ROUND(HourOrderItemL[2,3],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(HourPrepayL[1,3],1),ROUND(HourPrepayL[2,3],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(HourPayPalL[1,3],1),ROUND(HourPayPalL[2,3],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(HourCreditcardL[1,3],1),ROUND(HourCreditcardL[2,3],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(HourBPInvoiceL[1,3],1),ROUND(HourBPInvoiceL[2,3],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(HourBPHireL[1,3],1),ROUND(HourBPHireL[2,3],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

        AdminMailQueueFunctions.AddText('</tr>');

      //H0149  10.10.13  FF +++++++++++++++++++++++++++++++++++
      /////AUSTRIA
        AdminMailQueueFunctions.AddText('<tr>');            //Austria
          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText('Austria  ');
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(HourOrderCounterL[1,4],1),ROUND(HourOrderCounterL[2,4],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(HourOrderValueL[1,4],1),ROUND(HourOrderValueL[2,4],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(HourOrderItemL[1,4],1),ROUND(HourOrderItemL[2,4],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(HourPrepayL[1,4],1),ROUND(HourPrepayL[2,4],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(HourPayPalL[1,4],1),ROUND(HourPayPalL[2,4],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(HourCreditcardL[1,4],1),ROUND(HourCreditcardL[2,4],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(HourBPInvoiceL[1,4],1),ROUND(HourBPInvoiceL[2,4],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(HourBPHireL[1,4],1),ROUND(HourBPHireL[2,4],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

        AdminMailQueueFunctions.AddText('</tr>');
      //H0149  10.10.13  FF -------------------------------------

      /////AUSTRIA END

      //H0901  27.02.14  FF +++++++++++++++++++++++++++++++++++++
        AdminMailQueueFunctions.AddText('<tr>');            //Switzerlamd
          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText('Switzerland  ');
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(HourOrderCounterL[1,5],1),ROUND(HourOrderCounterL[2,5],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(HourOrderValueL[1,5],1),ROUND(HourOrderValueL[2,5],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(HourOrderItemL[1,5],1),ROUND(HourOrderItemL[2,5],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(HourPrepayL[1,5],1),ROUND(HourPrepayL[2,5],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(HourPayPalL[1,5],1),ROUND(HourPayPalL[2,5],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(HourCreditcardL[1,5],1),ROUND(HourCreditcardL[2,5],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(HourBPInvoiceL[1,5],1),ROUND(HourBPInvoiceL[2,5],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(HourBPHireL[1,5],1),ROUND(HourBPHireL[2,5],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

        AdminMailQueueFunctions.AddText('</tr>');

      //H0901  27.02.14  FF -------------------------------------
      //H1244  09.07.14  FF +++++++++++++++++++++++++++++++++++++
        AdminMailQueueFunctions.AddText('<tr>');            //Belgium
          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText('Belgium  ');
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(HourOrderCounterL[1,6],1),ROUND(HourOrderCounterL[2,6],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(HourOrderValueL[1,6],1),ROUND(HourOrderValueL[2,6],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(HourOrderItemL[1,6],1),ROUND(HourOrderItemL[2,6],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(HourPrepayL[1,6],1),ROUND(HourPrepayL[2,6],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(HourPayPalL[1,6],1),ROUND(HourPayPalL[2,6],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(HourCreditcardL[1,6],1),ROUND(HourCreditcardL[2,6],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(HourBPInvoiceL[1,6],1),ROUND(HourBPInvoiceL[2,6],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(HourBPHireL[1,6],1),ROUND(HourBPHireL[2,6],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

        AdminMailQueueFunctions.AddText('</tr>');

      //H1244  09.07.14  FF -------------------------------------
      //H1663  17.10.14  FF +++++++++++++++++++++++++++++++++++++
        AdminMailQueueFunctions.AddText('<tr>');            //Italy
          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText('Italy  ');
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(HourOrderCounterL[1,7],1),ROUND(HourOrderCounterL[2,7],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(HourOrderValueL[1,7],1),ROUND(HourOrderValueL[2,7],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(HourOrderItemL[1,7],1),ROUND(HourOrderItemL[2,7],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(HourPrepayL[1,7],1),ROUND(HourPrepayL[2,7],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(HourPayPalL[1,7],1),ROUND(HourPayPalL[2,7],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(HourCreditcardL[1,7],1),ROUND(HourCreditcardL[2,7],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(HourBPInvoiceL[1,7],1),ROUND(HourBPInvoiceL[2,7],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(HourBPHireL[1,7],1),ROUND(HourBPHireL[2,7],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

        AdminMailQueueFunctions.AddText('</tr>');

      //H1663  17.10.14  FF -------------------------------------


      AdminMailQueueFunctions.AddText('</table>');

      AdminMailQueueFunctions.AddText(' ');
      AdminMailQueueFunctions.AddText(' ');
      AdminMailQueueFunctions.AddText('<hr />');
      AdminMailQueueFunctions.AddText('<h3>');
      IF EndFullHourL <> 235959T THEN
        AdminMailQueueFunctions.AddText(STRSUBSTNO('Format: Day %1 (Prev. Week)',WORKDATE))
      ELSE
        AdminMailQueueFunctions.AddText(STRSUBSTNO('Format: Day %1 (Prev. Week)',CALCDATE('<-1D>',WORKDATE)));

      AdminMailQueueFunctions.AddText('</h3>');
      AdminMailQueueFunctions.AddText(' ');

      AdminMailQueueFunctions.AddText('<table>');

      AdminMailQueueFunctions.AddText('<tr>');            //Caption
      AdminMailQueueFunctions.AddText('<td>');
      AdminMailQueueFunctions.AddText('<b>');
      AdminMailQueueFunctions.AddText('Country  ');
      AdminMailQueueFunctions.AddText('</b>');
      AdminMailQueueFunctions.AddText('</td>');

      AdminMailQueueFunctions.AddText('<td>');
      AdminMailQueueFunctions.AddText('<b>');
      AdminMailQueueFunctions.AddText('#<font color="White">_</font>Orders<font color="White">__</font>');
      AdminMailQueueFunctions.AddText('</b>');
      AdminMailQueueFunctions.AddText('</td>');

      AdminMailQueueFunctions.AddText('<td>');
      AdminMailQueueFunctions.AddText('<b>');
      AdminMailQueueFunctions.AddText('EUR<font color="White">__________</font>');
      AdminMailQueueFunctions.AddText('</b>');
      AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<b>');
          AdminMailQueueFunctions.AddText('#<font color="White">_</font>Products<font color="White">__</font>');
          AdminMailQueueFunctions.AddText('</b>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<b>');
          AdminMailQueueFunctions.AddText('PPay<font color="White">_</font>%<font color="White">__</font>');
          AdminMailQueueFunctions.AddText('</b>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<b>');
          AdminMailQueueFunctions.AddText('PPal<font color="White">_</font>%<font color="White">__</font>');
          AdminMailQueueFunctions.AddText('</b>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<b>');
          AdminMailQueueFunctions.AddText('CC<font color="White">_</font>%<font color="White">__</font>');
          AdminMailQueueFunctions.AddText('</b>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<b>');
          AdminMailQueueFunctions.AddText('Inv.<font color="White">_</font>%<font color="White">__</font>');
          AdminMailQueueFunctions.AddText('</b>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<b>');
          AdminMailQueueFunctions.AddText('Inst.<font color="White">_</font>%<font color="White">__</font>');
          AdminMailQueueFunctions.AddText('</b>');
          AdminMailQueueFunctions.AddText('</td>');

        AdminMailQueueFunctions.AddText('</tr>');

        AdminMailQueueFunctions.AddText('<tr>');            //Germany
          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText('Germany  ');
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(DayOrderCounterL[1,1],1),ROUND(DayOrderCounterL[2,1],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(DayOrderValueL[1,1],1),ROUND(DayOrderValueL[2,1],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(DayOrderItemL[1,1],1),ROUND(DayOrderItemL[2,1],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(DayPrepayL[1,1],1),ROUND(DayPrepayL[2,1],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(DayPayPalL[1,1],1),ROUND(DayPayPalL[2,1],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(DayCreditcardL[1,1],1),ROUND(DayCreditcardL[2,1],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(DayBPInvoiceL[1,1],1),ROUND(DayBPInvoiceL[2,1],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(DayBPHireL[1,1],1),ROUND(DayBPHireL[2,1],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

        AdminMailQueueFunctions.AddText('</tr>');

        AdminMailQueueFunctions.AddText('<tr>');            //France
          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText('France  ');
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(DayOrderCounterL[1,2],1),ROUND(DayOrderCounterL[2,2],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(DayOrderValueL[1,2],1),ROUND(DayOrderValueL[2,2],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(DayOrderItemL[1,2],1),ROUND(DayOrderItemL[2,2],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(DayPrepayL[1,2],1),ROUND(DayPrepayL[2,2],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(DayPayPalL[1,2],1),ROUND(DayPayPalL[2,2],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(DayCreditcardL[1,2],1),ROUND(DayCreditcardL[2,2],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(DayBPInvoiceL[1,2],1),ROUND(DayBPInvoiceL[2,2],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(DayBPHireL[1,2],1),ROUND(DayBPHireL[2,2],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

        AdminMailQueueFunctions.AddText('</tr>');

        AdminMailQueueFunctions.AddText('<tr>');            //Netherlands
          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText('Netherlands  ');
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(DayOrderCounterL[1,3],1),ROUND(DayOrderCounterL[2,3],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(DayOrderValueL[1,3],1),ROUND(DayOrderValueL[2,3],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(DayOrderItemL[1,3],1),ROUND(DayOrderItemL[2,3],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(DayPrepayL[1,3],1),ROUND(DayPrepayL[2,3],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(DayPayPalL[1,3],1),ROUND(DayPayPalL[2,3],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(DayCreditcardL[1,3],1),ROUND(DayCreditcardL[2,3],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(DayBPInvoiceL[1,3],1),ROUND(DayBPInvoiceL[2,3],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(DayBPHireL[1,3],1),ROUND(DayBPHireL[2,3],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

        AdminMailQueueFunctions.AddText('</tr>');

      //H0149  10.01.13  FF +++++++++++++++++++++++++++++++++++++
      //////AUSTRIA START

        AdminMailQueueFunctions.AddText('<tr>');            //Austria
          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText('Austria  ');
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(DayOrderCounterL[1,4],1),ROUND(DayOrderCounterL[2,4],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(DayOrderValueL[1,4],1),ROUND(DayOrderValueL[2,4],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(DayOrderItemL[1,4],1),ROUND(DayOrderItemL[2,4],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(DayPrepayL[1,4],1),ROUND(DayPrepayL[2,4],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(DayPayPalL[1,4],1),ROUND(DayPayPalL[2,4],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(DayCreditcardL[1,4],1),ROUND(DayCreditcardL[2,4],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(DayBPInvoiceL[1,4],1),ROUND(DayBPInvoiceL[2,4],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(DayBPHireL[1,4],1),ROUND(DayBPHireL[2,4],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

        AdminMailQueueFunctions.AddText('</tr>');
      //////AUSTRIA END

      //H0149  10.01.13  FF -------------------------------------

      //H0901  27.02.14  FF +++++++++++++++++++++++++++++++++++++
        AdminMailQueueFunctions.AddText('<tr>');            //Switzerland
          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText('Switzerland  ');
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(DayOrderCounterL[1,5],1),ROUND(DayOrderCounterL[2,5],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(DayOrderValueL[1,5],1),ROUND(DayOrderValueL[2,5],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(DayOrderItemL[1,5],1),ROUND(DayOrderItemL[2,5],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(DayPrepayL[1,5],1),ROUND(DayPrepayL[2,5],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(DayPayPalL[1,5],1),ROUND(DayPayPalL[2,5],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(DayCreditcardL[1,5],1),ROUND(DayCreditcardL[2,5],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(DayBPInvoiceL[1,5],1),ROUND(DayBPInvoiceL[2,5],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(DayBPHireL[1,5],1),ROUND(DayBPHireL[2,5],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

        AdminMailQueueFunctions.AddText('</tr>');

      //H0901  27.02.14  FF -------------------------------------
      //H1244  09.07.14  FF +++++++++++++++++++++++++++++++++++++
        AdminMailQueueFunctions.AddText('<tr>');            //Belgium
          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText('Belgium  ');
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(DayOrderCounterL[1,6],1),ROUND(DayOrderCounterL[2,6],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(DayOrderValueL[1,6],1),ROUND(DayOrderValueL[2,6],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(DayOrderItemL[1,6],1),ROUND(DayOrderItemL[2,6],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(DayPrepayL[1,6],1),ROUND(DayPrepayL[2,6],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(DayPayPalL[1,6],1),ROUND(DayPayPalL[2,6],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(DayCreditcardL[1,6],1),ROUND(DayCreditcardL[2,6],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(DayBPInvoiceL[1,6],1),ROUND(DayBPInvoiceL[2,6],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(DayBPHireL[1,6],1),ROUND(DayBPHireL[2,6],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

        AdminMailQueueFunctions.AddText('</tr>');

      //H1244  09.07.14  FF -------------------------------------
      //H1663  17.10.14  FF +++++++++++++++++++++++++++++++++++++
        AdminMailQueueFunctions.AddText('<tr>');            //Italy
          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText('Italy  ');
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(DayOrderCounterL[1,7],1),ROUND(DayOrderCounterL[2,7],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(DayOrderValueL[1,7],1),ROUND(DayOrderValueL[2,7],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(DayOrderItemL[1,7],1),ROUND(DayOrderItemL[2,7],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(DayPrepayL[1,7],1),ROUND(DayPrepayL[2,7],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(DayPayPalL[1,7],1),ROUND(DayPayPalL[2,7],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(DayCreditcardL[1,7],1),ROUND(DayCreditcardL[2,7],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(DayBPInvoiceL[1,7],1),ROUND(DayBPInvoiceL[2,7],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1<font color="White">_</font>(%2)  ',
              ROUND(DayBPHireL[1,7],1),ROUND(DayBPHireL[2,7],1)));
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');

        AdminMailQueueFunctions.AddText('</tr>');

      //H1663  17.10.14  FF -------------------------------------


      AdminMailQueueFunctions.AddText('</table>');
      AdminMailQueueFunctions.SetIgnoreLineBreak(FALSE);
      AdminMailQueueFunctions.AddText(' ');
      AdminMailQueueFunctions.AddText('<font color="Gainsboro">Supported by: Your ERP Team</font>');
      AdminMailQueueFunctions.AddText(' ');
      AdminMailQueueFunctions.FinishMail;
    END;

    PROCEDURE CheckERPStat@1000000001(TimeStampStartV@1000000041 : DateTime;TimeStampEndV@1000000080 : DateTime;MailTypeV@1000000081 : 'Yesterday,Morning,Midday,Evening,Early Morning,Late Evening,Weekly,Monthly');
    VAR
      AdminMailQueueLogL@1000000000 : Record 50093;
      AdminMailQueueLog2L@1000000093 : Record 50093;
      eBayNavCXMLLogL@1000000036 : Record 5096060;
      eBayNavCSalesHeaderL@1000000035 : Record 5251571;
      eBayNAVCSalesOrderVoucherL@1000000008 : Record 50051;
      eBayNAVCSalesOrderPaymentL@1000000011 : Record 50056;
      SalesHeaderL@1000000039 : Record 36;
      SalesHeaderArchL@1000000064 : Record 5107;
      SalesLineL@1000000065 : Record 37;
      SalesLineArchL@1000000066 : Record 5108;
      DHLParcelsStatusHistoryL@1000000067 : Record 50021;
      RhenusChangeLogRecL@1000000069 : Record 50070;
      DDLogRecL@1000000070 : Record 50066;
      DHLCrossdockHeaderL@1000000071 : Record 50052;
      BatchPostDocumentL@1000000072 : Record 50043;
      PostedBatchPostDocumentL@1000000073 : Record 50044;
      SCQueueLogL@1000000074 : Record 50103;
      SCQueueLogArchL@1000000075 : Record 50105;
      SCQueueCodesTmpL@1000000017 : TEMPORARY Record 50102;
      ItemImportLogL@1000000076 : Record 50002;
      JobQueueLogEntryL@1000000077 : Record 474;
      JobQueueEntryL@1000000047 : Record 472;
      OMProjectL@1000000029 : Record 11102036;
      OMModificationL@1000000043 : Record 11102042;
      FPCInterfaceSetupL@1000000033 : Record 50014;
      FTPLogL@1000000030 : Record 50038;
      EndFullHourL@1000000040 : Time;
      CompareDateL@1000000038 : Date;
      ColumnCounter1L@1000000003 : Integer;
      ColumnCounter2L@1000000005 : Integer;
      TimeStampStartL@1000000062 : DateTime;
      TimeStampEndL@1000000061 : DateTime;
      TimeStampFilterL@1000000060 : Text[50];
      "***Data***********************"@1000000001 : Integer;
      XMLOrderL@1000000002 : Integer;
      XMLCustomerL@1000000004 : Integer;
      XMLPaymentL@1000000006 : Integer;
      XMLOrderErrorL@1000000024 : Integer;
      XMLCustomerErrorL@1000000023 : Integer;
      XMLPaymentErrorL@1000000022 : Integer;
      ManualOrderUnprocessedL@1000000007 : Integer;
      ManualOrderCreatedL@1000000020 : Integer;
      ManualOrderDeliverdL@1000000021 : Integer;
      ManualOrderTotalL@1000000063 : Integer;
      ManualVoucherL@1000000009 : Integer;
      ManualPaymentL@1000000010 : Integer;
      OrdersReleasedL@1000000012 : Integer;
      OrdersPendingPrepaymentL@1000000055 : Integer;
      OrdersCanceledL@1000000056 : Integer;
      OrdersOpenL@1000000057 : Integer;
      OrdersOpenWithoutSOL@1000000084 : Integer;
      OrdersArchivedL@1000000058 : Integer;
      OrdersTotalL@1000000059 : Integer;
      LinesPerChannelTmpL@1000000013 : TEMPORARY Record 37;
      RhenusStatusL@1000000014 : Integer;
      RhenusChangeLogL@1000000025 : Integer;
      DDStatusL@1000000015 : Integer;
      DDLogL@1000000026 : Integer;
      DHLStatusL@1000000016 : Integer;
      TotalParcelsL@1000000068 : Integer;
      DHLCrossdockStatusL@1000000018 : Integer;
      DHLCrossdockErrorL@1000000019 : Integer;
      SalesPostL@1000000034 : Integer;
      SalesEMailL@1000000037 : Integer;
      PurchOrderL@1000000042 : Integer;
      PurchPostL@1000000045 : Integer;
      PurchEMailL@1000000044 : Integer;
      SalesPost2L@1000000090 : Integer;
      SalesEMail2L@1000000089 : Integer;
      PurchOrder2L@1000000088 : Integer;
      PurchPost2L@1000000086 : Integer;
      PurchEMail2L@1000000085 : Integer;
      SalesPostErrorL@1000000053 : Integer;
      SalesEMailErrorL@1000000052 : Integer;
      PurchOrderErrorL@1000000051 : Integer;
      PurchPostErrorL@1000000049 : Integer;
      PurchEMailErrorL@1000000048 : Integer;
      TotalCustomerMailsL@1000000027 : Integer;
      TotalCustomerMailsErrorL@1000000028 : Integer;
      AdminMailQueuL@1000000031 : Integer;
      ItemImportL@1000000032 : Integer;
      JobQueueLogEntriesL@1000000078 : Integer;
      JobQueueLogEntriesErrorL@1000000079 : Integer;
      ObjectModificationL@1000000046 : Integer;
      JobQueueEntryStatusOnHold@1000000083 : Integer;
      JobQueueEntryStatusReady@1000000082 : Integer;
      JobQueueEntryStatusInProcess@1000000054 : Integer;
      JobQueueEntryStatusError@1000000050 : Integer;
      ShippingInfoWebServiceAdressL@1000000087 : Text[250];
      ShippingInfoMaxRunCountL@1000000091 : Integer;
      ShippingInfosTimeoutSecL@1000000092 : Integer;
      eBayNAVCWebshopPurchasingL@1000000094 : Record 50030;
      PurchasingFilter@1000000095 : Text[1024];
      "*OrderCounter***************"@1000000100 : Integer;
      OCeBayNavCXMLLogL@1000000099 : Record 5096060;
      OCeBayNavCSalesHeaderL@1000000098 : Record 5251571;
      OCeBayNavCSalesHeaderFilterL@1000000097 : Record 5251571;
      DayOrderCounterL@1000000096 : ARRAY [2,7] OF Integer;
      "**"@1000000101 : Integer;
      ManualOrderTotalUnprocessedL@1000000102 : Integer;
      MOeBayNavCSalesHeaderL@1000000103 : Record 5251571;
      JobQueueEntryProcessedL@1000000104 : Record 472;
      InboundEDIOrdersL@1000000105 : Integer;
      OutboundEDIOrdersL@1000000106 : Integer;
      OutboundEDIDocumentList@1000000107 : Record 82864;
      InboundEDIPurchDocHeader@1000000108 : Record 82868;
      LastFTPTransferRHEDownNrWait@1000000109 : Integer;
      LastFTPTransferRHEUpNrWait@1000000110 : Integer;
      LastFTPTransferDDDownNrWait@1000000111 : Integer;
      LastFTPTransferDDUpNrWait@1000000112 : Integer;
      LastFTPTransferDDDownNr@1000000113 : Integer;
      LastFTPTransferRHEDownNr@1000000114 : Integer;
      LastFTPTransferDDUpNr@1000000115 : Integer;
      LastFTPTransferRHEUpNr@1000000116 : Integer;
      FTPLogLoc@1000000117 : Record 50038;
      CUFTP@1000000118 : Codeunit 50029;
      FPCINTER@1000000119 : Record 50014;
      LcountRehnusOut@1000000120 : Integer;
      LCountDDOut@1000000121 : Integer;
      NrFilesOnLocalDIsk@1000000122 : Integer;
      NrFilesOnFTPServer@1000000123 : Integer;
      "*****"@1000000129 : Integer;
      AdminMailQueueSetupL@1000000130 : Record 50092;
      AdminMailQueueCodesL@1000000131 : Record 50118;
      FirstDayOfMonth@1000000132 : Boolean;
      MondayL@1000000133 : Boolean;
      ParcelStatusHistory@1000000134 : Record 80013;
      ParcelStatusHistoryArchive@1000000135 : Record 50187;
    BEGIN
      //S/P1133
      FPCGeneralSetup.GET;
      //E/P1133

      AdminMailQueueSetup.GET;
      //H0473  06.08.13  FF  +++++++++++++++++++++++++++++++++++++++++++++++
      IF CheckMailDowntime(AdminMailQueueSetup."ERP Stat. Mail Code") = TRUE THEN
        EXIT;
      //H0473  06.08.13  FF  -----------------------------------------------

      AdminMailQueueLogL.RESET;
      //A/gob-adb/18.04.13
      AdminMailQueueLogL.SETCURRENTKEY("Mail Code");
      //E/gob-adb/18.04.13
      AdminMailQueueLogL.SETRANGE("Mail Code",AdminMailQueueSetup."ERP Stat. Mail Code");
      //A/gob-adb/18.04.13
      AdminMailQueueLog2L.SETCURRENTKEY("Mail Code");
      //E/gob-adb/18.04.13
      AdminMailQueueLog2L.SETRANGE("Mail Code",AdminMailQueueSetup."ERP Stat. Mail Code");
      AdminMailQueueLog2L.SETRANGE("Processing Date/Time",CREATEDATETIME(WORKDATE,000000T),CREATEDATETIME(WORKDATE,235959T));

      IF AdminMailQueueLogL.FINDLAST THEN BEGIN
        IF FORMAT(AdminMailQueueLogL."Processing Date/Time") = '' THEN
          EXIT;

        IF (TIME < DT2TIME(AdminMailQueueLogL."Processing Date/Time")) AND (TIME < 010000T) THEN
          EXIT;

      //H0536,H1444 05.08.14  FF ++++++++++
      FirstDayOfMonth := ((DATE2DMY(WORKDATE,1)) = 1);
      MondayL := DATE2DWY(WORKDATE,1) = 1;
      //H0536,H1444 05.08.14  FF ----------

        CASE MailTypeV OF
          //H0536,H0606 10.10.13  FF ++++++++++
          MailTypeV::Monthly:
            BEGIN
              IF TIME < 030000T THEN
                EXIT;
              IF (NOT FirstDayOfMonth) OR (AdminMailQueueLog2L.COUNT >= 1) THEN
                EXIT;
            END;

          MailTypeV::Weekly:
            BEGIN
              IF TIME < 030000T THEN
                EXIT;
              IF NOT MondayL THEN
                EXIT;
              IF (((NOT FirstDayOfMonth) AND (AdminMailQueueLog2L.COUNT >= 1)) OR
                 (AdminMailQueueLog2L.COUNT >= 2)) THEN
                EXIT;
            END;
          //H0536,H0606 10.10.13  FF ----------
          MailTypeV::"Early Morning":
            BEGIN
              IF TIME < 030000T THEN
                EXIT;
              //H0536 29.08.13  FF ++++++++++
              //IF AdminMailQueueLog2L.COUNT >= 1 THEN
              IF ((AdminMailQueueLog2L.COUNT >= 1) AND (NOT MondayL) AND (NOT FirstDayOfMonth))
                OR ((AdminMailQueueLog2L.COUNT >= 2)  AND ((MondayL) XOR (FirstDayOfMonth)))
                OR (AdminMailQueueLog2L.COUNT >= 3) THEN
              //H0536,H0606 10.10.13  FF ----------
                EXIT;
            END;
          MailTypeV::Yesterday:
            BEGIN
              IF TIME < 060000T THEN
                EXIT;
              //H0536,H0606 10.10.13  FF ++++++++++
              IF ((AdminMailQueueLog2L.COUNT >= 2)  AND (NOT MondayL) AND (NOT FirstDayOfMonth))
                OR ((AdminMailQueueLog2L.COUNT >= 3)  AND ((MondayL) XOR (FirstDayOfMonth)))
                OR (AdminMailQueueLog2L.COUNT >= 4)  THEN
              //H0536,H0606 10.10.13  FF ----------
                EXIT;
            END;
          MailTypeV::Morning:
            BEGIN
              IF TIME < 060000T THEN
                EXIT;
              //H0536,H0606 10.10.13  FF ++++++++++
              IF ((AdminMailQueueLog2L.COUNT >= 3) AND (NOT MondayL) AND (NOT FirstDayOfMonth))
                OR ((AdminMailQueueLog2L.COUNT >= 4)  AND ((MondayL) XOR (FirstDayOfMonth)))
                OR (AdminMailQueueLog2L.COUNT >= 5) THEN
              //H0536,H0606 10.10.13  FF ----------
                EXIT;
            END;
          MailTypeV::Midday:
            BEGIN
              IF TIME < 130000T THEN
                EXIT;
              //H0536,H0606 10.10.13  FF ++++++++++
              IF ((AdminMailQueueLog2L.COUNT >= 4) AND (NOT MondayL) AND (NOT FirstDayOfMonth))
                OR ((AdminMailQueueLog2L.COUNT >= 5)  AND ((MondayL) XOR (FirstDayOfMonth)))
                OR (AdminMailQueueLog2L.COUNT >= 6) THEN
              //H0536,H0606 10.10.13  FF ----------
                EXIT;
            END;
          MailTypeV::Evening:
            BEGIN
              IF TIME < 170000T THEN
                EXIT;
              //H0536,H0606 10.10.13  FF ++++++++++
              IF ((AdminMailQueueLog2L.COUNT >= 5) AND (NOT MondayL) AND (NOT FirstDayOfMonth))
                OR ((AdminMailQueueLog2L.COUNT >= 6)  AND ((MondayL) XOR (FirstDayOfMonth)))
                OR (AdminMailQueueLog2L.COUNT >= 7) THEN
              //H0536,H0606 10.10.13  FF ----------
                EXIT;
            END;
          MailTypeV::"Late Evening":
            BEGIN
              IF TIME < 220000T THEN
                EXIT;
              //H0536,H0606 10.10.13  FF ++++++++++
              IF ((AdminMailQueueLog2L.COUNT >= 6) AND (NOT MondayL) AND (NOT FirstDayOfMonth))
                OR ((AdminMailQueueLog2L.COUNT >= 7)  AND ((MondayL) XOR (FirstDayOfMonth)))
                OR (AdminMailQueueLog2L.COUNT >= 8)  THEN
              //H0536,H0606 10.10.13  FF ----------
                EXIT;
            END;
        END;

      END;

      EndFullHourL := DT2TIME(ROUNDDATETIME(TimeStampEndV,1000*3600,'<'));
      CompareDateL := DT2DATE(TimeStampStartV);

      TimeStampStartL := TimeStampStartV;
      TimeStampEndL := TimeStampEndV;
      TimeStampFilterL := FORMAT(TimeStampStartL)+'..'+FORMAT(TimeStampEndL);

      //GetData
      CLEAR(DayOrderCounterL);
      CLEAR(ManualOrderTotalUnprocessedL);

      CLEAR(XMLOrderL);
      CLEAR(XMLCustomerL);
      CLEAR(XMLPaymentL);
      CLEAR(XMLOrderErrorL);
      CLEAR(XMLCustomerErrorL);
      CLEAR(XMLPaymentErrorL);

      CLEAR(ManualOrderUnprocessedL);
      CLEAR(ManualOrderCreatedL);
      CLEAR(ManualOrderDeliverdL);
      CLEAR(ManualOrderTotalL);
      CLEAR(ManualVoucherL);
      CLEAR(ManualPaymentL);

      CLEAR(OrdersReleasedL);
      CLEAR(OrdersPendingPrepaymentL);
      CLEAR(OrdersCanceledL);
      CLEAR(OrdersOpenL);
      CLEAR(OrdersArchivedL);
      CLEAR(OrdersTotalL);

      CLEAR(LinesPerChannelTmpL);
      LinesPerChannelTmpL.DELETEALL;

      CLEAR(RhenusStatusL);
      CLEAR(RhenusChangeLogL);
      CLEAR(DDStatusL);
      CLEAR(DDLogL);
      CLEAR(DHLStatusL);
      CLEAR(DHLCrossdockStatusL);
      CLEAR(DHLCrossdockErrorL);
      CLEAR(TotalParcelsL);

      CLEAR(SalesPostL);
      CLEAR(SalesEMailL);
      CLEAR(PurchOrderL);
      CLEAR(PurchPostL);
      CLEAR(PurchEMailL);
      CLEAR(SalesPost2L);
      CLEAR(SalesEMail2L);
      CLEAR(PurchOrder2L);
      CLEAR(PurchPost2L);
      CLEAR(PurchEMail2L);
      CLEAR(SalesPostErrorL);
      CLEAR(SalesEMailErrorL);
      CLEAR(PurchOrderErrorL);
      CLEAR(PurchPostErrorL);
      CLEAR(PurchEMailErrorL);

      CLEAR(TotalCustomerMailsL);
      CLEAR(TotalCustomerMailsErrorL);
      CLEAR(SCQueueCodesTmpL);
      SCQueueCodesTmpL.DELETEALL;

      CLEAR(ObjectModificationL);

      CLEAR(JobQueueEntryStatusOnHold);
      CLEAR(JobQueueEntryStatusReady);
      CLEAR(JobQueueEntryStatusInProcess);
      CLEAR(JobQueueEntryStatusError);

      CLEAR(AdminMailQueuL);

      CLEAR(ItemImportL);

      IF FPCINTER.GET('RHENUS') THEN BEGIN
        LastFTPTransferRHEDownNrWait := CUFTP.CountFTPFiles(FPCINTER."FTP Import Address",
                                                    FPCINTER."FTP Import User",
                                                    FPCINTER."FTP Import Password",
                                                    FPCINTER."FTP Import Folder",
                                                    FPCINTER."FTP Upload Use SFTP");

        LastFTPTransferRHEUpNrWait := CUFTP.CountFTPFiles(FPCINTER."FTP Export Address",
                                                    FPCINTER."FTP Export User",
                                                    FPCINTER."FTP Export Password",
                                                    FPCINTER."FTP Export Folder",
                                                    FPCINTER."FTP Upload Use SFTP");
      END;

      IF FPCINTER.GET('DOCDATA') THEN BEGIN
        LastFTPTransferDDDownNrWait := CUFTP.CountFTPFiles(FPCINTER."FTP Import Address",
                                                    FPCINTER."FTP Import User",
                                                    FPCINTER."FTP Import Password",
                                                    FPCINTER."FTP Import Folder",
                                                    FPCINTER."FTP Upload Use SFTP");

        LastFTPTransferDDUpNrWait := CUFTP.CountFTPFiles(FPCINTER."FTP Export Address",
                                                    FPCINTER."FTP Export User",
                                                    FPCINTER."FTP Export Password",
                                                    FPCINTER."FTP Export Folder",
                                                    FPCINTER."FTP Upload Use SFTP");
      END;

      //H0261,H0264  20.03.13  PAU  +++++++++++++++++++++++++++++++++++++
      IF FPCINTER.GET('DOCDATA') THEN BEGIN
        LastFTPTransferDDDownNr := CUFTP.CountFilesOnDisk(FPCINTER.Code,FPCINTER."Import Folder");
      END ELSE BEGIN
        LastFTPTransferDDDownNr := 0;
      END;

      IF FPCINTER.GET('RHENUS') THEN BEGIN
        LastFTPTransferRHEDownNr := CUFTP.CountFilesOnDisk(FPCINTER.Code,FPCINTER."Import Folder");
      END ELSE BEGIN
        LastFTPTransferRHEDownNr := 0;
      END;

      IF FPCINTER.GET('DOCDATA') THEN BEGIN
        LastFTPTransferDDUpNr := CUFTP.CountFilesOnDisk(FPCINTER.Code,FPCINTER."Export Folder");
      END ELSE BEGIN
        LastFTPTransferDDUpNr := 0;
      END;

      IF FPCINTER.GET('RHENUS') THEN BEGIN
        LastFTPTransferRHEUpNr := CUFTP.CountFilesOnDisk(FPCINTER.Code,FPCINTER."Export Folder");
      END ELSE BEGIN
        LastFTPTransferRHEUpNr := 0;
      END;

      LcountRehnusOut := CUFTP.CountRehnus;
      LCountDDOut := CUFTP.CountDD;
      //H0259,H0261, H0264  20.03.13  PAU  -------------------------------------

      //XML
      eBayNavCXMLLogL.SETRANGE("Conducted at",TimeStampStartL,TimeStampEndL);
      eBayNavCXMLLogL.SETRANGE("Source Type",eBayNavCXMLLogL."Source Type"::"S.Order");
      XMLOrderL := eBayNavCXMLLogL.COUNT;

      eBayNavCXMLLogL.SETRANGE("Source Type",eBayNavCXMLLogL."Source Type"::Customer);
      XMLCustomerL := eBayNavCXMLLogL.COUNT;

      eBayNavCXMLLogL.SETRANGE("Source Type",eBayNavCXMLLogL."Source Type"::Payment);
      XMLPaymentL := eBayNavCXMLLogL.COUNT;

      eBayNavCXMLLogL.SETRANGE(Success,FALSE);

      eBayNavCXMLLogL.SETRANGE("Source Type",eBayNavCXMLLogL."Source Type"::"S.Order");
      XMLOrderErrorL := eBayNavCXMLLogL.COUNT;

      eBayNavCXMLLogL.SETRANGE("Source Type",eBayNavCXMLLogL."Source Type"::Customer);
      XMLCustomerErrorL := eBayNavCXMLLogL.COUNT;

      eBayNavCXMLLogL.SETRANGE("Source Type",eBayNavCXMLLogL."Source Type"::Payment);
      XMLPaymentErrorL := eBayNavCXMLLogL.COUNT;

      //Manual Order
      eBayNavCSalesHeaderL.SETRANGE("Order Date",CompareDateL,WORKDATE);
      IF eBayNavCSalesHeaderL.FINDSET THEN
        REPEAT
          CASE eBayNavCSalesHeaderL.Status OF
            eBayNavCSalesHeaderL.Status::Unprocessed: ManualOrderUnprocessedL += 1;
            eBayNavCSalesHeaderL.Status::DocumentCreated: ManualOrderCreatedL += 1;
            eBayNavCSalesHeaderL.Status::Delivered: ManualOrderDeliverdL +=1;
          END;
          eBayNAVCSalesOrderVoucherL.SETRANGE("Sales Order No.",eBayNavCSalesHeaderL."No.");
          ManualVoucherL += eBayNAVCSalesOrderVoucherL.COUNT;
        UNTIL eBayNavCSalesHeaderL.NEXT = 0;

      ManualOrderTotalL := ManualOrderUnprocessedL + ManualOrderCreatedL + ManualOrderDeliverdL;

      eBayNAVCSalesOrderPaymentL.SETRANGE("Creation Date",TimeStampStartL,TimeStampEndL);
      ManualPaymentL += eBayNAVCSalesOrderPaymentL.COUNT;

      IF MOeBayNavCSalesHeaderL.FINDSET THEN
        REPEAT
          IF MOeBayNavCSalesHeaderL.Status =  MOeBayNavCSalesHeaderL.Status::Unprocessed THEN
            ManualOrderTotalUnprocessedL += 1;
        UNTIL MOeBayNavCSalesHeaderL.NEXT = 0;

      //Real Order
      SalesHeaderL.SETRANGE("Document Type",SalesHeaderL."Document Type"::Order);

      //H1043 26.06.14  FF +++++++++++++++++++
      IF MailTypeV = MailTypeV::Yesterday THEN
        SalesHeaderL.SETRANGE("Order Date",CompareDateL)
      ELSE
      //H1043 26.06.14  FF -------------------
        SalesHeaderL.SETRANGE("Order Date",CompareDateL,WORKDATE);

      IF SalesHeaderL.FINDSET THEN
        REPEAT
          CASE SalesHeaderL.Status OF
            SalesHeaderL.Status::Open: OrdersOpenL += 1;
            SalesHeaderL.Status::"Pending Prepayment": OrdersPendingPrepaymentL += 1;
            SalesHeaderL.Status::Released: OrdersReleasedL += 1;
            SalesHeaderL.Status::Canceled: OrdersCanceledL += 1;
          END;

          IF (SalesHeaderL.Status = SalesHeaderL.Status::Open) AND (COPYSTR(SalesHeaderL."No.",1,2) <> 'SO') THEN
           OrdersOpenWithoutSOL += 1;

          SalesLineL.SETRANGE("Document Type",SalesHeaderL."Document Type");
          SalesLineL.SETRANGE("Document No.",SalesHeaderL."No.");
          SalesLineL.SETRANGE(Type,SalesLineL.Type::Item);
          IF SalesLineL.FINDSET THEN BEGIN
            REPEAT
              IF LinesPerChannelTmpL.GET(LinesPerChannelTmpL."Document Type"::Order,SalesLineL."Purchasing Code",10000) THEN BEGIN
                LinesPerChannelTmpL.Quantity +=1;
                LinesPerChannelTmpL.MODIFY;
              END ELSE BEGIN
                LinesPerChannelTmpL.INIT;
                LinesPerChannelTmpL."Document Type" := LinesPerChannelTmpL."Document Type"::Order;
                LinesPerChannelTmpL."Document No." := SalesLineL."Purchasing Code";
                LinesPerChannelTmpL."Line No." := 10000;
                LinesPerChannelTmpL.Quantity := 1;
                LinesPerChannelTmpL.INSERT;
              END;
            UNTIL SalesLineL.NEXT = 0;

          END;

        UNTIL SalesHeaderL.NEXT = 0;

      SalesHeaderArchL.SETRANGE("Document Type",SalesHeaderArchL."Document Type"::Order);
      SalesHeaderArchL.SETRANGE("Order Date",CompareDateL,WORKDATE);
      IF SalesHeaderArchL.FINDSET THEN
        REPEAT
          OrdersArchivedL += 1;
          SalesLineArchL.SETRANGE("Document Type",SalesHeaderArchL."Document Type");
          SalesLineArchL.SETRANGE("Document No.",SalesHeaderArchL."No.");
          SalesLineArchL.SETRANGE("Doc. No. Occurrence",SalesHeaderArchL."Doc. No. Occurrence");
          SalesLineArchL.SETRANGE("Version No.",SalesHeaderArchL."Version No.");
          IF SalesLineArchL.FINDSET THEN
            REPEAT
              IF LinesPerChannelTmpL.GET(LinesPerChannelTmpL."Document Type"::Order,SalesLineArchL."Purchasing Code",10000) THEN BEGIN
                LinesPerChannelTmpL.Quantity +=1;
                LinesPerChannelTmpL.MODIFY;
              END ELSE BEGIN
                LinesPerChannelTmpL.INIT;
                LinesPerChannelTmpL."Document Type" := LinesPerChannelTmpL."Document Type"::Order;
                LinesPerChannelTmpL."Document No." := SalesLineArchL."Purchasing Code";
                LinesPerChannelTmpL."Line No." := 10000;
                LinesPerChannelTmpL.Quantity := 1;
                LinesPerChannelTmpL.INSERT;
              END;
            UNTIL SalesLineArchL.NEXT = 0;
        UNTIL SalesHeaderArchL.NEXT = 0;

      OrdersTotalL := OrdersReleasedL + OrdersPendingPrepaymentL + OrdersCanceledL + OrdersOpenL + OrdersArchivedL;

      //Logistic
      //S/P1133
      CASE FPCGeneralSetup."Active Parcel Status History" OF
        FPCGeneralSetup."Active Parcel Status History"::"Use Only Old DHL Parcel Status History",
        FPCGeneralSetup."Active Parcel Status History"::"Fill Both But Show And Use Old":
          BEGIN
      //E/P1133
            DHLParcelsStatusHistoryL.SETRANGE("Import Time Stamp",TimeStampStartL,TimeStampEndL);
            DHLParcelsStatusHistoryL.SETRANGE("Shipment through",DHLParcelsStatusHistoryL."Shipment through"::Rhenus);
            RhenusStatusL := DHLParcelsStatusHistoryL.COUNT;

            DHLParcelsStatusHistoryL.SETRANGE("Shipment through",DHLParcelsStatusHistoryL."Shipment through"::DocData);
            DDStatusL := DHLParcelsStatusHistoryL.COUNT;

            DHLParcelsStatusHistoryL.SETRANGE("Shipment through",DHLParcelsStatusHistoryL."Shipment through"::DHL);
            DHLStatusL := DHLParcelsStatusHistoryL.COUNT;
      //S/P1133
          END;
        FPCGeneralSetup."Active Parcel Status History"::"Fill Both But Show And Use New",
        FPCGeneralSetup."Active Parcel Status History"::"Use Only New Parcel Status History":
          BEGIN
            ParcelStatusHistory.SETRANGE("Timestamp Insert",TimeStampStartL,TimeStampEndL);
            ParcelStatusHistory.SETRANGE("Used Interface",ParcelStatusHistory."Used Interface"::Rhenus);
            ParcelStatusHistoryArchive.SETRANGE("Timestamp Insert",TimeStampStartL,TimeStampEndL);
            ParcelStatusHistoryArchive.SETRANGE("Used Interface",ParcelStatusHistory."Used Interface"::Rhenus);
            RhenusStatusL := ParcelStatusHistory.COUNT + ParcelStatusHistoryArchive.COUNT;

            ParcelStatusHistory.SETRANGE("Used Interface",ParcelStatusHistory."Used Interface"::DocData);
            ParcelStatusHistoryArchive.SETRANGE("Used Interface",ParcelStatusHistory."Used Interface"::DocData);
            DDStatusL := ParcelStatusHistory.COUNT + ParcelStatusHistoryArchive.COUNT;

            ParcelStatusHistory.SETRANGE("Used Interface",ParcelStatusHistory."Used Interface"::DHL);
            ParcelStatusHistoryArchive.SETRANGE("Used Interface",ParcelStatusHistory."Used Interface"::DHL);
            DHLStatusL := ParcelStatusHistory.COUNT + ParcelStatusHistoryArchive.COUNT;
          END;
      END;
      //E/P1133

      TotalParcelsL := RhenusStatusL + DDStatusL + DHLStatusL;

      RhenusChangeLogRecL.SETRANGE("Creation Datetime",TimeStampStartL,TimeStampEndL);
      RhenusChangeLogL := RhenusChangeLogRecL.COUNT;

      DDLogRecL.SETRANGE(Timestamp,TimeStampStartL,TimeStampEndL);
      DDLogL := DDLogRecL.COUNT;

      DHLCrossdockHeaderL.SETRANGE(Inserted,TimeStampStartL,TimeStampEndL);
      DHLCrossdockStatusL := DHLCrossdockHeaderL.COUNT;

      DHLCrossdockHeaderL.SETRANGE(Error,TRUE);
      DHLCrossdockErrorL := DHLCrossdockHeaderL.COUNT;

      //After Sales
      BatchPostDocumentL.SETRANGE("Scheduled at",TimeStampStartL,TimeStampEndL);
      BatchPostDocumentL.SETRANGE("Action Type",BatchPostDocumentL."Action Type"::"Purch. Post");
        PurchPostL := BatchPostDocumentL.COUNT;

      BatchPostDocumentL.SETRANGE("Action Type",BatchPostDocumentL."Action Type"::"Sales Post");
        SalesPostL := BatchPostDocumentL.COUNT;

      BatchPostDocumentL.SETRANGE("Action Type",BatchPostDocumentL."Action Type"::"Purch. EMail");
        PurchEMailL := BatchPostDocumentL.COUNT;

      BatchPostDocumentL.SETRANGE("Action Type",BatchPostDocumentL."Action Type"::"Sales EMail");
        SalesEMailL := BatchPostDocumentL.COUNT;

      BatchPostDocumentL.SETRANGE("Action Type",BatchPostDocumentL."Action Type"::"Create Purch. Order");
        PurchOrderL := BatchPostDocumentL.COUNT;

      //Posted
      PostedBatchPostDocumentL.SETRANGE("Scheduled at",TimeStampStartL,TimeStampEndL);
      PostedBatchPostDocumentL.SETRANGE("Action Type",PostedBatchPostDocumentL."Action Type"::"Purch. Post");
      PurchPost2L += PostedBatchPostDocumentL.COUNT;

      PostedBatchPostDocumentL.SETRANGE("Action Type",PostedBatchPostDocumentL."Action Type"::"Sales Post");
      SalesPost2L += PostedBatchPostDocumentL.COUNT;

      PostedBatchPostDocumentL.SETRANGE("Action Type",PostedBatchPostDocumentL."Action Type"::"Purch. EMail");
      PurchEMail2L += PostedBatchPostDocumentL.COUNT;

      PostedBatchPostDocumentL.SETRANGE("Action Type",PostedBatchPostDocumentL."Action Type"::"Sales EMail");
      SalesEMail2L += PostedBatchPostDocumentL.COUNT;

      PostedBatchPostDocumentL.SETRANGE("Action Type",PostedBatchPostDocumentL."Action Type"::"Create Purch. Order");
      PurchOrder2L += PostedBatchPostDocumentL.COUNT;

      BatchPostDocumentL.SETFILTER("No. of Tries",'>=3');
      BatchPostDocumentL.SETRANGE("Action Type",BatchPostDocumentL."Action Type"::"Purch. Post");
      PurchPostErrorL := BatchPostDocumentL.COUNT;

      BatchPostDocumentL.SETRANGE("Action Type",BatchPostDocumentL."Action Type"::"Sales Post");
      SalesPostErrorL := BatchPostDocumentL.COUNT;

      BatchPostDocumentL.SETRANGE("Action Type",BatchPostDocumentL."Action Type"::"Purch. EMail");
      PurchEMailErrorL := BatchPostDocumentL.COUNT;

      BatchPostDocumentL.SETRANGE("Action Type",BatchPostDocumentL."Action Type"::"Sales EMail");
      SalesEMailErrorL := BatchPostDocumentL.COUNT;

      BatchPostDocumentL.SETRANGE("Action Type",BatchPostDocumentL."Action Type"::"Create Purch. Order");
      PurchOrderErrorL := BatchPostDocumentL.COUNT;


      //H0061  26.10.12  ABR  +++++++++++++++++++++++++++++++++++++
      //Mails
      SCQueueLogL.SETRANGE("Created at",TimeStampStartL,TimeStampEndL);
      IF SCQueueLogL.FIND('-') THEN BEGIN
        REPEAT
          CASE SCQueueLogL.Direction OF
            SCQueueLogL.Direction::Incoming:
              BEGIN
                IF SCQueueCodesTmpL.GET(COPYSTR(SCQueueLogL."Shop Connector Code",1,MAXSTRLEN(SCQueueCodesTmpL.Code))) THEN BEGIN
                  IF SCQueueLogL."Error Source" = SCQueueLogL."Error Source"::" " THEN
                    SCQueueCodesTmpL."Max. Run Count" +=1
                  ELSE
                    SCQueueCodesTmpL."Timeout (Sec.)" +=1;
                  SCQueueCodesTmpL.MODIFY;
                END ELSE BEGIN
                  IF SCQueueLogL."Error Source" = SCQueueLogL."Error Source"::" " THEN BEGIN
                    SCQueueCodesTmpL.INIT;
                    SCQueueCodesTmpL.Code := COPYSTR(SCQueueLogL."Shop Connector Code",1,MAXSTRLEN(SCQueueCodesTmpL.Code));
                    SCQueueCodesTmpL."Web Service Adress" := 'Sent by Shop';
                    SCQueueCodesTmpL."Max. Run Count" +=1;
                    SCQueueCodesTmpL.INSERT;
                  END ELSE BEGIN
                    SCQueueCodesTmpL.INIT;
                    SCQueueCodesTmpL.Code := COPYSTR(SCQueueLogL."Shop Connector Code",1,MAXSTRLEN(SCQueueCodesTmpL.Code));
                    SCQueueCodesTmpL."Web Service Adress" := 'Sent by Shop';
                    SCQueueCodesTmpL."Timeout (Sec.)" +=1;
                    SCQueueCodesTmpL.INSERT;
                  END;
                END;
              END;

            SCQueueLogL.Direction::Outgoing:
              BEGIN
                IF SCQueueCodesTmpL.GET(COPYSTR(SCQueueLogL."Shop Connector Code",1,MAXSTRLEN(SCQueueCodesTmpL.Code))) THEN BEGIN
                  IF SCQueueLogL."Error Source" = SCQueueLogL."Error Source"::" " THEN
                    SCQueueCodesTmpL."Max. Run Count" += 1
                  ELSE
                    SCQueueCodesTmpL."Timeout (Sec.)" += 1;
                  SCQueueCodesTmpL.MODIFY;
                END ELSE BEGIN
                  IF SCQueueLogL."Error Source" = SCQueueLogL."Error Source"::" " THEN BEGIN
                    SCQueueCodesTmpL.INIT;
                    SCQueueCodesTmpL.Code := COPYSTR(SCQueueLogL."Shop Connector Code",1,MAXSTRLEN(SCQueueCodesTmpL.Code));
                    SCQueueCodesTmpL."Web Service Adress" := 'Sent by Nav';
                    SCQueueCodesTmpL."Max. Run Count" += 1;
                    SCQueueCodesTmpL.INSERT;
                  END ELSE BEGIN
                    SCQueueCodesTmpL.INIT;
                    SCQueueCodesTmpL.Code := COPYSTR(SCQueueLogL."Shop Connector Code",1,MAXSTRLEN(SCQueueCodesTmpL.Code));
                    SCQueueCodesTmpL."Web Service Adress" := 'Sent by Nav';
                    SCQueueCodesTmpL."Timeout (Sec.)" += 1;
                    SCQueueCodesTmpL.INSERT;
                  END;
                END;
              END;
          END;
        UNTIL SCQueueLogL.NEXT = 0;
      END;

      SCQueueLogArchL.SETRANGE("Created at",TimeStampStartL,TimeStampEndL);
      IF SCQueueLogArchL.FIND('-') THEN BEGIN
        REPEAT
          CASE SCQueueLogArchL.Direction OF
            SCQueueLogArchL.Direction::Incoming:
              BEGIN
                IF SCQueueCodesTmpL.GET(COPYSTR(SCQueueLogArchL."Shop Connector Code",1,MAXSTRLEN(SCQueueCodesTmpL.Code))) THEN BEGIN
                  IF SCQueueLogArchL."Error Source" = SCQueueLogArchL."Error Source"::" " THEN
                    SCQueueCodesTmpL."Max. Run Count" +=1
                  ELSE
                    SCQueueCodesTmpL."Timeout (Sec.)" +=1;
                  SCQueueCodesTmpL.MODIFY;
                END ELSE BEGIN
                  IF SCQueueLogArchL."Error Source" = SCQueueLogArchL."Error Source"::" " THEN BEGIN
                    SCQueueCodesTmpL.INIT;
                    SCQueueCodesTmpL.Code := COPYSTR(SCQueueLogArchL."Shop Connector Code",1,MAXSTRLEN(SCQueueCodesTmpL.Code));
                    SCQueueCodesTmpL."Web Service Adress" := 'Sent by Shop';
                    SCQueueCodesTmpL."Max. Run Count" +=1;
                    SCQueueCodesTmpL.INSERT;
                  END ELSE BEGIN
                    SCQueueCodesTmpL.INIT;
                    SCQueueCodesTmpL.Code := COPYSTR(SCQueueLogArchL."Shop Connector Code",1,MAXSTRLEN(SCQueueCodesTmpL.Code));
                    SCQueueCodesTmpL."Web Service Adress" := 'Sent by Shop';
                    SCQueueCodesTmpL."Timeout (Sec.)" +=1;
                    SCQueueCodesTmpL.INSERT;
                  END;
                END;
              END;

            SCQueueLogArchL.Direction::Outgoing:
              BEGIN
                IF SCQueueCodesTmpL.GET(COPYSTR(SCQueueLogArchL."Shop Connector Code",1,MAXSTRLEN(SCQueueCodesTmpL.Code))) THEN BEGIN
                  IF SCQueueLogArchL."Error Source" = SCQueueLogArchL."Error Source"::" " THEN
                    SCQueueCodesTmpL."Max. Run Count" +=1
                  ELSE
                    SCQueueCodesTmpL."Timeout (Sec.)" +=1;
                  SCQueueCodesTmpL.MODIFY;
                END ELSE BEGIN
                  IF SCQueueLogArchL."Error Source" = SCQueueLogArchL."Error Source"::" " THEN BEGIN
                    SCQueueCodesTmpL.INIT;
                    SCQueueCodesTmpL.Code := COPYSTR(SCQueueLogArchL."Shop Connector Code",1,MAXSTRLEN(SCQueueCodesTmpL.Code));
                    SCQueueCodesTmpL."Web Service Adress" := 'Sent by Nav';
                    SCQueueCodesTmpL."Max. Run Count" +=1;
                    SCQueueCodesTmpL.INSERT;
                  END ELSE BEGIN
                    SCQueueCodesTmpL.INIT;
                    SCQueueCodesTmpL.Code := COPYSTR(SCQueueLogArchL."Shop Connector Code",1,MAXSTRLEN(SCQueueCodesTmpL.Code));
                    SCQueueCodesTmpL."Web Service Adress" := 'Sent by Nav';
                    SCQueueCodesTmpL."Timeout (Sec.)" +=1;
                    SCQueueCodesTmpL.INSERT;
                  END;
                END;
              END;
          END;
        UNTIL SCQueueLogL.NEXT = 0;
      END;
      //H0061  26.10.12  ABR  -------------------------------------

      AdminMailQueueLogL.RESET;
      AdminMailQueueLogL.SETRANGE("Creating Date/Time",TimeStampStartL,TimeStampEndL);
      AdminMailQueuL := AdminMailQueueLogL.COUNT;

      ItemImportLogL.SETRANGE("Created on",TimeStampStartL,TimeStampEndL);
      ItemImportL := ItemImportLogL.COUNT;

      JobQueueLogEntryL.SETRANGE("End Date/Time",TimeStampStartL,TimeStampEndL);
      JobQueueLogEntriesL := JobQueueLogEntryL.COUNT;

      JobQueueLogEntryL.SETRANGE(Status,JobQueueLogEntryL.Status::Error);
      JobQueueLogEntriesErrorL := JobQueueLogEntryL.COUNT;

      //H0098  22.11.12  ABR  +++++++++++++++++++++++++++++++++++++
      OMModificationL.SETRANGE("Insert Date",CompareDateL);
      ObjectModificationL := OMModificationL.COUNT;

      FTPLogL.SETRANGE(Timestamp,TimeStampStartL,TimeStampEndL);
      FTPLogL.SETRANGE("Entry Type",FTPLogL."Entry Type"::Success);

      IF FPCInterfaceSetupL.FINDSET THEN
        REPEAT

          IF FPCInterfaceSetupL."FTP Download Active" THEN BEGIN
            FTPLogL.SETRANGE("Interface Code",FPCInterfaceSetupL.Code);
            FTPLogL.SETRANGE("Upload/Download",FTPLogL."Upload/Download"::Download);
            IF FTPLogL.FINDLAST THEN
              FTPLogL.MARK(TRUE);
          END;

          IF FPCInterfaceSetupL."FTP Upload Active" THEN BEGIN
            FTPLogL.SETRANGE("Interface Code",FPCInterfaceSetupL.Code);
            FTPLogL.SETRANGE("Upload/Download",FTPLogL."Upload/Download"::Upload);
            IF FTPLogL.FINDLAST THEN
              FTPLogL.MARK(TRUE);
          END;

        UNTIL FPCInterfaceSetupL.NEXT = 0;

      FTPLogL.SETRANGE("Interface Code");
      FTPLogL.SETRANGE("Upload/Download");
      FTPLogL.MARKEDONLY(TRUE);
      //H0098  22.11.12  ABR  -------------------------------------

      //H0101  26.11.12  ABR  +++++++++++++++++++++++++++++++++++++
      JobQueueEntryL.RESET;
      IF JobQueueEntryL.FINDSET THEN
        REPEAT
          CASE JobQueueEntryL.Status OF
            JobQueueEntryL.Status::"On Hold":JobQueueEntryStatusOnHold += 1;
            JobQueueEntryL.Status::Ready:JobQueueEntryStatusReady += 1;
            JobQueueEntryL.Status::"In Process":JobQueueEntryStatusInProcess += 1;
            JobQueueEntryL.Status::Error:JobQueueEntryStatusError += 1;
          END;
        UNTIL JobQueueEntryL.NEXT = 0;


      //Orders by Country
        //H1444  05.08.14  FF +++++++++++++++++++++++++++++++++++++
        //OCeBayNavCSalesHeaderFilterL.SETRANGE("Order Date",DT2DATE(TimeStampEndV));
        OCeBayNavCSalesHeaderFilterL.SETFILTER("Order Date",'%1..%2',DT2DATE(TimeStampStartV),DT2DATE(TimeStampEndV));
        OCeBayNavCSalesHeaderFilterL.SETFILTER("Order Time",'%1..%2',DT2TIME(TimeStampStartV),DT2TIME(TimeStampEndV));
        //H1444  05.08.14  FF -------------------------------------

      IF OCeBayNavCSalesHeaderFilterL.FINDSET THEN
        REPEAT
          OCeBayNavCSalesHeaderL.SETRANGE("No.",OCeBayNavCSalesHeaderFilterL."No.");
          IF OCeBayNavCSalesHeaderL.FINDFIRST THEN BEGIN
              CASE OCeBayNavCSalesHeaderL."Webshop Code" OF
                '1':DayOrderCounterL[1,1] += 1;
                '2':DayOrderCounterL[1,2] += 1;
                '3':DayOrderCounterL[1,3] += 1;
                '4':DayOrderCounterL[1,4] += 1;
                //H0901,H1244,H1663 17.10.14  FF +++++++++++++++++++++++++++++++++++++
                '5':DayOrderCounterL[1,5] += 1;
                '6':DayOrderCounterL[1,6] += 1;
                '7':DayOrderCounterL[1,7] += 1;
                //H0901,H1244,H1663 17.10.14  FF -------------------------------------

              END;
            END;
        UNTIL OCeBayNavCSalesHeaderFilterL.NEXT = 0;


      //EDI Orders
      OutboundEDIDocumentList.SETRANGE("Send Date",DT2DATE(TimeStampEndV));
      IF OutboundEDIDocumentList.FINDSET THEN
        OutboundEDIOrdersL := OutboundEDIDocumentList.COUNT;

      InboundEDIPurchDocHeader.SETRANGE("Document Date",DT2DATE(TimeStampEndV));
      IF InboundEDIPurchDocHeader.FINDSET THEN
        InboundEDIOrdersL := InboundEDIPurchDocHeader.COUNT;


      //Create Mail
      AdminMailQueueFunctions.InitMail(AdminMailQueueSetup."ERP Stat. Mail Code",TeamLeader);
      CASE MailTypeV OF
        MailTypeV::Yesterday:AdminMailQueueFunctions.AddSubject('[Yesterday] ERP Statistic');
        MailTypeV::Morning:AdminMailQueueFunctions.AddSubject('[Morning] ERP Statistic');
        MailTypeV::Midday:AdminMailQueueFunctions.AddSubject('[Midday] ERP Statistic');
        MailTypeV::Evening:AdminMailQueueFunctions.AddSubject('[Evening] ERP Statistic');
        MailTypeV::"Early Morning":AdminMailQueueFunctions.AddSubject('[Early morning] ERP Statistic');
        MailTypeV::"Late Evening":AdminMailQueueFunctions.AddSubject('[Late evening] ERP Statistic');
        //H0536 29.08.13  FF +++++++++++++++++++++++++
        MailTypeV::Weekly:AdminMailQueueFunctions.AddSubject('[Weekly] ERP Statistic');
        MailTypeV::Monthly:AdminMailQueueFunctions.AddSubject('[Monthly] ERP Statistic');
        //H0536 29.08.13  FF -------------------------


      END;
      AdminMailQueueFunctions.AddText('<h3>');

      //H0536,H0606 10.10.13  FF +++++++++++++++++++++++++
      //IF (MailTypeV = MailTypeV::Yesterday) THEN
      IF (MailTypeV = MailTypeV::Yesterday) OR (MailTypeV = MailTypeV::Monthly) OR (MailTypeV = MailTypeV::Weekly) THEN
      AdminMailQueueFunctions.AddText(STRSUBSTNO('Date: %1 %2 hr',WORKDATE,
                                                 DT2TIME(ROUNDDATETIME(CURRENTDATETIME,1000*3600,'<'))))
      //H0536,H0606 10.10.13 FF -------------------------
      ELSE
        AdminMailQueueFunctions.AddText(STRSUBSTNO('Date: %1 %2 hr',WORKDATE,EndFullHourL));

      AdminMailQueueFunctions.AddText('</h3>');

      AdminMailQueueFunctions.AddText(STRSUBSTNO('Period: %1 - %2 hr',FORMAT(TimeStampStartV),FORMAT(TimeStampEndV)));
      AdminMailQueueFunctions.AddText('<hr />');

      AdminMailQueueFunctions.AddText('<b>XML</b>');
      //H1518 04.09.14  FF +++++++++++++++++++++++++
      AdminMailQueueFunctions.AddText('<small><font color="#A3A3A3">All transfers from Shop</font></small>');
      AdminMailQueueFunctions.AddText('<small><font color="#A3A3A3">Filter on date of transfer</font></small>');
      //H1518 04.09.14  FF -------------------------

      IF XMLOrderL = 0 THEN
        AdminMailQueueFunctions.AddText(STRSUBSTNO('<font color="Red">Quantity XML Order: %1</font>',XMLOrderL))
      ELSE
        AdminMailQueueFunctions.AddText(STRSUBSTNO('Quantity XML Order: %1',XMLOrderL));

      IF XMLCustomerL = 0 THEN
        AdminMailQueueFunctions.AddText(STRSUBSTNO('<font color="Red">Quantity XML Customer: %1</font>',XMLCustomerL))
      ELSE
        AdminMailQueueFunctions.AddText(STRSUBSTNO('Quantity XML Customer: %1',XMLCustomerL));

      IF XMLPaymentL = 0 THEN
        AdminMailQueueFunctions.AddText(STRSUBSTNO('<font color="Red">Quantity XML Payments: %1</font>',XMLPaymentL))
      ELSE
        AdminMailQueueFunctions.AddText(STRSUBSTNO('Quantity XML Payments: %1',XMLPaymentL));

      AdminMailQueueFunctions.AddText(' ');
      AdminMailQueueFunctions.AddText('Failed:');
      AdminMailQueueFunctions.AddText(STRSUBSTNO('Quantity XML Order: %1',XMLOrderErrorL));
      AdminMailQueueFunctions.AddText(STRSUBSTNO('Quantity XML Customer: %1',XMLCustomerErrorL));
      AdminMailQueueFunctions.AddText(STRSUBSTNO('Quantity XML Payments: %1',XMLPaymentErrorL));

      AdminMailQueueFunctions.AddText(' ');
      AdminMailQueueFunctions.AddText('<b>Manual Order Log</b>');
      //H1518 04.09.14 FF +++++++++++++++++++++++++++++++++++++++++
      AdminMailQueueFunctions.AddText('<small><font color="#A3A3A3">Between buffers in NAV incl. processing status</font></small>');
      AdminMailQueueFunctions.AddText('<small><font color="#A3A3A3">Filter on the time of order creation in the shop</font></small>');
      //H1518 04.09.14 FF -----------------------------------------

      IF (ManualOrderUnprocessedL > 0) AND (MailTypeV = MailTypeV::Yesterday) THEN
        AdminMailQueueFunctions.AddText(STRSUBSTNO('<font color="Red">Quantity Manual Order Unprocessed: %1 (%2)</font>',
                                        ManualOrderUnprocessedL,ManualOrderTotalUnprocessedL))
      ELSE
        AdminMailQueueFunctions.AddText(STRSUBSTNO('Quantity Manual Order Unprocessed: %1 (%2)',ManualOrderUnprocessedL,
                                                                                         ManualOrderTotalUnprocessedL));

      AdminMailQueueFunctions.AddText(STRSUBSTNO('Quantity Manual Order Created: %1',ManualOrderCreatedL));
      AdminMailQueueFunctions.AddText(STRSUBSTNO('Quantity Manual Order Deliverd: %1',ManualOrderDeliverdL));
      AdminMailQueueFunctions.AddText(' ');
      AdminMailQueueFunctions.AddText(STRSUBSTNO('Quantity Manual Order Total: %1',ManualOrderTotalL));
      AdminMailQueueFunctions.AddText(' ');
      AdminMailQueueFunctions.AddText(STRSUBSTNO('Quantity Manual Vouchers: %1',ManualVoucherL));
      AdminMailQueueFunctions.AddText(STRSUBSTNO('Quantity Manual Payments: %1',ManualPaymentL));

      AdminMailQueueFunctions.AddText(' ');
      AdminMailQueueFunctions.AddText('<b>Real Orders</b>');
      //H1518 04.09.14 FF +++++++++++++++++++++++++++++++++++++++++
      AdminMailQueueFunctions.AddText('<small><font color="#A3A3A3">Daily Orders incl. Reclamation Orders</font></small>');
      AdminMailQueueFunctions.AddText('<small><font color="#A3A3A3">Filter on the time of order creation in the shop</font></small>');
      //H1518 04.09.14 FF -----------------------------------------

      IF OrdersReleasedL = 0 THEN
        AdminMailQueueFunctions.AddText(STRSUBSTNO('<font color="Red">Quantity Order Released: %1</font>',OrdersReleasedL))
      ELSE
        AdminMailQueueFunctions.AddText(STRSUBSTNO('Quantity Order Released: %1',OrdersReleasedL));
      AdminMailQueueFunctions.AddText(STRSUBSTNO('Quantity Order Pending Prepayment: %1',OrdersPendingPrepaymentL));
      AdminMailQueueFunctions.AddText(STRSUBSTNO('Quantity Order Canceled: %1',OrdersCanceledL));
      AdminMailQueueFunctions.AddText(STRSUBSTNO('Quantity Order Open: %1',OrdersOpenL));
      IF OrdersOpenWithoutSOL > 0 THEN
        AdminMailQueueFunctions.AddText(STRSUBSTNO('<font color="Red">Quantity Order Open (without SO): %1</font>',OrdersOpenWithoutSOL)
      )
      ELSE
        AdminMailQueueFunctions.AddText(STRSUBSTNO('Quantity Order Open (without SO): %1',OrdersOpenWithoutSOL));

      AdminMailQueueFunctions.AddText(' ');
      //H1518 04.09.14 FF +++++++++++++++++++++++++++++++++++++++++
      AdminMailQueueFunctions.AddText('<small><font color="#A3A3A3">Posting: Already shipped and invoiced.</font></small>');
      //H1518 04.09.14 FF -----------------------------------------
      AdminMailQueueFunctions.AddText(STRSUBSTNO('Quantity Order Archive (fully invoiced): %1',OrdersArchivedL));
      AdminMailQueueFunctions.AddText(' ');
      AdminMailQueueFunctions.AddText(STRSUBSTNO('Quantity Sent Orders: %1',OrdersTotalL));

      AdminMailQueueFunctions.AddText(' ');
      AdminMailQueueFunctions.AddText('<b>No. of Orders</b>');
      AdminMailQueueFunctions.AddText(STRSUBSTNO('Germany: %1',ROUND(DayOrderCounterL[1,1],1)));
      AdminMailQueueFunctions.AddText(STRSUBSTNO('France: %1',ROUND(DayOrderCounterL[1,2],1)));
      AdminMailQueueFunctions.AddText(STRSUBSTNO('Nederland: %1',ROUND(DayOrderCounterL[1,3],1)));
      AdminMailQueueFunctions.AddText(STRSUBSTNO('Austria: %1',ROUND(DayOrderCounterL[1,4],1)));
      //H0901,H1244,H1663 17.10.14  FF ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      AdminMailQueueFunctions.AddText(STRSUBSTNO('Switzerland: %1',ROUND(DayOrderCounterL[1,5],1)));
      AdminMailQueueFunctions.AddText(STRSUBSTNO('Belgium: %1',ROUND(DayOrderCounterL[1,6],1)));
      AdminMailQueueFunctions.AddText(STRSUBSTNO('Italy: %1',ROUND(DayOrderCounterL[1,7],1)));
      //H0901,H1244,H1663 17.10.14  FF --------------------------------------------------------------

      AdminMailQueueFunctions.AddText(' ');
      AdminMailQueueFunctions.AddText('<b>Quantity per Channel (incl. Reclamation Orders)</b>');

      PurchasingFilter := '';

      LinesPerChannelTmpL.RESET;
      IF LinesPerChannelTmpL.FINDSET THEN
        REPEAT
          IF LinesPerChannelTmpL.Quantity = 0 THEN
            AdminMailQueueFunctions.AddText(STRSUBSTNO('<font color="Red">%1: %2</font>',
                LinesPerChannelTmpL."Document No.",LinesPerChannelTmpL.Quantity))
          ELSE
            AdminMailQueueFunctions.AddText(STRSUBSTNO('%1: %2',LinesPerChannelTmpL."Document No.",LinesPerChannelTmpL.Quantity));
          IF LinesPerChannelTmpL."Document No." <> '' THEN
            PurchasingFilter := PurchasingFilter + '&<>' + LinesPerChannelTmpL."Document No.";

        UNTIL LinesPerChannelTmpL.NEXT = 0;

      PurchasingFilter := COPYSTR(PurchasingFilter,2);
      eBayNAVCWebshopPurchasingL.SETFILTER("Purchasing Code",PurchasingFilter);
      eBayNAVCWebshopPurchasingL.SETRANGE("Not active for ERP Stat Mail",FALSE);
      IF eBayNAVCWebshopPurchasingL.FINDSET THEN BEGIN
        AdminMailQueueFunctions.AddText(' ');
        REPEAT
          AdminMailQueueFunctions.AddText(STRSUBSTNO('<font color="Red">%1: 0</font>',eBayNAVCWebshopPurchasingL."Purchasing Code"));
        UNTIL eBayNAVCWebshopPurchasingL.NEXT = 0;

      END;

      AdminMailQueueFunctions.AddText(' ');
      AdminMailQueueFunctions.AddText('<b>Logistic</b>');
      AdminMailQueueFunctions.AddText('<i>DHL Tracking History</i>');
      //H1518 04.09.14 FF +++++++++++++++++++++++++++++++++++++++++
      AdminMailQueueFunctions.AddText('<small><font color="#A3A3A3">Transferred DHL tracking per distributor</font></small>');
      //H1518 04.09.14 FF -----------------------------------------
      IF RhenusStatusL = 0 THEN
        AdminMailQueueFunctions.AddText(STRSUBSTNO('<font color="Red">Rhenus: %1</font>',RhenusStatusL))
      ELSE
        AdminMailQueueFunctions.AddText(STRSUBSTNO('Rhenus: %1',RhenusStatusL));

      IF DDStatusL = 0 THEN
        AdminMailQueueFunctions.AddText(STRSUBSTNO('<font color="Red">DocData: %1</font>',DDStatusL))
      ELSE
        AdminMailQueueFunctions.AddText(STRSUBSTNO('DocData: %1',DDStatusL));

      IF DHLStatusL = 0 THEN
        AdminMailQueueFunctions.AddText(STRSUBSTNO('<font color="Red">DHL: %1</font>',DHLStatusL))
      ELSE
        AdminMailQueueFunctions.AddText(STRSUBSTNO('DHL: %1',DHLStatusL));

      AdminMailQueueFunctions.AddText(STRSUBSTNO(' Gesamt: %1',TotalParcelsL));
      AdminMailQueueFunctions.AddText(' ');
      AdminMailQueueFunctions.AddText('<i>Single Logs</i>');
      //H1518 04.09.14 FF +++++++++++++++++++++++++++++++++++++++++
      AdminMailQueueFunctions.AddText('<small><font color="#A3A3A3">Transferred Information per Distributor</font></small>');
      //H1518 04.09.14 FF -----------------------------------------
      IF RhenusChangeLogL = 0 THEN
        AdminMailQueueFunctions.AddText(STRSUBSTNO('<font color="Red">Rhenus Change Log: %1</font>',RhenusChangeLogL))
      ELSE
        AdminMailQueueFunctions.AddText(STRSUBSTNO('Rhenus Change Log: %1',RhenusChangeLogL));
        IF LcountRehnusOut = 0 THEN
           AdminMailQueueFunctions.AddText(STRSUBSTNO('<font color="Red">Last hour: %1</font>',LcountRehnusOut))
        ELSE
          AdminMailQueueFunctions.AddText(STRSUBSTNO('Last hour: %1',LcountRehnusOut));


      IF DDLogL = 0 THEN
        AdminMailQueueFunctions.AddText(STRSUBSTNO('<font color="Red">DocData Log: %1</font>',DDLogL))
      ELSE
        AdminMailQueueFunctions.AddText(STRSUBSTNO('DocData Log: %1',DDLogL));

        IF LCountDDOut = 0 THEN
           AdminMailQueueFunctions.AddText(STRSUBSTNO('<font color="Red">Last Hour: %1</font>',LCountDDOut))
        ELSE
          AdminMailQueueFunctions.AddText(STRSUBSTNO('Last Hour: %1',LCountDDOut));

      AdminMailQueueFunctions.AddText(STRSUBSTNO('Errors: %1',DHLCrossdockErrorL));
      AdminMailQueueFunctions.AddText(' ');
      AdminMailQueueFunctions.AddText('<b>After Sales</b>');
      //H1518 04.09.14 FF +++++++++++++++++++++++++++++++++++++++++
      AdminMailQueueFunctions.AddText('<small><font color="#A3A3A3">Processes after order system</font></small>');
      //H1518 04.09.14 FF -----------------------------------------
      AdminMailQueueFunctions.AddText('<i>Sales</i>');
      //H1518 04.09.14 FF +++++++++++++++++++++++++++++++++++++++++
      AdminMailQueueFunctions.AddText('<small><font color="#A3A3A3">Posted shipments</font></small>');
      //H1518 04.09.14 FF -----------------------------------------
      AdminMailQueueFunctions.AddText(STRSUBSTNO('Sales Orders (to post): %1',SalesPostL));
      AdminMailQueueFunctions.AddText(STRSUBSTNO('Errors: %1',SalesPostErrorL));

      IF SalesPost2L = 0 THEN
        AdminMailQueueFunctions.AddText(STRSUBSTNO('<font color="Red">Sales Orders (posted): %1</font>',SalesPost2L))
      ELSE
        AdminMailQueueFunctions.AddText(STRSUBSTNO('Sales Orders (posted): %1',SalesPost2L));

      AdminMailQueueFunctions.AddText(' ');
      //H1518 04.09.14 FF +++++++++++++++++++++++++++++++++++++++++
      AdminMailQueueFunctions.AddText('<small><font color="#A3A3A3">Customer invoices</font></small>');
      //H1518 04.09.14 FF -----------------------------------------
      AdminMailQueueFunctions.AddText(STRSUBSTNO('Sales Orders E-Mail (to send): %1',SalesEMailL));
      AdminMailQueueFunctions.AddText(STRSUBSTNO('Errors: %1',SalesEMailErrorL));
      IF SalesEMail2L = 0 THEN
        AdminMailQueueFunctions.AddText(STRSUBSTNO('<font color="Red">Sales Orders E-Mail (versendet): %1</font>',SalesEMail2L))
      ELSE
        AdminMailQueueFunctions.AddText(STRSUBSTNO('Sales Orders E-Mail (sent): %1',SalesEMail2L));
      AdminMailQueueFunctions.AddText(' ');
      AdminMailQueueFunctions.AddText('<i>Purchase</i>');
      //H1518 04.09.14 FF +++++++++++++++++++++++++++++++++++++++++
      AdminMailQueueFunctions.AddText('<small><font color="#A3A3A3">Purchasing and Dropship orders</font></small>');
      //H1518 04.09.14 FF -----------------------------------------
      AdminMailQueueFunctions.AddText(STRSUBSTNO('Purchase Orders (not yet created): %1',PurchOrderL));
      IF PurchOrderErrorL > 0 THEN
        AdminMailQueueFunctions.AddText(STRSUBSTNO('<font color="Red">Previous Error: %1</font>',PurchOrderErrorL))
      ELSE
        AdminMailQueueFunctions.AddText(STRSUBSTNO('Errors: %1',PurchOrderErrorL));

      IF PurchOrder2L = 0 THEN
        AdminMailQueueFunctions.AddText(STRSUBSTNO('<font color="Red">Purchase Orders (angelegt): %1</font>',PurchOrder2L))
      ELSE
        AdminMailQueueFunctions.AddText(STRSUBSTNO('Purchase Orders (created): %1',PurchOrder2L));
      AdminMailQueueFunctions.AddText(' ');
      AdminMailQueueFunctions.AddText(STRSUBSTNO('Purchase Orders (to post): %1',PurchPostL));
      IF PurchPostErrorL > 0 THEN
        AdminMailQueueFunctions.AddText(STRSUBSTNO('<font color="Red">Errors: %1</font>',PurchPostErrorL))
      ELSE
        AdminMailQueueFunctions.AddText(STRSUBSTNO('Errors: %1', PurchPostErrorL));

      AdminMailQueueFunctions.AddText(STRSUBSTNO('Purchase Orders (posted): %1', PurchPost2L));
      AdminMailQueueFunctions.AddText(' ');
      //H1518 04.09.14 FF +++++++++++++++++++++++++++++++++++++++++
      AdminMailQueueFunctions.AddText('<small><font color="#A3A3A3">Order-E-Mails</font></small>');
      //H1518 04.09.14 FF -----------------------------------------
      AdminMailQueueFunctions.AddText(STRSUBSTNO('Purchase Orders E-Mail (to send): %1', PurchEMailL));
      IF PurchEMailErrorL > 0 THEN
        AdminMailQueueFunctions.AddText(STRSUBSTNO('<font color="Red">Errors: %1</font>', PurchEMailErrorL))
      ELSE
        AdminMailQueueFunctions.AddText(STRSUBSTNO('Errors: %1',PurchEMailErrorL));

      IF PurchEMail2L = 0 THEN
        AdminMailQueueFunctions.AddText(STRSUBSTNO('<font color="Red">Purchase Orders E-Mail (sent): %1</font>',PurchEMail2L))
      ELSE
        AdminMailQueueFunctions.AddText(STRSUBSTNO('Purchase Orders E-Mail (sent): %1',PurchEMail2L));

      AdminMailQueueFunctions.AddText(' ');
      AdminMailQueueFunctions.AddText('<b>EDI Orders</b>');
      AdminMailQueueFunctions.AddText(STRSUBSTNO('Inbound: %1',InboundEDIOrdersL));
      AdminMailQueueFunctions.AddText(STRSUBSTNO('Outbound: %1',OutboundEDIOrdersL));

      AdminMailQueueFunctions.AddText(' ');
      AdminMailQueueFunctions.AddText('<b>Mails - Face to the Customer</b>');
      //H1518 04.09.14 FF +++++++++++++++++++++++++++++++++++++++++
      AdminMailQueueFunctions.AddText('<small><font color="#A3A3A3">Automatic Mail from Shop & NAV</font></small>');
      //H1518 04.09.14 FF -----------------------------------------

      ShippingInfoWebServiceAdressL := 'Sent by Nav';
      ShippingInfoMaxRunCountL := 0;
      ShippingInfosTimeoutSecL := 0;

      IF SCQueueCodesTmpL.FIND('-') THEN
        REPEAT
          IF SCQueueCodesTmpL.Code = 'SHIPPINGINFORMATION' THEN BEGIN
            ShippingInfoWebServiceAdressL := SCQueueCodesTmpL."Web Service Adress";
            ShippingInfoMaxRunCountL := SCQueueCodesTmpL."Max. Run Count";
            ShippingInfosTimeoutSecL := SCQueueCodesTmpL."Timeout (Sec.)";
          END ELSE BEGIN
            IF SCQueueCodesTmpL."Max. Run Count" = 0 THEN
              AdminMailQueueFunctions.AddText(STRSUBSTNO('<font color="Red">%1 (%2): %3</font>',SCQueueCodesTmpL.Code,
                                              SCQueueCodesTmpL."Web Service Adress",
                                              SCQueueCodesTmpL."Max. Run Count"))
            ELSE
              AdminMailQueueFunctions.AddText(STRSUBSTNO('%1 (%2): %3',SCQueueCodesTmpL.Code,SCQueueCodesTmpL."Web Service Adress",
                                            SCQueueCodesTmpL."Max. Run Count"));

              AdminMailQueueFunctions.AddText(STRSUBSTNO('Unsent: %1',SCQueueCodesTmpL."Timeout (Sec.)"));

            AdminMailQueueFunctions.AddText(' ');
          END;
          TotalCustomerMailsL += SCQueueCodesTmpL."Max. Run Count";
          TotalCustomerMailsErrorL += SCQueueCodesTmpL."Timeout (Sec.)";
        UNTIL SCQueueCodesTmpL.NEXT = 0;

      //H1518 04.09.14 FF +++++++++++++++++++++++++++++++++++++++++
      AdminMailQueueFunctions.AddText('<small><font color="#A3A3A3">Shipping confirmations:</font></small>');
      //H1518 04.09.14 FF -----------------------------------------
      IF ShippingInfoMaxRunCountL = 0 THEN BEGIN
        AdminMailQueueFunctions.AddText(STRSUBSTNO('<font color="Red">%1 (%2): %3</font>','SHIPPINGINFORMATION',
                                        ShippingInfoWebServiceAdressL,ShippingInfoMaxRunCountL));
        AdminMailQueueFunctions.AddText(STRSUBSTNO('Unsent: %1',ShippingInfosTimeoutSecL));

        AdminMailQueueFunctions.AddText(' ');
      END ELSE BEGIN
        AdminMailQueueFunctions.AddText(STRSUBSTNO('%1 (%2): %3','SHIPPINGINFORMATION',ShippingInfoWebServiceAdressL,
                                       ShippingInfoMaxRunCountL));
        AdminMailQueueFunctions.AddText(STRSUBSTNO('Unsent: %1',ShippingInfosTimeoutSecL));
        AdminMailQueueFunctions.AddText(' ');
      END;

      AdminMailQueueFunctions.AddText(STRSUBSTNO('Total sent: %1',TotalCustomerMailsL));
      AdminMailQueueFunctions.AddText(STRSUBSTNO('Total unsent: %1',TotalCustomerMailsErrorL));

      AdminMailQueueFunctions.AddText(' ');
      AdminMailQueueFunctions.AddText('<b>Administration</b>');
      //H1518 04.09.14 FF +++++++++++++++++++++++++++++++++++++++++
      AdminMailQueueFunctions.AddText('<small><font color="#A3A3A3">Internal Mails and Administration</font></small>');
      //H1518 04.09.14 FF -----------------------------------------
      IF AdminMailQueuL = 0 THEN
        AdminMailQueueFunctions.AddText(STRSUBSTNO('<font color="Red">Internal Mails sent: %1</font>',AdminMailQueuL))
      ELSE
        AdminMailQueueFunctions.AddText(STRSUBSTNO('Internal Mails send: %1',AdminMailQueuL));
      //H1518 04.09.14 FF +++++++++++++++++++++++++++++++++++++++++
      AdminMailQueueFunctions.AddText('<small><font color="#A3A3A3">Item Master Data</font></small>');
      //H1518 04.09.14 FF -----------------------------------------
      IF ItemImportL = 0 THEN
        AdminMailQueueFunctions.AddText(STRSUBSTNO('<font color="Red">Items imported: %1</font>',ItemImportL))
      ELSE
        AdminMailQueueFunctions.AddText(STRSUBSTNO('Items imported: %1',ItemImportL));

      AdminMailQueueFunctions.AddText(STRSUBSTNO('Objects changed: %1',ObjectModificationL));

      AdminMailQueueFunctions.AddText(' ');
      //H1518 04.09.14 FF +++++++++++++++++++++++++++++++++++++++++
      AdminMailQueueFunctions.AddText('<small><font color="#A3A3A3">Last FTP Transfer per active Interface</font></small>');
      //H1518 04.09.14 FF -----------------------------------------
      FTPLogL.SETCURRENTKEY("Interface Code","Upload/Download");
      IF FTPLogL.FINDFIRST THEN BEGIN

        //H0610 11.10.13  FF +++++++++++++++++++++++++++++
        AdminMailQueueFunctions.SetIgnoreLineBreak(TRUE);
        //H0610 11.10.13  FF -----------------------------

      AdminMailQueueFunctions.AddText('<TABLE>');

        REPEAT
          AdminMailQueueFunctions.AddText('<TR>');
          NrFilesOnLocalDIsk := 0;
          NrFilesOnFTPServer := 0;
          IF (FTPLogL."Interface Code" = 'DOCDATA') AND (FTPLogL."Upload/Download" = FTPLogL."Upload/Download"::Upload) THEN BEGIN
            NrFilesOnLocalDIsk := LastFTPTransferDDUpNrWait;
            NrFilesOnFTPServer := LastFTPTransferDDUpNr;
          END;
          IF (FTPLogL."Interface Code" = 'DOCDATA') AND (FTPLogL."Upload/Download" = FTPLogL."Upload/Download"::Download) THEN BEGIN
            NrFilesOnLocalDIsk := LastFTPTransferDDDownNr;
            NrFilesOnFTPServer := LastFTPTransferDDDownNrWait;
          END;
          IF (FTPLogL."Interface Code" = 'RHENUS') AND (FTPLogL."Upload/Download" = FTPLogL."Upload/Download"::Upload) THEN BEGIN
            NrFilesOnLocalDIsk := LastFTPTransferRHEUpNrWait;
            NrFilesOnFTPServer := LastFTPTransferRHEUpNr;
          END;
          IF (FTPLogL."Interface Code" = 'RHENUS') AND (FTPLogL."Upload/Download" = FTPLogL."Upload/Download"::Download) THEN BEGIN
            NrFilesOnLocalDIsk := LastFTPTransferRHEDownNr;
            NrFilesOnFTPServer := LastFTPTransferRHEDownNrWait;
          END;

          IF ((TimeStampEndV - FTPLogL.Timestamp) > 1000*3600) THEN
            AdminMailQueueFunctions.AddText(STRSUBSTNO('<font color="Red"><TD>%1 (%2) at</TD> <TD>%3<TD/><TD>%4</TD><TD>%5<TD></font>'
            ,FTPLogL."Interface Code",FTPLogL."Upload/Download",FTPLogL.Timestamp,NrFilesOnLocalDIsk,NrFilesOnFTPServer))
          ELSE
            AdminMailQueueFunctions.AddText(STRSUBSTNO('<TD>%1 (%2) at</TD> <TD>%3</TD><TD>%4</TD><TD>%5</TD>',
            FTPLogL."Interface Code",FTPLogL."Upload/Download",FTPLogL.Timestamp,NrFilesOnLocalDIsk,NrFilesOnFTPServer));
      //H0536 30.08.13  FF ++++++++++++++++++++++
        //AdminMailQueueFunctions.AddText('<TR>');
        AdminMailQueueFunctions.AddText('</TR>');

      //H0536 30.08.13  FF ----------------------
        UNTIL FTPLogL.NEXT = 0;


        AdminMailQueueFunctions.AddText('</TABLE>');
        //H0610 11.10.13  FF +++++++++++++++++++++++++++++
        AdminMailQueueFunctions.SetIgnoreLineBreak(FALSE);
        //H0610 11.10.13  FF -----------------------------

      END ELSE
        AdminMailQueueFunctions.AddText(STRSUBSTNO('<font color="Red">NO FTP TRANSFER!!</font>'));

      OMProjectL.SETRANGE("Status Code",'60-TRANSPORTED');
      OMProjectL.SETRANGE("Date Time Changed",TimeStampStartL,TimeStampEndL);
      IF OMProjectL.FINDSET THEN BEGIN
        AdminMailQueueFunctions.AddText(' ');
        AdminMailQueueFunctions.AddText(STRSUBSTNO('Today Deployment: %1',OMProjectL.COUNT));
        REPEAT
          AdminMailQueueFunctions.AddText(STRSUBSTNO('%1 (%2) %3',OMProjectL."No.",OMProjectL."Active User",OMProjectL.Description));
        UNTIL OMProjectL.NEXT = 0;
      END;

      // Job Queue Activities
      AdminMailQueueFunctions.AddText(' ');
      //H1518 04.09.14 FF +++++++++++++++++++++++++++++++++++++++++
      AdminMailQueueFunctions.AddText('<small><font color="#A3A3A3">Job Queue Activities</font></small>');
      //H1518 04.09.14 FF -----------------------------------------
      AdminMailQueueFunctions.AddText(STRSUBSTNO('Job Queue Entries (On Hold): %1',JobQueueEntryStatusOnHold));
      AdminMailQueueFunctions.AddText(STRSUBSTNO('Job Queue Entries (Ready): %1',JobQueueEntryStatusReady));

      //H0357 23.05.13  FF ++++++++++++++++++++++
      //IF JobQueueEntryStatusInProcess > 1 THEN
      IF JobQueueEntryStatusInProcess > 2 THEN
      //H0357 23.05.13  FF ----------------------
        AdminMailQueueFunctions.AddText(STRSUBSTNO('<font color="Red">Job Queue Entries (In Process): %1</font>',
                                        JobQueueEntryStatusInProcess))

      ELSE
        AdminMailQueueFunctions.AddText(STRSUBSTNO('Job Queue Entries (In Process): %1',JobQueueEntryStatusInProcess));

      IF JobQueueEntryStatusError > 0 THEN
        AdminMailQueueFunctions.AddText(STRSUBSTNO('<font color="Red">Job Queue Entries (Error): %1</font>',
                                        JobQueueEntryStatusError))
      ELSE
        AdminMailQueueFunctions.AddText(STRSUBSTNO('Job Queue Entries (Error): %1',JobQueueEntryStatusError));

      AdminMailQueueFunctions.AddText(' ');

      IF JobQueueEntryStatusInProcess > 0 THEN BEGIN
        JobQueueEntryProcessedL.RESET;
        JobQueueEntryProcessedL.SETRANGE(Status,JobQueueEntryProcessedL.Status::"In Process");
       IF JobQueueEntryProcessedL.FINDSET THEN BEGIN
          AdminMailQueueFunctions.AddText('Job Queue Entries "In Process"');
          REPEAT
            JobQueueEntryProcessedL.CALCFIELDS("Object Name to Run");
            AdminMailQueueFunctions.AddText(COPYSTR(STRSUBSTNO('%1 %2 %3',
                JobQueueEntryProcessedL."Object Type to Run",
                JobQueueEntryProcessedL."Object ID to Run",
                JobQueueEntryProcessedL."Object Name to Run"),
                1,250));
          UNTIL JobQueueEntryProcessedL.NEXT = 0;
          AdminMailQueueFunctions.AddText(' ');
        END;
      END;

      IF JobQueueLogEntriesL = 0 THEN
        AdminMailQueueFunctions.AddText(STRSUBSTNO('<font color="Red">Job Queue Transactions: %1</font>',JobQueueLogEntriesL))
      ELSE
        AdminMailQueueFunctions.AddText(STRSUBSTNO('Job Queue Transactions: %1',JobQueueLogEntriesL));

      AdminMailQueueFunctions.AddText(STRSUBSTNO('Job Queue Errors: %1',JobQueueLogEntriesErrorL));

      JobQueueLogEntryL.RESET;
      JobQueueLogEntryL.SETRANGE("End Date/Time",TimeStampStartL,TimeStampEndL);
      JobQueueLogEntryL.SETRANGE(Status,JobQueueLogEntryL.Status::Error);
      IF JobQueueLogEntryL.FINDSET THEN BEGIN
        AdminMailQueueFunctions.AddText(' ');
        AdminMailQueueFunctions.AddText('Errors');
        REPEAT
          JobQueueLogEntryL.CALCFIELDS("Object Name to Run");
          AdminMailQueueFunctions.AddText(COPYSTR(STRSUBSTNO('%1 %2 %3: %4',
              JobQueueLogEntryL."Object Type to Run",
              JobQueueLogEntryL."Object ID to Run",
              JobQueueLogEntryL."Object Name to Run",
              JobQueueLogEntryL."Error Message" +
              JobQueueLogEntryL."Error Message 2" +
              JobQueueLogEntryL."Error Message 3" +
              JobQueueLogEntryL."Error Message 4"),1,250));
        UNTIL JobQueueLogEntryL.NEXT = 0;
        AdminMailQueueFunctions.AddText(' ');
      END;

      // Footer
      AdminMailQueueFunctions.AddText('<hr />');
      AdminMailQueueFunctions.AddText(' ');
      //H1518 04.09.14 FF +++++++++++++++++++++++++++++++++++++++++
      AdminMailQueueFunctions.AddText('<font color="#A3A3A3">With the kind support: Your ERP Team</font>');
      //H1518 04.09.14 FF -----------------------------------------
      AdminMailQueueFunctions.AddText(' ');

      AdminMailQueueFunctions.FinishMail;
    END;

    PROCEDURE CheckMailDowntime@1000000003(MailCodeV@1000000002 : Code[20]) DowntimeActive : Boolean;
    VAR
      AdminMailQueueSetupL@1000000000 : Record 50092;
      AdminMailQueueCodesL@1000000001 : Record 50118;
      DownOnDateL@1000000003 : ARRAY [7] OF Boolean;
      CurrentWeekDayL@1000000004 : Integer;
    BEGIN
      //H0473 06.08.13  FF +++++++++++++++++++++++

      DowntimeActive := FALSE;
      IF AdminMailQueueCodesL.GET(MailCodeV) THEN;

      //Check Singular Downtime
      IF (CURRENTDATETIME >= AdminMailQueueCodesL."Singular Downtime Start") AND
         (CURRENTDATETIME <= AdminMailQueueCodesL."Singular Downtime End") THEN
        DowntimeActive := TRUE;

      //Check Regular Downtime
      CurrentWeekDayL := DATE2DWY(TODAY,1);

      DownOnDateL[7] := AdminMailQueueCodesL."Downtime on Sundays";
      DownOnDateL[1] := AdminMailQueueCodesL."Downtime on Mondays";
      DownOnDateL[2] := AdminMailQueueCodesL."Downtime on Tuesdays";
      DownOnDateL[3] := AdminMailQueueCodesL."Downtime on Wednesdays";
      DownOnDateL[4] := AdminMailQueueCodesL."Downtime on Thursdays";
      DownOnDateL[5] := AdminMailQueueCodesL."Downtime on Fridays";
      DownOnDateL[6] := AdminMailQueueCodesL."Downtime on Saturdays";

      IF (DT2TIME(CURRENTDATETIME) >= AdminMailQueueCodesL."Regular Downtime Start") AND
         (DT2TIME(CURRENTDATETIME) <= AdminMailQueueCodesL."Regular Downtime End") AND
         (DownOnDateL[CurrentWeekDayL] = TRUE) THEN
        DowntimeActive := TRUE;

      //H0473 06.08.13  FF -----------------------
    END;

    PROCEDURE CheckMailActive@1000000004(MailCodeV@1000000000 : Code[20]) MailActive : Boolean;
    VAR
      AdminMailQueueSetupL@1000000002 : Record 50092;
      AdminMailQueueCodesL@1000000001 : Record 50118;
    BEGIN
      //H0535 06.08.13  FF +++++++++++++++++++++++
      IF AdminMailQueueCodesL.GET(MailCodeV) THEN BEGIN
        IF AdminMailQueueCodesL."Mail active" = TRUE THEN
          MailActive := TRUE
        ELSE
          MailActive := FALSE;
      END ELSE
        MailActive := FALSE;

      //H0535 06.08.13  FF -----------------------
    END;

    PROCEDURE CheckActionWorksheet@1000000006(OMActionV@1000000001 : Record 11102048;UserV@1000000000 : Code[20]);
    VAR
      OMActionL@1000000002 : Record 11102048;
    BEGIN
      //H0555 10.09.13  FF +++++++++++++++++++++++
      AdminMailQueueSetup.GET;
      //Create Mail
      AdminMailQueueFunctions.InitMail(AdminMailQueueSetup."Action Worksheet Mail Code",TeamLeader);
      AdminMailQueueFunctions.AddSubject('Action Worksheets');

      AdminMailQueueFunctions.AddText(' ');

      AdminMailQueueFunctions.AddText(STRSUBSTNO('Action Worksheet Code: %1',OMActionV."No."));
      AdminMailQueueFunctions.AddText(STRSUBSTNO('Started by: %1',UserV));
      AdminMailQueueFunctions.AddText(STRSUBSTNO('Date: %1',TODAY));
      AdminMailQueueFunctions.AddText(STRSUBSTNO('Time: %1',DT2TIME(CURRENTDATETIME)));
      AdminMailQueueFunctions.AddText(' ');

      AdminMailQueueFunctions.SetIgnoreLineBreak(TRUE);
      AdminMailQueueFunctions.AddText('<table>');
      AdminMailQueueFunctions.AddText('<tr>');
      AdminMailQueueFunctions.AddText('<td>');
      AdminMailQueueFunctions.AddText('<b>');
      AdminMailQueueFunctions.AddText('Action Type<font color="White">__</font>');
      AdminMailQueueFunctions.AddText('</b>');
      AdminMailQueueFunctions.AddText('</td>');
      AdminMailQueueFunctions.AddText('<td>');
      AdminMailQueueFunctions.AddText('<b>');
      AdminMailQueueFunctions.AddText('Object No.<font color="White">__</font>');
      AdminMailQueueFunctions.AddText('</b>');
      AdminMailQueueFunctions.AddText('</td>');
      AdminMailQueueFunctions.AddText('<td>');
      AdminMailQueueFunctions.AddText('<b>');
      AdminMailQueueFunctions.AddText('Object Name<font color="White">__</font>');
      AdminMailQueueFunctions.AddText('</b>');
      AdminMailQueueFunctions.AddText('</td>');
      AdminMailQueueFunctions.AddText('<td>');
      AdminMailQueueFunctions.AddText('<b>');
      AdminMailQueueFunctions.AddText('Fields');
      AdminMailQueueFunctions.AddText('</b>');
      AdminMailQueueFunctions.AddText('</td>');

      AdminMailQueueFunctions.AddText('</tr>');

      OMActionL.SETRANGE("No.",OMActionV."No.");
      IF OMActionL.FINDSET THEN BEGIN
        REPEAT
          AdminMailQueueFunctions.AddText('<tr>');
          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(FORMAT(OMActionL."Action Type")+'<font color="White">_</font>');
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');
          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(FORMAT(OMActionL."Object No.")+'<font color="White">_</font>');
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');
          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(FORMAT(OMActionL."Object Name")+'<font color="White">_</font>');
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');
          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<small>');
          AdminMailQueueFunctions.AddText(FORMAT(OMActionL.Fields)+'<font color="White">_</font>');
          AdminMailQueueFunctions.AddText('</small>');
          AdminMailQueueFunctions.AddText('</td>');
          AdminMailQueueFunctions.AddText('</tr>');

        UNTIL OMActionL.NEXT = 0;
      END;
      AdminMailQueueFunctions.AddText('</table>');
      AdminMailQueueFunctions.SetIgnoreLineBreak(FALSE);

      AdminMailQueueFunctions.FinishMail;

      //H0555 10.09.13  FF -----------------------
    END;

    PROCEDURE CheckChangeLog@1000000007();
    VAR
      AdminMailQueueSetupL@1000000000 : Record 50092;
      AdminMailQueueCodesL@1000000008 : Record 50118;
      CurrentPrimKeyL@1000000007 : Text[250];
      CurrentTableNoL@1000000006 : Integer;
      AdminMailQueueLog2L@1000000005 : Record 50093;
      CurrentUserL@1000000004 : Code[20];
      JobQueueEntryL@1000000003 : Record 472;
      JobQueueEntryIDL@1000000002 : GUID;
      WindowsLoginL@1000000001 : Record 2000000054;
      AdminMailQueueLogL@1000000009 : Record 50093;
      SendChangeLogMailL@1000000010 : Boolean;
      ChangeLogEntryL@1000000011 : Record 405;
      ChangeLogEntryTempL@1000000013 : TEMPORARY Record 405;
      ChangeLogSetupTableL@1000000012 : Record 403;
      CurrentTableNoTempL@1000000014 : Integer;
      LastProcessingDateTimeL@1000000015 : DateTime;
    BEGIN
      //Change Log Mail
      //H0633 23.10.13  FF ++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      SendChangeLogMailL := TRUE;
      IF AdminMailQueueSetupL.GET THEN;
      CLEAR(CurrentTableNoTempL);
      CLEAR(LastProcessingDateTimeL);

      //H0669 04.11.13  FF ++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      IF (CheckMailDowntime(AdminMailQueueSetupL."Change Log Mail Code") = TRUE) OR
         (CheckMailActive(AdminMailQueueSetupL."Change Log Mail Code") = FALSE) THEN
        SendChangeLogMailL := FALSE;

      //H0669 04.11.13  FF --------------------------------------------------------

        AdminMailQueueLogL.RESET;
        AdminMailQueueLogL.SETCURRENTKEY("Mail Code");
        //H0535 29.08.13  FF ++++++++++++++++++++++
        //AdminMailQueueLogL.SETRANGE("Mail Code",STRSUBSTNO('%1CHANGELOG',AdminMailQueueSetup."Monitoring Mail Code"));
        AdminMailQueueLogL.SETRANGE("Mail Code",AdminMailQueueSetupL."Change Log Mail Code");
        //H0535 29.08.13  FF ----------------------
        IF AdminMailQueueLogL.FINDLAST THEN BEGIN
          IF (FORMAT(AdminMailQueueLogL."Processing Date/Time") = '') THEN
            SendChangeLogMailL := FALSE
          ELSE
             IF ((TIME < DT2TIME(AdminMailQueueLogL."Processing Date/Time")) AND (TIME < 010000T)) OR
                (ROUND(ABS(TIME - DT2TIME(AdminMailQueueLogL."Processing Date/Time"))/1000/60,1) < 30) THEN
                SendChangeLogMailL := FALSE;
        END;

        //Filter Change Log to time of last Change Log Mail
        AdminMailQueueLogL.SETFILTER("Processing Date/Time",'<>%1',0DT);

        IF AdminMailQueueLogL.FINDLAST THEN BEGIN
        IF (DT2DATE(AdminMailQueueLogL."Processing Date/Time") = TODAY) THEN BEGIN
          //(FORMAT(AdminMailQueueLogL."Processing Date/Time") <> '') THEN BEGIN
          ChangeLogEntryL.SETFILTER("Date and Time",'%1..',AdminMailQueueLogL."Processing Date/Time");
          LastProcessingDateTimeL := AdminMailQueueLogL."Processing Date/Time";
        END ELSE BEGIN
          ChangeLogEntryL.SETFILTER("Date and Time",'%1..',CREATEDATETIME(TODAY,000001T));
          LastProcessingDateTimeL := CREATEDATETIME(TODAY,000001T);
        END;
      END;


        IF ChangeLogEntryL.ISEMPTY THEN
          SendChangeLogMailL := FALSE
        ELSE BEGIN
          //Only filter the "Monitoring active" records and write them into the temp table
          IF ChangeLogEntryL.FINDSET THEN BEGIN
            REPEAT
              IF ChangeLogSetupTableL.GET(ChangeLogEntryL."Table No.") AND (ChangeLogSetupTableL."Monitoring active" = TRUE) THEN BEGIN
                ChangeLogEntryTempL.INIT;
                ChangeLogEntryTempL.TRANSFERFIELDS(ChangeLogEntryL);
                ChangeLogEntryTempL.INSERT;
              END;
            UNTIL ChangeLogEntryL.NEXT = 0;
            IF ChangeLogSetupTableL.ISEMPTY THEN
              SendChangeLogMailL := FALSE;
          END;
        END;

      //H1044 18.06.14  FF ++++++++++++++++++++++++++++++++

      //IF SendChangeLogMailL AND (ChangeLogEntryTempL.FINDSET) THEN BEGIN
      IF (ChangeLogEntryTempL.FINDSET) THEN BEGIN
      ChangeLogEntryTempL.SETCURRENTKEY("Table No.","Primary Key Field 1 Value");

      REPEAT
        CurrentTableNoTempL := ChangeLogEntryTempL."Table No.";
        ChangeLogEntryTempL.SETRANGE("Table No.",CurrentTableNoTempL);
        IF ChangeLogEntryTempL.FINDSET THEN BEGIN
          CreateChangeLogMail(CurrentTableNoTempL,LastProcessingDateTimeL);
          ChangeLogEntryTempL.DELETEALL; //Record is filtered
          ChangeLogEntryTempL.SETRANGE("Table No.");
          ChangeLogEntryTempL.RESET;
        END;
      UNTIL ChangeLogEntryTempL.NEXT = 0;

      //H1044 18.06.14  FF --------------------------------
      END;
      //H0633 23.10.13  FF -------------------------------------------------------
    END;

    PROCEDURE CreateChangeLogMail@1000000017(TableNoV@1000000000 : Integer;LastProcessingDateTimeV@1000000004 : DateTime);
    VAR
      AdminMailQueueSetupL@1000000016 : Record 50092;
      AdminMailQueueCodesL@1000000015 : Record 50118;
      CurrentPrimKeyL@1000000014 : Text[250];
      CurrentTableNoL@1000000013 : Integer;
      AdminMailQueueLog2L@1000000012 : Record 50093;
      CurrentUserL@1000000011 : Code[20];
      JobQueueEntryL@1000000010 : Record 472;
      JobQueueEntryIDL@1000000009 : GUID;
      WindowsLoginL@1000000008 : Record 2000000054;
      AdminMailQueueLogL@1000000007 : Record 50093;
      SendChangeLogMailL@1000000006 : Boolean;
      ChangeLogEntryL@1000000005 : Record 405;
      ChangeLogSetupTableL@1000000002 : Record 403;
      CurrentTableNoTempL@1000000001 : Integer;
      ChangeLogEntryTempL@1000000003 : TEMPORARY Record 405;
    BEGIN
      //H1044 18.06.14  FF ++++++++++++++++++++++++++++++++
      //moved to seperate function from CheckChangeLog and changed

      //Filter Change Log to time of last Change Log Mail
      IF AdminMailQueueSetupL.GET THEN;

          ChangeLogEntryL.SETFILTER("Date and Time",'%1..',LastProcessingDateTimeV);
          //ChangeLogEntryL.SETCURRENTKEY("Table No.","Primary Key Field 1 Value");
          ChangeLogEntryL.SETRANGE("Table No.",TableNoV);
          //Only filter the "Monitoring active" records and write them into the temp table
          IF ChangeLogEntryL.FINDSET THEN BEGIN
            REPEAT
              IF ChangeLogSetupTableL.GET(ChangeLogEntryL."Table No.") AND (ChangeLogSetupTableL."Monitoring active" = TRUE) THEN BEGIN
                ChangeLogEntryTempL.INIT;
                ChangeLogEntryTempL.TRANSFERFIELDS(ChangeLogEntryL);
                ChangeLogEntryTempL.INSERT;
              END;
            UNTIL ChangeLogEntryL.NEXT = 0;
          END;
          //H0535,H1044 18.06.14  FF ++++++++++++++++++++++
          //AdminMailQueueFunctions.InitMail(STRSUBSTNO('%1CHANGELOG',AdminMailQueueSetup."Monitoring Mail Code")
          //                                            ,TeamLeader);
        IF NOT ChangeLogEntryTempL.ISEMPTY THEN BEGIN
          AdminMailQueueFunctions.InitMail(AdminMailQueueSetupL."Change Log Mail Code",TeamLeader);
          ChangeLogEntryTempL.CALCFIELDS("Table Name");
          AdminMailQueueFunctions.AddSubject('Change Log Entries - Table: '+FORMAT(ChangeLogEntryTempL."Table No.")
                                            +' '+ChangeLogEntryTempL."Table Name");
          //H0535,H1044 18.06.14  FF --------------------------------
          AdminMailQueueFunctions.SetIgnoreLineBreak(FALSE);

          AdminMailQueueFunctions.AddText(STRSUBSTNO('Change Log Enties for Date: %1',TODAY));
          IF (DT2DATE(LastProcessingDateTimeV) = TODAY) AND
             (DT2TIME(LastProcessingDateTimeV) <> 0T) THEN
            AdminMailQueueFunctions.AddText(STRSUBSTNO('Change Log Entries since: %1',
                                  DT2TIME(LastProcessingDateTimeV)))
          ELSE
            AdminMailQueueFunctions.AddText('Change Log Entries since: 00:00');

          AdminMailQueueFunctions.AddText(' ');

          //H0529 30.08.13  FF ++++++++++++++++++++++
          //Change Log Layout Mail

          //H1044 25.06.14  FF ++++++++++++++++++++++
          IF ChangeLogEntryTempL.FINDSET THEN BEGIN
          //IF NOT ChangeLogEntryTempL.ISEMPTY THEN BEGIN
          //H1044 25.06.14  FF ----------------------
            REPEAT
              AdminMailQueueFunctions.SetIgnoreLineBreak(FALSE);
                    AdminMailQueueFunctions.AddText(' ');
                    ChangeLogEntryTempL.CALCFIELDS("Table Name");

                    //H0610,H0633 23.10.13 11.10.13  FF ++++++++++++++++++++++
                    IF ChangeLogEntryTempL."Table No." = 472 THEN BEGIN
                      EVALUATE(JobQueueEntryIDL,ChangeLogEntryTempL."Primary Key Field 1 Value");
                      IF JobQueueEntryL.GET(JobQueueEntryIDL) THEN;
                      JobQueueEntryL.CALCFIELDS("Object Name to Run");
                      AdminMailQueueFunctions.AddText('<b>Table: '+FORMAT(ChangeLogEntryTempL."Table No.")+
      '<font color="White">__</font>'
                                                      +FORMAT(ChangeLogEntryTempL."Table Name")+'</b><font color="White">__</font>'
                                                      +'<font color="White">____</font>Changed by: '
                                                      +FORMAT(ChangeLogEntryTempL."User ID"));
                      AdminMailQueueFunctions.AddText(FORMAT(JobQueueEntryL."Object Type to Run")+': '
                                                      +FORMAT(JobQueueEntryL."Object ID to Run")+'<font color="White">_</font>'
                                                      +FORMAT(JobQueueEntryL."Object Name to Run"));
                    END ELSE BEGIN
                      IF ChangeLogEntryTempL."Table No." = 2000000054 THEN BEGIN
                      IF WindowsLoginL.GET(ChangeLogEntryTempL."Primary Key Field 1 Value") THEN;
                      WindowsLoginL.CALCFIELDS(ID,Name);
                      AdminMailQueueFunctions.AddText('<b>Table: '+FORMAT(ChangeLogEntryTempL."Table No.")
                                                      +'<font color="White">__</font>'
                                                      +FORMAT(ChangeLogEntryTempL."Table Name")
                                                      //+FORMAT(WindowsLoginL.Name)
                                                      +'</b><font color="White">____</font>Changed by: '
                                                      +FORMAT(ChangeLogEntryTempL."User ID"));
                      AdminMailQueueFunctions.AddText('Windows Login: '+FORMAT(WindowsLoginL.Name));
                      END ELSE BEGIN

                    //H0610,H0633 23.10.13  FF ----------------------
                        AdminMailQueueFunctions.AddText('<b>Table: '+FORMAT(ChangeLogEntryTempL."Table No.")
                                                        +'<font color="White">__</font>'
                                                        +FORMAT(ChangeLogEntryTempL."Table Name")+'</b><font color="White">__</font>'
                        //H0607,H0633 23.10.13  FF ++++++++++++++++++++++
                                                        +'<font color="White">____</font>Changed by: '
                                                        +FORMAT(ChangeLogEntryTempL."User ID"));
                        AdminMailQueueFunctions.AddText(FORMAT(ChangeLogEntryTempL."Primary Key"));
                        //H0607,H0633 23.10.13  FF ----------------------

                      END;
                    //H0610 11.10.13  FF ++++++++++++++++++++++
                    END;
                    //H0610 11.10.13  FF ----------------------

              //Innerhalb der Eintrge zu Tabelle x - auf Prim Key filtern und ausgeben
              IF ChangeLogEntryTempL.FINDFIRST THEN BEGIN
                CurrentPrimKeyL := ChangeLogEntryTempL."Primary Key";
                //H0607 10.10.13  FF ++++++++++++++++++++++
                CurrentTableNoL := ChangeLogEntryTempL."Table No.";
                CurrentUserL := ChangeLogEntryTempL."User ID";
                //H0607 10.10.13  FF ----------------------
                ChangeLogEntryTempL.SETRANGE("Primary Key",CurrentPrimKeyL);
                //H0607 10.10.13  FF ++++++++++++++++++++++
                ChangeLogEntryTempL.SETRANGE("Table No.",CurrentTableNoL);
                ChangeLogEntryTempL.SETRANGE("User ID",CurrentUserL);
                //H0607 10.10.13  FF ----------------------
                IF ChangeLogEntryTempL.FINDSET THEN BEGIN
                  AdminMailQueueFunctions.SetIgnoreLineBreak(TRUE);

                    AdminMailQueueFunctions.AddText(' ');

                    AdminMailQueueFunctions.AddText('<table>');
                    AdminMailQueueFunctions.AddText('<tr>');
                    AdminMailQueueFunctions.AddText('<td>');

                    //Description collumn left
                    //H0529 03.09.13  FF ++++++++++++++++++++++++++++++++
                    //AdminMailQueueFunctions.AddText('<table>');
                    AdminMailQueueFunctions.AddText('<table border=1>');
                    //H0529 03.09.13  FF --------------------------------

                    AdminMailQueueFunctions.AddText('<tr>');
                    AdminMailQueueFunctions.AddText('<td>');
                    AdminMailQueueFunctions.AddText('<b>');
                    AdminMailQueueFunctions.AddText('<small>');
                    AdminMailQueueFunctions.AddText('<font color="White">_________</font>');
                    AdminMailQueueFunctions.AddText('</small>');
                    AdminMailQueueFunctions.AddText('</b>');
                    AdminMailQueueFunctions.AddText('</td>');
                    AdminMailQueueFunctions.AddText('</tr>');


                    AdminMailQueueFunctions.AddText('<tr>');
                    AdminMailQueueFunctions.AddText('<td>');
                    AdminMailQueueFunctions.AddText('<b>');
                    AdminMailQueueFunctions.AddText('<small>');
                    AdminMailQueueFunctions.AddText('Old Value:  ');
                    AdminMailQueueFunctions.AddText('</small>');
                    AdminMailQueueFunctions.AddText('</b>');
                    AdminMailQueueFunctions.AddText('</td>');
                    AdminMailQueueFunctions.AddText('</tr>');

                    AdminMailQueueFunctions.AddText('<tr>');
                    AdminMailQueueFunctions.AddText('<td>');
                    AdminMailQueueFunctions.AddText('<b>');
                    AdminMailQueueFunctions.AddText('<small>');
                    AdminMailQueueFunctions.AddText('New Value:  ');
                    AdminMailQueueFunctions.AddText('</small>');
                    AdminMailQueueFunctions.AddText('</b>');
                    AdminMailQueueFunctions.AddText('</td>');
                    AdminMailQueueFunctions.AddText('</tr>');

                    AdminMailQueueFunctions.AddText('</table>');

                    AdminMailQueueFunctions.AddText('</td>');

                  REPEAT
                    AdminMailQueueFunctions.AddText('<td>');

                    AdminMailQueueFunctions.AddText('<table border=1>');
                    //Fieldname
                    AdminMailQueueFunctions.AddText('<tr>');
                    AdminMailQueueFunctions.AddText('<td>');
                    AdminMailQueueFunctions.AddText('<b>');
                    AdminMailQueueFunctions.AddText('<small>');
                    ChangeLogEntryTempL.CALCFIELDS("Field Name");
                    AdminMailQueueFunctions.AddText(ChangeLogEntryTempL."Field Name"+'<font color="White">__</font>');
                    AdminMailQueueFunctions.AddText('</b>');
                    AdminMailQueueFunctions.AddText('</small>');
                    AdminMailQueueFunctions.AddText('</td>');
                    AdminMailQueueFunctions.AddText('</tr>');

                    //Old Value
                    AdminMailQueueFunctions.AddText('<tr>');
                    AdminMailQueueFunctions.AddText('<td>');
                    AdminMailQueueFunctions.AddText('<small>');
                    IF (ChangeLogEntryTempL."Old Value"<>'') AND (ChangeLogEntryTempL."New Value"='') THEN
                      AdminMailQueueFunctions.AddText('<font color="Red">'+ChangeLogEntryTempL."Old Value"+'</font>'
                                                        +'<font color="White">__</font>')
                    ELSE
                      AdminMailQueueFunctions.AddText(ChangeLogEntryTempL."Old Value"+'<font color="White">__</font>');
                    AdminMailQueueFunctions.AddText('<small>');
                    AdminMailQueueFunctions.AddText('</td>');
                    AdminMailQueueFunctions.AddText('</tr>');

                    //New Value
                    AdminMailQueueFunctions.AddText('<tr>');
                    AdminMailQueueFunctions.AddText('<td>');
                    AdminMailQueueFunctions.AddText('<small>');
                    IF (ChangeLogEntryTempL."Old Value"='') AND (ChangeLogEntryTempL."New Value"<>'') THEN
                      AdminMailQueueFunctions.AddText('<font color="Green">'+ChangeLogEntryTempL."New Value"+'</font>'
                                                        +'<font color="White">__</font>')
                    ELSE
                      AdminMailQueueFunctions.AddText(ChangeLogEntryTempL."New Value"+'<font color="White">__</font>');
                    AdminMailQueueFunctions.AddText('<small>');
                    AdminMailQueueFunctions.AddText('</td>');
                    AdminMailQueueFunctions.AddText('</tr>');

                    AdminMailQueueFunctions.AddText('</table>');

                    AdminMailQueueFunctions.AddText('</td>');

                    //when printed, delete from temp table
                    ChangeLogEntryTempL.DELETE;

                  UNTIL ChangeLogEntryTempL.NEXT = 0;
                  AdminMailQueueFunctions.AddText('</tr>');
                  AdminMailQueueFunctions.AddText('</table>');

                  AdminMailQueueFunctions.SetIgnoreLineBreak(TRUE);
                  //H0529 03.09.13  FF ++++++++++++++++++++++++++++++++
                  //AdminMailQueueFunctions.AddText('<hr />');
                  //H0529 03.09.13  FF --------------------------------

                  AdminMailQueueFunctions.AddText('  ');

                  ChangeLogEntryTempL.SETRANGE("Primary Key");
                  //H0607 10.10.13  FF ++++++++++++++++++++++++++++++++
                  ChangeLogEntryTempL.SETRANGE("Table No.");
                  ChangeLogEntryTempL.SETRANGE("User ID");
                  //H0607 10.10.13  FF --------------------------------
                END;
              END;
            UNTIL ChangeLogEntryTempL.NEXT = 0;
          END;
          AdminMailQueueFunctions.FinishMail;
        END;
      //H1044 18.06.14  FF --------------------------------
    END;

    PROCEDURE CheckOMModification@1000000008();
    VAR
      LastModifcationL@1000000005 : DateTime;
      OMModificationL@1000000004 : Record 11102042;
      SendModificationMailL@1000000003 : Boolean;
      AdminMailQueueSetupL@1000000002 : Record 50092;
      AdminMailQueueCodesL@1000000001 : Record 50118;
      AdminMailQueueLog2L@1000000000 : Record 50093;
      AdminMailQueueLogL@1000000006 : Record 50093;
    BEGIN
      //OM - Modification Mail
      SendModificationMailL := TRUE;

      //H0669 04.11.13  FF ++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      IF (CheckMailDowntime(AdminMailQueueSetup."OM Modification Mail Code") = TRUE) OR
         (CheckMailActive(AdminMailQueueSetup."OM Modification Mail Code") = FALSE) THEN
        SendModificationMailL := FALSE;
      //H0669 04.11.13  FF --------------------------------------------------------

      //H0420 04.07.13  FF ++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      IF AdminMailQueueSetupL.GET THEN;
      //H0535 08.08.13  FF +++++++++++++++++++++++++++++
      //IF AdminMailQueueSetupL."Modification Mail active" THEN BEGIN
      //H0535 08.08.13  FF -----------------------------

        AdminMailQueueLogL.RESET;
        AdminMailQueueLogL.SETCURRENTKEY("Mail Code");
        //H0535 29.08.13  FF ++++++++++++++++++++++
        //AdminMailQueueLogL.SETRANGE("Mail Code",STRSUBSTNO('%1MODIFY',AdminMailQueueSetup."Monitoring Mail Code"));
        AdminMailQueueLogL.SETRANGE("Mail Code",AdminMailQueueSetup."OM Modification Mail Code");

        //H0535 29.08.13  FF ----------------------
        IF AdminMailQueueLogL.FINDLAST THEN BEGIN
          IF (FORMAT(AdminMailQueueLogL."Processing Date/Time") = '') THEN
            SendModificationMailL := FALSE
          ELSE
             IF ((TIME < DT2TIME(AdminMailQueueLogL."Processing Date/Time")) AND (TIME < 010000T)) OR
                (ROUND(ABS(TIME - DT2TIME(AdminMailQueueLogL."Processing Date/Time"))/1000/60,1) < 30) THEN
                SendModificationMailL := FALSE;
        END;

        //Filter OM Modification to time of last Modification email
        OMModificationL.SETRANGE("Insert Date",TODAY);
        IF DT2DATE(AdminMailQueueLogL."Processing Date/Time") = TODAY THEN
          OMModificationL.SETFILTER("Insert Time",'%1..',DT2TIME(AdminMailQueueLogL."Processing Date/Time"));
        IF OMModificationL.ISEMPTY THEN
          SendModificationMailL := FALSE
        ELSE
          IF OMModificationL.FINDSET THEN;


        IF SendModificationMailL = TRUE THEN BEGIN
          //H0535 29.08.13  FF ++++++++++++++++++++++
          //AdminMailQueueFunctions.InitMail(STRSUBSTNO('%1MODIFY',AdminMailQueueSetup."Monitoring Mail Code")
          //                                            ,TeamLeader);
          AdminMailQueueFunctions.InitMail(AdminMailQueueSetupL."OM Modification Mail Code",TeamLeader);

          //H0535 29.08.13  FF ----------------------
          AdminMailQueueFunctions.AddSubject('OM - Modifications');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('Modifications for Date: %1',TODAY));

          //H0554 10.09.13  FF ++++++++++++++++++++++

      //    IF DT2TIME(AdminMailQueueLogL."Processing Date/Time") <> 0T THEN
          AdminMailQueueLog2L.SETRANGE("Mail Code",AdminMailQueueSetup."OM Modification Mail Code");
          AdminMailQueueLog2L.SETFILTER("Processing Date/Time",'%1..%2',CREATEDATETIME(TODAY,000000T),CREATEDATETIME(TODAY,235959T));
          IF (AdminMailQueueLog2L.FINDLAST) AND (DT2TIME(AdminMailQueueLog2L."Processing Date/Time") <> 0T) THEN
          //H0554 10.09.13  FF ----------------------
            AdminMailQueueFunctions.AddText(STRSUBSTNO('Modifications since: %1',
                                    DT2TIME(AdminMailQueueLogL."Processing Date/Time")))
          ELSE
            AdminMailQueueFunctions.AddText('Modifications since: 00:00:00');
          AdminMailQueueFunctions.AddText(' ');
        AdminMailQueueFunctions.AddText(' ');

          //H0497 08.08.13  FF +++++++++++++++++++++++++++++
          AdminMailQueueFunctions.SetIgnoreLineBreak(TRUE);
          //H0497 08.08.13  FF -----------------------------
          AdminMailQueueFunctions.AddText('<table>');
          //Table Captions
          AdminMailQueueFunctions.AddText('<tr>');
          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<b>');
          AdminMailQueueFunctions.AddText('Object Type<font color="White">__</font>');
          AdminMailQueueFunctions.AddText('</b>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<b>');
          AdminMailQueueFunctions.AddText('Object No.<font color="White">__</font>');
          AdminMailQueueFunctions.AddText('</b>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<b>');
          AdminMailQueueFunctions.AddText('Object Name<font color="White">__</font>');
          AdminMailQueueFunctions.AddText('</b>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<b>');
          AdminMailQueueFunctions.AddText('Insert Time<font color="White">__</font>');
          AdminMailQueueFunctions.AddText('</b>');
          AdminMailQueueFunctions.AddText('</td>');

          AdminMailQueueFunctions.AddText('<td>');
          AdminMailQueueFunctions.AddText('<b>');
          AdminMailQueueFunctions.AddText('Inserted by');
          AdminMailQueueFunctions.AddText('</b>');
          AdminMailQueueFunctions.AddText('</td>');
          //H0497 08.08.13  FF +++++++++++++++++++++++++++++
          AdminMailQueueFunctions.AddText('</tr>');
          //H0497 08.08.13  FF -----------------------------

            //Table Lines
          REPEAT
            //H0497 08.08.13  FF +++++++++++++++++++++++++++++
            //AdminMailQueueFunctions.AddText('</tr>');
            //H0497 08.08.13  FF -----------------------------
            AdminMailQueueFunctions.AddText('<tr>');
            AdminMailQueueFunctions.AddText('<td>');
            AdminMailQueueFunctions.AddText('<small>');
            AdminMailQueueFunctions.AddText(FORMAT(OMModificationL."Object Type"));
            AdminMailQueueFunctions.AddText('</small>');
            AdminMailQueueFunctions.AddText('</td>');

            AdminMailQueueFunctions.AddText('<td>');
            AdminMailQueueFunctions.AddText('<small>');
            AdminMailQueueFunctions.AddText(FORMAT(OMModificationL."Object No."));
            AdminMailQueueFunctions.AddText('</small>');
            AdminMailQueueFunctions.AddText('</td>');

            AdminMailQueueFunctions.AddText('<td>');
            AdminMailQueueFunctions.AddText('<small>');
            AdminMailQueueFunctions.AddText(FORMAT(OMModificationL."Object Name"));
            AdminMailQueueFunctions.AddText('</small>');
            AdminMailQueueFunctions.AddText('</td>');

            AdminMailQueueFunctions.AddText('<td>');
            AdminMailQueueFunctions.AddText('<small>');
            AdminMailQueueFunctions.AddText(FORMAT(OMModificationL."Insert Time"));
            AdminMailQueueFunctions.AddText('</small>');
            AdminMailQueueFunctions.AddText('</td>');

            AdminMailQueueFunctions.AddText('<td>');
            AdminMailQueueFunctions.AddText('<small>');
            AdminMailQueueFunctions.AddText(FORMAT(OMModificationL."Inserted By"));
            AdminMailQueueFunctions.AddText('</small>');
            AdminMailQueueFunctions.AddText('</td>');
            AdminMailQueueFunctions.AddText('</tr>');

          UNTIL OMModificationL.NEXT = 0;

          AdminMailQueueFunctions.AddText('</table>');
          //H0497 08.08.13  FF +++++++++++++++++++++++++++++
          AdminMailQueueFunctions.SetIgnoreLineBreak(FALSE);
          //H0497 08.08.13  FF -----------------------------

          AdminMailQueueFunctions.FinishMail;
        END;
      //H0420 04.07.13  FF --------------------------------------------------------
    END;

    PROCEDURE CheckRhenus@1000000009();
    VAR
      SendRhenusMailL@1000000000 : Boolean;
      AdminMailQueueLogL@1000000001 : Record 50093;
      RhenusChangeLogL@1000000002 : Record 50070;
      LastRhenusDateL@1000000003 : DateTime;
    BEGIN
      //H0669 04.11.13  FF ++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      AdminMailQueueSetup.GET;
      SendRhenusMailL := TRUE;

      IF (CheckMailDowntime(AdminMailQueueSetup."Rhenus Mail Code") = TRUE) OR
         (CheckMailActive(AdminMailQueueSetup."Rhenus Mail Code") = FALSE) THEN
        SendRhenusMailL := FALSE;

      //Logistic
      AdminMailQueueLogL.RESET;
      AdminMailQueueLogL.SETCURRENTKEY("Mail Code");

      //H0535 29.08.13  FF ++++++++++++++++++++++
      AdminMailQueueLogL.SETRANGE("Mail Code",AdminMailQueueSetup."Rhenus Mail Code");
      //H0535 29.08.13  FF ----------------------

      IF AdminMailQueueLogL.FINDLAST THEN BEGIN
        IF (FORMAT(AdminMailQueueLogL."Processing Date/Time") = '') THEN
          SendRhenusMailL := FALSE
        ELSE
          IF ((TIME < DT2TIME(AdminMailQueueLogL."Processing Date/Time")) AND (TIME < 010000T)) OR
             (ROUND(ABS(TIME - DT2TIME(AdminMailQueueLogL."Processing Date/Time"))/1000/60,1) < 20) THEN
            SendRhenusMailL := FALSE;
      END;

      RhenusChangeLogL.SETCURRENTKEY("Creation Datetime",Processed);
      RhenusChangeLogL.SETRANGE(Processed,TRUE);
      IF RhenusChangeLogL.FINDLAST THEN BEGIN
        LastRhenusDateL := RhenusChangeLogL."Creation Datetime";
      //H0286,H0329 30.04.13 PAU ++++++++++++++++++++++++++++++++++++++++++++++++
        IF ((TIME < 070000T) AND (ROUND(ABS(CREATEDATETIME(WORKDATE,TIME) - LastRhenusDateL)/1000/60,1) < 150)) OR
           (ROUND(ABS(CREATEDATETIME(WORKDATE,TIME) - LastRhenusDateL)/1000/60,1) < 60) OR
           ((TIME > 180000T) AND (ROUND(ABS(CREATEDATETIME(WORKDATE,TIME) - LastRhenusDateL)/1000/60,1) < 90)) THEN
          SendRhenusMailL := FALSE;

        IF  (TIME > 000000T) AND (TIME < 070000T) AND (ROUND(ABS(CREATEDATETIME(WORKDATE,TIME) - LastRhenusDateL)/1000/60,1) < 150) THEN
          SendRhenusMailL := FALSE;
      //H0286,H0329 30.04.13 PAU ------------------------------------------------

        IF SendRhenusMailL = TRUE THEN BEGIN

          //H0535 29.08.13  FF ++++++++++++++++++++++
          AdminMailQueueFunctions.InitMail(AdminMailQueueSetup."Rhenus Mail Code",TeamLeader);
          //H0535 29.08.13  FF ----------------------
          AdminMailQueueFunctions.AddSubject('Rhenus interface does not work!');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('Last Post from %1',LastRhenusDateL));
          AdminMailQueueFunctions.AddText(STRSUBSTNO('Letzter Dateiname: %1',RhenusChangeLogL."External Document No."));
          AdminMailQueueFunctions.AddText(STRSUBSTNO('Idle since %1 Min.',
                                          ROUND(ABS(CREATEDATETIME(WORKDATE,TIME) - LastRhenusDateL)/1000/60,1)));
          AdminMailQueueFunctions.FinishMail;
        END;
      END;

      //H0669 04.11.13  FF --------------------------------------------------------
    END;

    PROCEDURE CheckDocData@1000000010();
    VAR
      SendDocDataMailL@1000000000 : Boolean;
      AdminMailQueueLogL@1000000001 : Record 50093;
      DDLogL@1000000002 : Record 50066;
      LastDocDataDateL@1000000003 : DateTime;
    BEGIN
      //H0669 04.11.13  FF ++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      AdminMailQueueSetup.GET;
      SendDocDataMailL := TRUE;

      IF (CheckMailDowntime(AdminMailQueueSetup."DocData Mail Code") = TRUE) OR
         (CheckMailActive(AdminMailQueueSetup."DocData Mail Code") = FALSE) THEN
        SendDocDataMailL := FALSE;

      AdminMailQueueLogL.RESET;
      AdminMailQueueLogL.SETCURRENTKEY("Mail Code");
      AdminMailQueueLogL.SETRANGE("Mail Code",AdminMailQueueSetup."DocData Mail Code");
      IF AdminMailQueueLogL.FINDLAST THEN BEGIN
        IF (FORMAT(AdminMailQueueLogL."Processing Date/Time") = '') THEN
          SendDocDataMailL := FALSE
        ELSE
           IF ((TIME < DT2TIME(AdminMailQueueLogL."Processing Date/Time")) AND (TIME < 010000T)) OR
              (ROUND(ABS(TIME - DT2TIME(AdminMailQueueLogL."Processing Date/Time"))/1000/60,1) < 20) THEN
              SendDocDataMailL := FALSE;
      END;

      IF DDLogL.FINDLAST THEN BEGIN
        LastDocDataDateL := DDLogL.Timestamp;
      //H0286,H0329 30.04.13 PAU +++++++++++++++
        IF ((TIME < 070000T) AND (ROUND(ABS(CREATEDATETIME(WORKDATE,TIME) - LastDocDataDateL)/1000/60,1) < 150)) OR
           (ROUND(ABS(CREATEDATETIME(WORKDATE,TIME) - LastDocDataDateL)/1000/60,1) < 60) OR
           ((TIME > 180000T) AND (ROUND(ABS(CREATEDATETIME(WORKDATE,TIME) - LastDocDataDateL)/1000/60,1) < 90)) THEN
           SendDocDataMailL := FALSE;
        IF (TIME > 000000T) AND (TIME < 070000T) AND (ROUND(ABS(CREATEDATETIME(WORKDATE,TIME) - LastDocDataDateL)/1000/60,1) < 150) THEN
            SendDocDataMailL := FALSE;
      //H0286,H0329 30.04.13 PAU ---------------
        IF SendDocDataMailL = TRUE THEN BEGIN
          AdminMailQueueFunctions.InitMail(AdminMailQueueSetup."DocData Mail Code",TeamLeader);
          AdminMailQueueFunctions.AddSubject('DocData Interface does not work!');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('Last Post from %1',LastDocDataDateL));
          AdminMailQueueFunctions.AddText(STRSUBSTNO('Latest Message: %1',COPYSTR(DDLogL.Message,1,230)));
          AdminMailQueueFunctions.AddText(STRSUBSTNO('Idle since %1 Min.',
                                  ROUND(ABS(CREATEDATETIME(WORKDATE,TIME) - LastDocDataDateL)/1000/60,1)));

          AdminMailQueueFunctions.FinishMail;
        END;

      END;
      //H0669 04.11.13  FF --------------------------------------------------------
    END;

    PROCEDURE CheckFTP@1000000011();
    VAR
      SendFTPMailL@1000000000 : Boolean;
      AdminMailQueueLogL@1000000001 : Record 50093;
      FTPLogL@1000000003 : Record 50038;
      LastFTPTransferL@1000000002 : DateTime;
    BEGIN
      //Mail - Last FTP Transfer

      //H0669 04.11.13  FF ++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      AdminMailQueueSetup.GET;
      SendFTPMailL := TRUE;

      IF (CheckMailDowntime(AdminMailQueueSetup."FTP Mail Code") = TRUE) OR
         (CheckMailActive(AdminMailQueueSetup."FTP Mail Code") = FALSE) THEN
        SendFTPMailL := FALSE;
      AdminMailQueueLogL.RESET;
      AdminMailQueueLogL.SETCURRENTKEY("Mail Code");
      AdminMailQueueLogL.SETRANGE("Mail Code",AdminMailQueueSetup."FTP Mail Code");
      IF AdminMailQueueLogL.FINDLAST THEN BEGIN
        IF (FORMAT(AdminMailQueueLogL."Processing Date/Time") = '') THEN
          SendFTPMailL := FALSE
        ELSE
          IF ((TIME < DT2TIME(AdminMailQueueLogL."Processing Date/Time")) AND (TIME < 010000T)) OR
             (ROUND(ABS(TIME - DT2TIME(AdminMailQueueLogL."Processing Date/Time"))/1000/60,1) < 20) THEN
            SendFTPMailL := FALSE;
      END;

      FTPLogL.SETRANGE("Entry Type",FTPLogL."Entry Type"::Success);
      IF FTPLogL.FINDLAST THEN BEGIN
        LastFTPTransferL := FTPLogL.Timestamp;
        IF ((TIME < 060000T) AND (ROUND(ABS(CREATEDATETIME(WORKDATE,TIME) - LastFTPTransferL)/1000/60,1) < 150)) OR
           (ROUND(ABS(CREATEDATETIME(WORKDATE,TIME) - LastFTPTransferL)/1000/60,1) < 60) OR
           ((TIME > 180000T) AND (ROUND(ABS(CREATEDATETIME(WORKDATE,TIME) - LastFTPTransferL)/1000/60,1) < 90)) THEN
           SendFTPMailL := FALSE;

        IF SendFTPMailL = TRUE THEN BEGIN
          AdminMailQueueFunctions.InitMail(AdminMailQueueSetup."FTP Mail Code",TeamLeader);
          AdminMailQueueFunctions.AddSubject('FTP does not work!');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('Last Post from %1',LastFTPTransferL));
          AdminMailQueueFunctions.AddText(STRSUBSTNO('Idle since %1 Min.',
                                  ROUND(ABS(CREATEDATETIME(WORKDATE,TIME) - LastFTPTransferL)/1000/60,1)));

          AdminMailQueueFunctions.FinishMail;
        END;

      END;
      //H0669 04.11.13  FF --------------------------------------------------------
    END;

    PROCEDURE CheckRheDown@1000000012();
    VAR
      SendRheDownMailL@1000000000 : Boolean;
      AdminMailQueueLogL@1000000001 : Record 50093;
      FTPLogL@1000000005 : Record 50038;
      LastFTPTransferRHEDownL@1000000002 : DateTime;
    BEGIN
      //H0669 04.11.13  FF ++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      AdminMailQueueSetup.GET;
      SendRheDownMailL := TRUE;

      IF (CheckMailDowntime(AdminMailQueueSetup."Rhenus Down Mail Code") = TRUE) OR
         (CheckMailActive(AdminMailQueueSetup."Rhenus Down Mail Code") = FALSE) THEN
        SendRheDownMailL := FALSE;

      //Mail - Last Rhenus Down
      AdminMailQueueLogL.RESET;
      //A/gob-adb/18.04.13
      AdminMailQueueLogL.SETCURRENTKEY("Mail Code");
      //E/gob-adb/18.04.13
      //H0535 29.08.13  FF ++++++++++++++++++++++
      AdminMailQueueLogL.SETRANGE("Mail Code",AdminMailQueueSetup."Rhenus Down Mail Code");
      //H0535 29.08.13  FF ----------------------
      IF AdminMailQueueLogL.FINDLAST THEN BEGIN

        IF (FORMAT(AdminMailQueueLogL."Processing Date/Time") = '') THEN
          SendRheDownMailL := FALSE
        ELSE
           IF ((TIME < DT2TIME(AdminMailQueueLogL."Processing Date/Time")) AND (TIME < 010000T)) OR
              (ROUND(ABS(TIME - DT2TIME(AdminMailQueueLogL."Processing Date/Time"))/1000/60,1) < 20) THEN
            SendRheDownMailL := FALSE;
      END;

      FTPLogL.RESET;
      FTPLogL.SETRANGE("Entry Type",FTPLogL."Entry Type"::Success);
      FTPLogL.SETRANGE("Upload/Download",FTPLogL."Upload/Download"::Download);
      FTPLogL.SETRANGE("Interface Code",'RHENUS');

      IF FTPLogL.FINDLAST THEN BEGIN
        LastFTPTransferRHEDownL := FTPLogL.Timestamp;
        //H0286,H0329 30.04.13 PAU ++++++++++++++++++++++++++++++++++++++++++++++++
        IF ((TIME < 070000T) AND (ROUND(ABS(CREATEDATETIME(WORKDATE,TIME) - LastFTPTransferRHEDownL)/1000/60,1) < 150)) OR
           (ROUND(ABS(CREATEDATETIME(WORKDATE,TIME) - LastFTPTransferRHEDownL)/1000/60,1) < 60) OR
           ((TIME > 180000T) AND (ROUND(ABS(CREATEDATETIME(WORKDATE,TIME) - LastFTPTransferRHEDownL)/1000/60,1) < 90)) THEN
           SendRheDownMailL := FALSE;

          IF (TIME > 000000T) AND (TIME < 070000T) AND
            (ROUND(ABS(CREATEDATETIME(WORKDATE,TIME) - LastFTPTransferRHEDownL)/1000/60,1) < 150) THEN
              SendRheDownMailL := FALSE;
        //H0286,H0329 30.04.13 PAU ------------------------------------------------



        IF  SendRheDownMailL = TRUE THEN BEGIN

          //H0535 29.08.13  FF ++++++++++++++++++++++
          AdminMailQueueFunctions.InitMail(AdminMailQueueSetup."Rhenus Down Mail Code",TeamLeader);
          //H0535 29.08.13  FF ----------------------
          AdminMailQueueFunctions.AddSubject('Rhenus Download does not work!');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('Last Post from %1',LastFTPTransferRHEDownL));
          AdminMailQueueFunctions.AddText(STRSUBSTNO('Idle since %1 Min.',
                                  ROUND(ABS(CREATEDATETIME(WORKDATE,TIME) - LastFTPTransferRHEDownL)/1000/60,1)));

          AdminMailQueueFunctions.FinishMail;
        END;

      END;

      //H0669 04.11.13  FF --------------------------------------------------------
    END;

    PROCEDURE CheckDDDown@1000000013();
    VAR
      SendDDDownMailL@1000000000 : Boolean;
      AdminMailQueueLogL@1000000001 : Record 50093;
      FTPLogL@1000000002 : Record 50038;
      LastFTPTransferDDDownL@1000000003 : DateTime;
    BEGIN
      //H0669 04.11.13  FF ++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      AdminMailQueueSetup.GET;
      SendDDDownMailL := TRUE;

      IF (CheckMailDowntime(AdminMailQueueSetup."DocData Down Mail Code") = TRUE) OR
         (CheckMailActive(AdminMailQueueSetup."DocData Down Mail Code") = FALSE) THEN
        SendDDDownMailL := FALSE;

      //Mail - Last DocData Down
      AdminMailQueueLogL.RESET;
      //A/gob-adb/18.04.13
      AdminMailQueueLogL.SETCURRENTKEY("Mail Code");
      //E/gob-adb/18.04.13
      //H0535 29.08.13  FF ++++++++++++++++++++++
      AdminMailQueueLogL.SETRANGE("Mail Code",AdminMailQueueSetup."DocData Down Mail Code");
      //H0535 29.08.13  FF ----------------------
      IF AdminMailQueueLogL.FINDLAST THEN BEGIN

        IF (FORMAT(AdminMailQueueLogL."Processing Date/Time") = '') THEN
          SendDDDownMailL := FALSE
        ELSE
          IF ((TIME < DT2TIME(AdminMailQueueLogL."Processing Date/Time")) AND (TIME < 010000T)) OR
           (ROUND(ABS(TIME - DT2TIME(AdminMailQueueLogL."Processing Date/Time"))/1000/60,1) < 20) THEN
            SendDDDownMailL := FALSE;
      END;

      FTPLogL.SETRANGE("Entry Type",FTPLogL."Entry Type"::Success);
      FTPLogL.SETRANGE("Upload/Download",FTPLogL."Upload/Download"::Download);
      FTPLogL.SETRANGE("Interface Code",'DOCDATA');

      IF FTPLogL.FINDLAST THEN BEGIN
        LastFTPTransferDDDownL := FTPLogL.Timestamp;

      //H0286,H0329 30.04.13 PAU ++++++++++++++++++++++++++++++++++++++++++++++++
        IF ((TIME < 070000T) AND (ROUND(ABS(CREATEDATETIME(WORKDATE,TIME) - LastFTPTransferDDDownL)/1000/60,1) < 150)) OR
           (ROUND(ABS(CREATEDATETIME(WORKDATE,TIME) - LastFTPTransferDDDownL)/1000/60,1) < 60) OR
           ((TIME > 180000T) AND (ROUND(ABS(CREATEDATETIME(WORKDATE,TIME) - LastFTPTransferDDDownL)/1000/60,1) < 90)) THEN
           SendDDDownMailL := FALSE;

        IF (TIME > 000000T) AND (TIME < 070000T) AND (ROUND(ABS(CREATEDATETIME(WORKDATE,TIME) - LastFTPTransferDDDownL)/1000/60,1) < 150
      )
          THEN
            SendDDDownMailL := FALSE;
      //H0286,H0329 30.04.13 PAU ------------------------------------------------

        IF SendDDDownMailL = TRUE THEN BEGIN
          //H0535 29.08.13  FF ++++++++++++++++++++++
          AdminMailQueueFunctions.InitMail(AdminMailQueueSetup."DocData Down Mail Code",TeamLeader);

          //H0535 29.08.13  FF ----------------------
          AdminMailQueueFunctions.AddSubject('DocData Download does not work!');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('Last Post from %1',LastFTPTransferDDDownL));
          AdminMailQueueFunctions.AddText(STRSUBSTNO('Idle since %1 Min.',
                                  ROUND(ABS(CREATEDATETIME(WORKDATE,TIME) - LastFTPTransferDDDownL)/1000/60,1)));
          AdminMailQueueFunctions.FinishMail;
        END;

      END;
      //H0669 04.11.13  FF --------------------------------------------------------
    END;

    PROCEDURE CheckPPLDown@1000000014();
    VAR
      SendPPLDownMailL@1000000000 : Boolean;
      AdminMailQueueLogL@1000000001 : Record 50093;
      FTPLogL@1000000002 : Record 50038;
      LastFTPTransferPPL@1000000003 : DateTime;
    BEGIN
      //H0669 04.11.13  FF ++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      AdminMailQueueSetup.GET;
      SendPPLDownMailL := TRUE;

      IF (CheckMailDowntime(AdminMailQueueSetup."Paypal Down Mail Code") = TRUE) OR
         (CheckMailActive(AdminMailQueueSetup."Paypal Down Mail Code") = FALSE) THEN
        SendPPLDownMailL := FALSE;

      //Mail - Last Paypal Down
      AdminMailQueueLogL.RESET;
      //A/gob-adb/18.04.13
      AdminMailQueueLogL.SETCURRENTKEY("Mail Code");
      //E/gob-adb/18.04.13
      //H0535 29.08.13  FF ++++++++++++++++++++++
      AdminMailQueueLogL.SETRANGE("Mail Code",AdminMailQueueSetup."Paypal Down Mail Code");

      //H0535 29.08.13  FF ----------------------

      IF AdminMailQueueLogL.FINDLAST THEN BEGIN
        IF (FORMAT(AdminMailQueueLogL."Processing Date/Time") = '') THEN
           SendPPLDownMailL := FALSE
        ELSE
          IF ((TIME < DT2TIME(AdminMailQueueLogL."Processing Date/Time")) AND (TIME < 010000T)) OR
             (ROUND(ABS(TIME - DT2TIME(AdminMailQueueLogL."Processing Date/Time"))/1000/60,1) < 20) THEN
            SendPPLDownMailL := FALSE;
      END;

      FTPLogL.SETRANGE("Entry Type",FTPLogL."Entry Type"::Success);
      FTPLogL.SETRANGE("Upload/Download",FTPLogL."Upload/Download"::Download);
      FTPLogL.SETRANGE("Interface Code",'PAYPAL');

      IF FTPLogL.FINDLAST THEN BEGIN
        LastFTPTransferPPL := FTPLogL.Timestamp;


        IF ((TIME < 060000T) AND (ROUND(ABS(CREATEDATETIME(WORKDATE,TIME) - LastFTPTransferPPL)/1000/60,1) < 150)) OR
           (ROUND(ABS(CREATEDATETIME(WORKDATE,TIME) - LastFTPTransferPPL)/1000/60,1) < 60) OR
           (ROUND(ABS(CREATEDATETIME(WORKDATE,TIME) - LastFTPTransferPPL)/1000/60,1) < 90) THEN
           SendPPLDownMailL := FALSE;

        IF SendPPLDownMailL = TRUE THEN BEGIN
          //H0535 29.08.13  FF ++++++++++++++++++++++
          AdminMailQueueFunctions.InitMail(AdminMailQueueSetup."Paypal Down Mail Code",TeamLeader);

          //H0535 29.08.13  FF ----------------------
          AdminMailQueueFunctions.AddSubject('Paypal Download does not work!');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('Last Post from %1',LastFTPTransferPPL));
          AdminMailQueueFunctions.AddText(STRSUBSTNO('Idle since %1 Min.',
                                  ROUND(ABS(CREATEDATETIME(WORKDATE,TIME) - LastFTPTransferPPL)/1000/60,1)));

          AdminMailQueueFunctions.FinishMail;
        END;

      END;

      //H0669 04.11.13  FF --------------------------------------------------------
    END;

    PROCEDURE CheckRheUp@1000000015();
    VAR
      SendRheUpMailL@1000000000 : Boolean;
      AdminMailQueueLogL@1000000001 : Record 50093;
      FTPLogL@1000000002 : Record 50038;
      LastFTPTransferRHEUpL@1000000003 : DateTime;
    BEGIN
      //H0669 04.11.13  FF ++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      AdminMailQueueSetup.GET;
      SendRheUpMailL := TRUE;

      IF (CheckMailDowntime(AdminMailQueueSetup."Rhenus Up Mail Code") = TRUE) OR
         (CheckMailActive(AdminMailQueueSetup."Rhenus Up Mail Code") = FALSE) THEN
        SendRheUpMailL := FALSE;

      //Mail - Last Rhenus Up
      AdminMailQueueLogL.RESET;
      //A/gob-adb/18.04.13
      AdminMailQueueLogL.SETCURRENTKEY("Mail Code");
      //E/gob-adb/18.04.13
      //H0535 29.08.13  FF ++++++++++++++++++++++
      AdminMailQueueLogL.SETRANGE("Mail Code",AdminMailQueueSetup."Rhenus Up Mail Code");
      //H0535 29.08.13  FF ----------------------
      IF AdminMailQueueLogL.FINDLAST THEN BEGIN
        IF (FORMAT(AdminMailQueueLogL."Processing Date/Time") = '') THEN
          SendRheUpMailL := FALSE
        ELSE
          IF ((TIME < DT2TIME(AdminMailQueueLogL."Processing Date/Time")) AND (TIME < 010000T)) OR
             (ROUND(ABS(TIME - DT2TIME(AdminMailQueueLogL."Processing Date/Time"))/1000/60,1) < 20) THEN
            SendRheUpMailL := FALSE;
      END;

      FTPLogL.SETRANGE("Entry Type",FTPLogL."Entry Type"::Success);
      FTPLogL.SETRANGE("Upload/Download",FTPLogL."Upload/Download"::Upload);
      FTPLogL.SETRANGE("Interface Code",'RHENUS');

      IF FTPLogL.FINDLAST THEN BEGIN
        LastFTPTransferRHEUpL := FTPLogL.Timestamp;
        //H0286,H0329 30.04.13 PAU ++++++++++++++++++++++++++++++++++++++++++++++++
        IF ((TIME < 070000T) AND (ROUND(ABS(CREATEDATETIME(WORKDATE,TIME) - LastFTPTransferRHEUpL)/1000/60,1) < 150)) OR
           (ROUND(ABS(CREATEDATETIME(WORKDATE,TIME) - LastFTPTransferRHEUpL)/1000/60,1) < 60) OR
           ((TIME > 180000T) AND (ROUND(ABS(CREATEDATETIME(WORKDATE,TIME) - LastFTPTransferRHEUpL)/1000/60,1) < 90)) THEN
          SendRheUpMailL := FALSE;

        IF (TIME > 000000T) AND (TIME < 070000T) AND (ROUND(ABS(CREATEDATETIME(WORKDATE,TIME) - LastFTPTransferRHEUpL)/1000/60,1) < 150)
          THEN
            SendRheUpMailL := FALSE;
      //H0286,H0329 30.04.13 PAU ------------------------------------------------


        IF SendRheUpMailL = TRUE THEN BEGIN
          //H0535 29.08.13  FF ++++++++++++++++++++++
          AdminMailQueueFunctions.InitMail(AdminMailQueueSetup."Rhenus Up Mail Code",TeamLeader);
          //H0535 29.08.13  FF ----------------------
          AdminMailQueueFunctions.AddSubject('Rhenus Upload does not work!');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('Last Post from %1',LastFTPTransferRHEUpL));
          AdminMailQueueFunctions.AddText(STRSUBSTNO('Idle since %1 Min.',
                                  ROUND(ABS(CREATEDATETIME(WORKDATE,TIME) - LastFTPTransferRHEUpL)/1000/60,1)));

          AdminMailQueueFunctions.FinishMail;
        END;

      END;


      //H0669 04.11.13  FF --------------------------------------------------------
    END;

    PROCEDURE CheckDDUp@1000000016();
    VAR
      FTPLogL@1000000002 : Record 50038;
      SendDDUpMailL@1000000000 : Boolean;
      AdminMailQueueLogL@1000000001 : Record 50093;
      LastFTPTransferDDUpL@1000000003 : DateTime;
    BEGIN
      //H0669 04.11.13  FF ++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      AdminMailQueueSetup.GET;
      SendDDUpMailL := TRUE;

      IF (CheckMailDowntime(AdminMailQueueSetup."DocData Up Mail Code") = TRUE) OR
         (CheckMailActive(AdminMailQueueSetup."DocData Up Mail Code") = FALSE) THEN
        SendDDUpMailL := FALSE;

      //Mail - Last DocData Up
      AdminMailQueueLogL.RESET;
      AdminMailQueueLogL.SETCURRENTKEY("Mail Code");
      AdminMailQueueLogL.SETRANGE("Mail Code",AdminMailQueueSetup."DocData Up Mail Code");
      IF AdminMailQueueLogL.FINDLAST THEN BEGIN
        IF (FORMAT(AdminMailQueueLogL."Processing Date/Time") = '') THEN
          SendDDUpMailL := FALSE
        ELSE
          IF ((TIME < DT2TIME(AdminMailQueueLogL."Processing Date/Time")) AND (TIME < 010000T)) OR
             (ROUND(ABS(TIME - DT2TIME(AdminMailQueueLogL."Processing Date/Time"))/1000/60,1) < 20) THEN
            SendDDUpMailL := FALSE;
      END;

      FTPLogL.SETRANGE("Entry Type",FTPLogL."Entry Type"::Success);
      FTPLogL.SETRANGE("Upload/Download",FTPLogL."Upload/Download"::Upload);
      FTPLogL.SETRANGE("Interface Code",'DOCDATA');

      IF FTPLogL.FINDLAST THEN BEGIN
        LastFTPTransferDDUpL := FTPLogL.Timestamp;
        IF ((TIME < 070000T) AND (ROUND(ABS(CREATEDATETIME(WORKDATE,TIME) - LastFTPTransferDDUpL)/1000/60,1) < 150)) OR
           (ROUND(ABS(CREATEDATETIME(WORKDATE,TIME) - LastFTPTransferDDUpL)/1000/60,1) < 60) OR
           ((TIME > 180000T) AND (ROUND(ABS(CREATEDATETIME(WORKDATE,TIME) - LastFTPTransferDDUpL)/1000/60,1) < 90)) THEN
          SendDDUpMailL := FALSE;

        IF (TIME > 000000T) AND (TIME < 070000T) AND (ROUND(ABS(CREATEDATETIME(WORKDATE,TIME) - LastFTPTransferDDUpL)/1000/60,1) < 150)
          THEN
            SendDDUpMailL := FALSE;

        IF SendDDUpMailL = TRUE THEN BEGIN
      //H1322 02.07.14  FF ++++++++++++++++++++++++++++++++++++++++++++++++++++++++
          //AdminMailQueueFunctions.InitMail(STRSUBSTNO('%1DDUP',AdminMailQueueSetup."DocData Up Mail Code"),TeamLeader);
          AdminMailQueueFunctions.InitMail(AdminMailQueueSetup."DocData Up Mail Code",TeamLeader);
      //H1322 02.07.14  FF --------------------------------------------------------
          AdminMailQueueFunctions.AddSubject('DocData Upload does not work!');
          AdminMailQueueFunctions.AddText(STRSUBSTNO('Last Post from %1',LastFTPTransferDDUpL));
          AdminMailQueueFunctions.AddText(STRSUBSTNO('Idle since %1 Min.',
                                  ROUND(ABS(CREATEDATETIME(WORKDATE,TIME) - LastFTPTransferDDUpL)/1000/60,1)));

          AdminMailQueueFunctions.FinishMail;
        END;
      END;
      //H0669 04.11.13  FF --------------------------------------------------------
    END;

    PROCEDURE CheckRheWhs@1000000022();
    VAR
      SendRHEWHSMail@1000000000 : Boolean;
      AdminMailQueueLogL@1000000001 : Record 50093;
      DHLParcelStatusHistoryL@1000000002 : Record 50021;
      ParcelStatusHistory@1000000003 : Record 80013;
      ParcelStatusHistoryArchive@1000000004 : Record 50187;
    BEGIN
      //S/P1133
      FPCGeneralSetup.GET;
      //E/P1133

      //H0669 04.11.13  FF ++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      AdminMailQueueSetup.GET;
      SendRHEWHSMail := TRUE;

      IF (CheckMailDowntime(AdminMailQueueSetup."Rhenus Whs. Mail Code") = TRUE) OR
         (CheckMailActive(AdminMailQueueSetup."Rhenus Whs. Mail Code") = FALSE) THEN
        SendRHEWHSMail := FALSE;

      AdminMailQueueLogL.RESET;
      AdminMailQueueLogL.SETCURRENTKEY("Mail Code");
      AdminMailQueueLogL.SETRANGE("Mail Code",AdminMailQueueSetup."Rhenus Whs. Mail Code");
      IF AdminMailQueueLogL.FINDLAST THEN BEGIN
        IF (FORMAT(AdminMailQueueLogL."Processing Date/Time") = '') THEN
          SendRHEWHSMail := FALSE
        ELSE
           IF ((TIME < DT2TIME(AdminMailQueueLogL."Processing Date/Time")) AND (TIME < 010000T)) OR
              (ROUND(ABS(TIME - DT2TIME(AdminMailQueueLogL."Processing Date/Time"))/1000/60,1) < 20) THEN
              SendRHEWHSMail := FALSE;
      END;

      IF SendRHEWHSMail THEN BEGIN
        //S/P1133
        CASE FPCGeneralSetup."Active Parcel Status History" OF
          FPCGeneralSetup."Active Parcel Status History"::"Use Only Old DHL Parcel Status History",
          FPCGeneralSetup."Active Parcel Status History"::"Fill Both But Show And Use Old":
            BEGIN
        //E/P1133
              DHLParcelStatusHistoryL.RESET;
              DHLParcelStatusHistoryL.SETRANGE("Status Code",'0');
              DHLParcelStatusHistoryL.SETRANGE("Rhenus Entry",TRUE);
              IF DHLParcelStatusHistoryL.FINDLAST THEN BEGIN
                IF (ROUND(ABS(CURRENTDATETIME - DHLParcelStatusHistoryL."Time Stamp")/1000/60,1) <
                   AdminMailQueueSetup."Rhenus Status 0 Limit (min)") THEN
                  SendRHEWHSMail := FALSE;

                IF SendRHEWHSMail THEN BEGIN
                  AdminMailQueueFunctions.InitMail(AdminMailQueueSetup."Rhenus Whs. Mail Code",TeamLeader);

                  AdminMailQueueFunctions.AddSubject('Rhenus sends no Order Confirmation!');
                  AdminMailQueueFunctions.AddText(STRSUBSTNO('Last Response at %1',DHLParcelStatusHistoryL."Time Stamp"));
                  AdminMailQueueFunctions.AddText(STRSUBSTNO('Idle since %1 Min.',
                                          ROUND(ABS(CREATEDATETIME(WORKDATE,TIME) - DHLParcelStatusHistoryL."Time Stamp")/1000/60,1)));
                  AdminMailQueueFunctions.FinishMail;
                END;
             END;
        //S/P1133
            END;
          FPCGeneralSetup."Active Parcel Status History"::"Fill Both But Show And Use New",
          FPCGeneralSetup."Active Parcel Status History"::"Use Only New Parcel Status History":
            BEGIN
              ParcelStatusHistory.RESET;
              //T0002 28.05.14 tec-cs +++++++++++++++++++++++++++++
              //ParcelStatusHistory.SETCURRENTKEY("Used Interface");
              //T0002 28.05.14 tec-cs -----------------------------
              ParcelStatusHistory.SETRANGE("Used Interface",ParcelStatusHistory."Used Interface"::Rhenus);
              ParcelStatusHistory.SETRANGE("Status Sub Code",'0');
              IF ParcelStatusHistory.FINDLAST THEN BEGIN
                IF (ROUND(ABS(CURRENTDATETIME - ParcelStatusHistory."Timestamp Insert")/1000/60,1) <
                   AdminMailQueueSetup."Rhenus Status 0 Limit (min)") THEN
                  SendRHEWHSMail := FALSE;

                IF SendRHEWHSMail THEN BEGIN
                  AdminMailQueueFunctions.InitMail(AdminMailQueueSetup."Rhenus Whs. Mail Code",TeamLeader);

                  AdminMailQueueFunctions.AddSubject('Rhenus sends no Order Confirmation!');
                  AdminMailQueueFunctions.AddText(STRSUBSTNO('Last Response at %1',ParcelStatusHistory."Timestamp Insert"));
                  AdminMailQueueFunctions.AddText(STRSUBSTNO('Idle since %1 Min.',
                                          ROUND(ABS(CREATEDATETIME(WORKDATE,TIME) - ParcelStatusHistory."Timestamp Insert")/1000/60,1)))
      ;
                  AdminMailQueueFunctions.FinishMail;
                END;
             END;
            END;
        END;
        //E/P1133
      END;

      //H0669 04.11.13  FF --------------------------------------------------------
    END;

    PROCEDURE CheckDDWhs@1000000023();
    VAR
      SendDDWHSMail@1000000000 : Boolean;
      AdminMailQueueLogL@1000000001 : Record 50093;
      DHLParcelStatusHistoryL@1000000002 : Record 50021;
      ParcelStatusHistory@1000000003 : Record 80013;
    BEGIN
      //S/P1133
      FPCGeneralSetup.GET;
      //E/P1133

      //H0669 04.11.13  FF ++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      AdminMailQueueSetup.GET;
      SendDDWHSMail := TRUE;
      IF (CheckMailDowntime(AdminMailQueueSetup."DocData Whs. Mail Code") = TRUE) OR
         (CheckMailActive(AdminMailQueueSetup."DocData Whs. Mail Code") = FALSE) THEN
        SendDDWHSMail := FALSE;


      AdminMailQueueLogL.RESET;
      AdminMailQueueLogL.SETCURRENTKEY("Mail Code");
      AdminMailQueueLogL.SETRANGE("Mail Code",AdminMailQueueSetup."DocData Whs. Mail Code");
      IF AdminMailQueueLogL.FINDLAST THEN BEGIN
        IF (FORMAT(AdminMailQueueLogL."Processing Date/Time") = '') THEN
          SendDDWHSMail := FALSE
        ELSE
           IF ((TIME < DT2TIME(AdminMailQueueLogL."Processing Date/Time")) AND (TIME < 010000T)) OR
              (ROUND(ABS(TIME - DT2TIME(AdminMailQueueLogL."Processing Date/Time"))/1000/60,1) < 20) THEN
              SendDDWHSMail := FALSE;
      END;

      IF SendDDWHSMail THEN BEGIN
        //S/P1133
        CASE FPCGeneralSetup."Active Parcel Status History" OF
          FPCGeneralSetup."Active Parcel Status History"::"Use Only Old DHL Parcel Status History",
          FPCGeneralSetup."Active Parcel Status History"::"Fill Both But Show And Use Old":
            BEGIN
        //E/P1133
              DHLParcelStatusHistoryL.RESET;
              DHLParcelStatusHistoryL.SETRANGE("Docdate Status Code",'15');
              DHLParcelStatusHistoryL.SETRANGE("Status Docdata",TRUE);
              IF DHLParcelStatusHistoryL.FINDLAST THEN BEGIN
                IF (ROUND(ABS(CURRENTDATETIME - DHLParcelStatusHistoryL."Time Stamp")/1000/60,1) <
                   AdminMailQueueSetup."Rhenus Status 0 Limit (min)") THEN
                  SendDDWHSMail := FALSE;

                IF SendDDWHSMail THEN BEGIN
                  AdminMailQueueFunctions.InitMail(AdminMailQueueSetup."DocData Whs. Mail Code",TeamLeader);
                  AdminMailQueueFunctions.AddSubject('DocData sends no Order Confirmation!');
                  AdminMailQueueFunctions.AddText(STRSUBSTNO('Last Response at %1',DHLParcelStatusHistoryL."Time Stamp"));
                  AdminMailQueueFunctions.AddText(STRSUBSTNO('Idle since %1 Min.',
                                          ROUND(ABS(CREATEDATETIME(WORKDATE,TIME) - DHLParcelStatusHistoryL."Time Stamp")/1000/60,1)));
                  AdminMailQueueFunctions.FinishMail;
                END;
              END;
        //S/P1133
            END;
          FPCGeneralSetup."Active Parcel Status History"::"Fill Both But Show And Use New",
          FPCGeneralSetup."Active Parcel Status History"::"Use Only New Parcel Status History":
            BEGIN
              ParcelStatusHistory.RESET;
              //T0002 28.05.14 tec-cs +++++++++++++++++++++++++++++
              //ParcelStatusHistory.SETCURRENTKEY("Used Interface");
              //T0002 28.05.14 tec-cs -----------------------------
              ParcelStatusHistory.SETRANGE("Used Interface",ParcelStatusHistory."Used Interface"::DocData);
              ParcelStatusHistory.SETRANGE("Status Code",'15');
              IF ParcelStatusHistory.FINDLAST THEN BEGIN
                IF (ROUND(ABS(CURRENTDATETIME - ParcelStatusHistory."Timestamp Insert")/1000/60,1) <
                   AdminMailQueueSetup."Rhenus Status 0 Limit (min)") THEN
                  SendDDWHSMail := FALSE;

                IF SendDDWHSMail THEN BEGIN
                  AdminMailQueueFunctions.InitMail(AdminMailQueueSetup."DocData Whs. Mail Code",TeamLeader);
                  AdminMailQueueFunctions.AddSubject('DocData sends no Order Confirmation!');
                  AdminMailQueueFunctions.AddText(STRSUBSTNO('Last Response at %1',ParcelStatusHistory."Timestamp Insert"));
                  AdminMailQueueFunctions.AddText(STRSUBSTNO('Idle since %1 Min.',
                                          ROUND(ABS(CREATEDATETIME(WORKDATE,TIME) - ParcelStatusHistory."Timestamp Insert")/1000/60,1)))
      ;
                  AdminMailQueueFunctions.FinishMail;
                END;
              END;
            END;
        END;
        //E/P1133
      END;
      //H0669 04.11.13  FF --------------------------------------------------------
    END;

    PROCEDURE SendEDIMail@1000000018(UserIDV@1000000001 : Code[20];OutboundEDIErrorV@1000000002 : Code[20];PurchaseOrderNoV@1000000000 : Code[20]);
    VAR
      AdminMailQueueSetupL@1000000003 : Record 50092;
    BEGIN
      //H1321  05.08.14 FF  +++++++++++++++++++++++++++++++++++++++++++++++
      AdminMailQueueSetupL.GET;
      IF CheckMailDowntime(AdminMailQueueSetupL."EDI Mail Code") = TRUE THEN
        EXIT;

      AdminMailQueueFunctions.InitMail(AdminMailQueueSetupL."EDI Mail Code",TeamLeader);
      AdminMailQueueFunctions.AddSubject('EDI Sending Error has been removed');
      AdminMailQueueFunctions.AddText('The user ' + UserIDV + ' has removed the ' + OutboundEDIErrorV
                              +' for the field Outbound EDI No. in Purchase Order ' + PurchaseOrderNoV);
      AdminMailQueueFunctions.FinishMail;
      //H1321  05.08.14 FF  -----------------------------------------------
    END;

    PROCEDURE CheckDHLTrackNos@1000000019();
    VAR
      SendDHLTrackNosMailL@1000000000 : Boolean;
      AdminMailQueueLogL@1000000001 : Record 50093;
      AdminMailDefaultRecipientsL@1000000003 : Record 50081;
      DHLSetupL@1000000002 : Record 50022;
      NecessaryLengthL@1000000004 : Integer;
      MaxTrackingNoL@1000000005 : Integer;
    BEGIN
      //H2101 24.03.15 MSL ++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      AdminMailQueueSetup.GET;
      SendDHLTrackNosMailL := TRUE;

      IF (CheckMailDowntime(AdminMailQueueSetup."DHL Tracking Nos. Mail Code") = TRUE) OR
         (CheckMailActive(AdminMailQueueSetup."DHL Tracking Nos. Mail Code") = FALSE) THEN
        SendDHLTrackNosMailL := FALSE;

      //Logistic
      AdminMailQueueLogL.RESET;
      AdminMailQueueLogL.SETCURRENTKEY("Mail Code");
      AdminMailQueueLogL.SETRANGE("Mail Code",AdminMailQueueSetup."DHL Tracking Nos. Mail Code");

      IF AdminMailQueueLogL.FINDLAST THEN BEGIN
        IF (FORMAT(AdminMailQueueLogL."Processing Date/Time") = '') THEN
          SendDHLTrackNosMailL := FALSE
        ELSE
          IF (DT2DATE(AdminMailQueueLogL."Processing Date/Time")= WORKDATE) THEN
            SendDHLTrackNosMailL := FALSE;
      END;

      DHLSetupL.GET;
      NecessaryLengthL := STRLEN(DHLSetupL."Home24 DHL Client ID");
      EVALUATE(MaxTrackingNoL,COPYSTR('99999999',1,(11 - NecessaryLengthL)));
      IF ((MaxTrackingNoL - DHLSetupL."DHL Packet Count Shipment") > DHLSetupL."DHL Track. Nos. Warning Limit") THEN
        SendDHLTrackNosMailL := FALSE;

      IF SendDHLTrackNosMailL = TRUE THEN BEGIN
        AdminMailQueueFunctions.InitMail(AdminMailQueueSetup."DHL Tracking Nos. Mail Code",TeamLeader);
        AdminMailQueueFunctions.AddSubject('Running out of DHL Tracking Numbers!');
        AdminMailQueueFunctions.AddText(STRSUBSTNO('Home24 DHL Client ID: %1;  ',DHLSetupL."Home24 DHL Client ID"));

        AdminMailQueueFunctions.AddText(
          STRSUBSTNO('DHL Tracking Numbers left: %1 ',
          NecessaryLengthL - DHLSetupL."DHL Packet Count Shipment"));

        //AddRecipients/RecipientsCC
        AdminMailDefaultRecipientsL.RESET;
        AdminMailDefaultRecipientsL.SETRANGE(
          AdminMailDefaultRecipientsL."Mail Code",
          AdminMailQueueSetup."DHL Tracking Nos. Mail Code");
        AdminMailDefaultRecipientsL.SETRANGE("Adress Active",TRUE);
        IF AdminMailDefaultRecipientsL.FINDSET THEN BEGIN
          REPEAT
            IF NOT (AdminMailQueueFunctions.AddRecipient(AdminMailDefaultRecipientsL."E-Mail Adress")) THEN
               AdminMailQueueFunctions.AddRecipientCC(AdminMailDefaultRecipientsL."E-Mail Adress");
          UNTIL AdminMailDefaultRecipientsL.NEXT = 0;
        END;
        AdminMailQueueFunctions.FinishMail;
      END;
      //H2101 25.03.15 MSL --------------------------------------------------------
    END;

    BEGIN
    {
      +--------------------------------------------+
      |                                            |
      |                  Home24                    |
      |     Cooperation GOB & Home24 NAV Team      |
      |                                            |
      +--------------------------------------------+

      Project No. Date      Shortcut  Description
      _____________________________________________
      P1133       05.11.13  gob-mlan  - Redesign of "DHL Parcel Status History"

      +--------------------------------------------+
      |                                            |
      |                  Home24                    |
      |     Cooperation Tectura & Home24 NAV Team  |
      |                                            |
      +--------------------------------------------+

      Project No. Date      Shortcut  Description
      _____________________________________________

      T0002       28.05.14  tec-cs    remove obsolete setcurrentkey-calls (keys in table 80013 have been deleted)

      +--------------------------------------------+
      |                                            |
      |                  Home24                    |
      |       Internal Customizing by NAV-Team     |
      |                                            |
      +--------------------------------------------+

      Project No. Date     Shortcut  Description
      _____________________________________________

      *** Module: Monitoring - Mail ***
      FPC002      07.09.12 ABR       Created
      FPC005      11.09.12 ABR       Changed Loop
      H0009       27.09.12 ABR       Send Alive Mail & Nav Connector Change
      H0011       27.09.12 ABR       Send Finance Statistic Mail
      H0012       28.09.12 ABR       Send Monitoring Mail every 20 Min.
      H0031       15.10.12 ABR       Send ERP Statistic Mail
      H0045       22.10.12 ABR       Send differend ERP Statistic Mails
      H0054       24.10.12 ABR       Reduce Text length
      H0057       25.10.12 ABR       Check Logistic
      H0059       26.10.12 ABR       Finance Stat. redesigned
      H0060       26.10.12 ABR       Default Mail Recipients
      H0061       26.10.12 ABR       Detailed ERP Mail
      H0062       29.10.12 ABR       Added some Information to ERP Mail
      H0070       30.10.12 ABR       Print Deployments
      H0072       05.11.12 ABR       Design Changes
      H0078       07.11.12 ABR       Remove Double Entries in ERP Stat
      H0089       19.11.12 FF        CheckFinanceStat: Changed "Check Hour Today/Last Week" Range to eBayNavCWebshopSalesHeaderList
      H0098       22.11.12 ABR       Added FTP Tranfer & Object Change
      H0101       26.11.12 ABR       Show Job Queue Entry Status
      H0089       29.11.12 FF        CheckFinanceStat: Changed EndFullHour Calculation for hour 00:00:00
      H0089       03.12.12 FF        CheckFinanceStat: Adjust Date for hour 00:00:00
      H0089       10.12.12 FF        CheckFinanceStat: Adjust Date for hour 00:00:00 also for Day Calculation
      H0089       17.12.12 FF        CheckFinanceStat: Day Calculation now based on eBayNavCWebshopSalesHeaderList
      H0123       17.12.12 FF        CheckERPStat: New MailTypes "Early Morning" & "Late Evening",SHIPPINGINFO & other mail changes
      H0131       20.12.12 FF        CheckFinanceStat: Day Calculation corrected
      H0137       08.01.12 FF        CheckERPStat: Print Shipping - not send red if 0
      H0145       10.01.12 FF        CheckERPStat: Print all channels and time correction for MailType::yesterday
      H0149       10.01.12 FF        CheckFinanceStat: Austria added
      H0159       17.01.12 FF        CheckERPStat: SHIPPINGINFORMATION - Print red if 0
                                     CheckMonitoring: added 8 FTP Mails
      H0162       24.01.12 FF        ERPStat: Print No. of Orders per Country
      H0175       24.01.12 FF        ERPStat: Print total unprocessed manual Orders
                                     CheckMonitoring: Mail Sending Logic changed (MailTypes etc.)
      H0183       31.01.01 FF        CheckERPStat: Orders by Country DateTime Filter changed
      H0189       07.02.13 FF        CheckERPStat: Texts added and CrossDoc Texts deactivated, Job Queue: Process List changed
                                     CheckMonitoring: Deactivated CrossDoc Mails
      H0193       11.02.13 FF        CheckERPStat: EDI Orders Inbound/Outbound andrucken
      H0225       26.02.13 FF        CheckERPStat: EDI Orders moved & Job Queue Entries In Process corrected
      H0242       11.03.13 FF        CheckMonitoring changed
      H0236       06.03.13 PAU       Monitoring count Files on LocalHard Drive and FTP Server
      H0253       15.03.13 PAU       Correction e-mail
      H0259       15.03.13 PAU       Correction e-mail
      H0261       19.03.13 PAU       Correction Count Files
      H0265       26.03.13 FX        Improvements in Fuchs-report
      H0286       04.04.13 PAU       Rehnus and DD mail send only when time > 150 min in 0-7 night
      P0890       18.04.13 gob-adb   SETCURRENTKEY added
      H0329       30.04.13 PAU       Warning mails NAV Connector
      H0357       23.05.13 FF        Job Queue (In Process) red, when > 2
      H0404       14.06.13 ABR       New Error Mails for Whs Response Rhenus Status 0 & DocData Status 15
      H0420       04.07.13 FF        New Mail: OM - Modifications (CheckMonitoring)
      H0450       08.07.13 FF        New Mail: Change Log Mail (CheckMonitoring)
      H0473       30.07.13 FF        Check downtimes for mails
      H0473       06.08.13 FF        New function CheckMailDowntime
      H0497       08.08.13 FF        New function OM Modification Mail corrected
      H0529       22.08.13 FF        Changes to Change Log Mail
      H0535       29.08.13 FF        CheckMonitoring: Mail Codes in T "Admin Mail Codes" + Downtime & Active Check
                                     New Function: CheckMailActive
      H0536       29.08.13 FF        CheckERPStat: New Mail Types "Monthly" & "Weekly"
      H0529       30.08.13 FF        Layout of Change Log Mail changed
      H0536       30.08.13 FF        ERP Stat Layout corrected
      H0529       03.09.13 FF        Change Log Mail Layout
      H0554       10.09.13 FF        Changed Time in in Modification Mail
      H0555       10.09.13 FF        New Mail: CheckActionWorksheetMail
      H0606       10.10.13 FF        CheckERPStat: Correction for Monthly & Weekly +Mail
      H0606       10.10.13 FF        Change Log Mail: Changed by User ID
      h0610       11.10.13 FF        Change log Mail: Print differently when Table 472 or 2000000054
      H0633       23.10.13 FF        Change log Mail: Layout changed & moved to function "CheckChangeLog"
                                     COMMIT after each Mail
      H0669       04.11.13 FF        Monitoring mails moved to a seperate functions
      H0901       27.02.14 FF        Added "Switzerland" to Finance Stat and ERP Stat Mail
      H1044       18.06.14 FF        Change Log Mail - Send mail per table - Added "CreateChangeLogMail" and changed "CheckChangeLog"
      H1044       25.06.14 FF        CreateChangeLogMail() - FINDSET instead of NOT ISEMPTY
      H1043       25.06.14 FF        ERP Statistic Mail - Check Channels and Order Values - Datefilter change made for "Yesterday"mailtype
      H1322       02.07.14 FF        Small Bugfix in CheckDDUp
      H1244       09.07.14 FF        Include Belgium in ERP and Finance statistic mail
      H1010       21.07.14 MBY       Cleanup of old shipment posting and invoicing jobs
      H1321       06.08.14 FF        New function SendEDIMail
      H1444       05.08.14 FF        CheckERPStat: base date calculation on WORKDATE instead of TODAY and change Calc. for weekly/monthly
      H1518       04.09.14 FF        ERP Stat: Change Font Colour for subheader / Changed font colour from 2Gainsboro" to "#A3A3A3"
      H1663       17.10.14 FF        Add Italy to FinanceStat and ERP Stat + Comment Cleanup
      H2101       24.03.15 MSL       Create Notification when running out of DHL No's
    }
    END.
  }
}

