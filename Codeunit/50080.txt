OBJECT Codeunit 50080 WS PO Mgt
{
  OBJECT-PROPERTIES
  {
    Date=07.06.15;
    Time=08:24:16;
    Modified=Yes;
    Version List=chrmu,HME4306;
  }
  PROPERTIES
  {
    OnRun=VAR
            tempvar@1000000000 : BigText;
            OutFile@1000000003 : File;
            InStreamDataport@1000000002 : InStream;
            BigT@1000000001 : BigText;
          BEGIN
            //GetPO('PO12005432',tempvar);
            //MESSAGE(FORMAT(tempvar.LENGTH));
            OutFile.OPEN('C:\temp\12.xml');
            OutFile.CREATEINSTREAM(InStreamDataport);
            BigT.READ(InStreamDataport);
            UpdatePO(BigT);
          END;

  }
  CODE
  {
    VAR
      XMLDOMMgt@1000000000 : Codeunit 6224;
      XMLDom@1000000008 : Automation "{F5078F18-C551-11D3-89B9-0000F81FE221} 6.0:{F6D90F11-9C73-11D3-B32E-00C04F990BB4}:'Microsoft XML, v6.0'.DOMDocument";
      XMLDomIn@1000000007 : Automation "{F5078F18-C551-11D3-89B9-0000F81FE221} 6.0:{F6D90F11-9C73-11D3-B32E-00C04F990BB4}:'Microsoft XML, v6.0'.DOMDocument";
      XMLNode@1000000006 : Automation "{F5078F18-C551-11D3-89B9-0000F81FE221} 6.0:{2933BF80-7B36-11D2-B20E-00C04F983E60}:'Microsoft XML, v6.0'.IXMLDOMNode";
      XMLRoot@1000000005 : Automation "{F5078F18-C551-11D3-89B9-0000F81FE221} 6.0:{2933BF80-7B36-11D2-B20E-00C04F983E60}:'Microsoft XML, v6.0'.IXMLDOMNode";
      XMLChild@1000000004 : Automation "{F5078F18-C551-11D3-89B9-0000F81FE221} 6.0:{2933BF80-7B36-11D2-B20E-00C04F983E60}:'Microsoft XML, v6.0'.IXMLDOMNode";
      XMLChild1@1000000003 : Automation "{F5078F18-C551-11D3-89B9-0000F81FE221} 6.0:{2933BF80-7B36-11D2-B20E-00C04F983E60}:'Microsoft XML, v6.0'.IXMLDOMNode";
      XMLNodeList@1000000002 : Automation "{F5078F18-C551-11D3-89B9-0000F81FE221} 6.0:{2933BF82-7B36-11D2-B20E-00C04F983E60}:'Microsoft XML, v6.0'.IXMLDOMNodeList";
      XMLNodeList1@1000000001 : Automation "{F5078F18-C551-11D3-89B9-0000F81FE221} 6.0:{2933BF82-7B36-11D2-B20E-00C04F983E60}:'Microsoft XML, v6.0'.IXMLDOMNodeList";

    PROCEDURE GetPO@1000000000(PONo@1000000000 : Code[20];VAR Result@1000000001 : BigText);
    VAR
      TempBlob@1000000002 : Record 99008535;
      inStr@1000000003 : InStream;
      outStr@1000000004 : OutStream;
    BEGIN
      CreatePO(PONo);
      //Result.ADDTEXT(XMLDom.xml);
      TempBlob.Blob.CREATEOUTSTREAM(outStr);
      XMLDom.save(outStr);
      TempBlob.CALCFIELDS(Blob);
      TempBlob.Blob.CREATEINSTREAM(inStr);
      Result.READ(inStr);
      XMLDom.save('C:\temp\11.xml');
    END;

    LOCAL PROCEDURE CreatePO@1000000015(PONo@1000000017 : Code[20]) : Boolean;
    VAR
      PO@1000000000 : Record 38;
      POLine@1000000008 : Record 39;
      SO@1000000019 : Record 36;
      SOLine@1000000020 : Record 37;
      Vend@1000000011 : Record 23;
      Item@1000000012 : Record 27;
      GLAcc@1000000013 : Record 15;
      ShipToAddr@1000000014 : Record 222;
      Curr@1000000015 : Record 4;
      Job@1000000016 : Record 167;
      intVar@1000000001 : Integer;
      decVar@1000000006 : Decimal;
      dateVar@1000000005 : Date;
      boolVar@1000000007 : Boolean;
      DocNo@1000000002 : Code[20];
      DocType@1000000003 : Integer;
      DocStatus@1000000004 : Integer;
      LineNo@1000000009 : Integer;
      i@1000000010 : Integer;
      DropShip@1000000018 : Boolean;
    BEGIN
      IF ISCLEAR(XMLDom) THEN
        CREATE(XMLDom);

      XMLDom.loadXML ('<?xml version="1.0"?><Purchase_Order/>');
      XMLRoot := XMLDom.documentElement;
      XMLDOMMgt.SetNormalCase;
      DropShip := FALSE;

      IF NOT PO.GET(PO."Document Type"::Order,PONo) THEN EXIT;

      WITH PO DO BEGIN
          XMLNode := XMLRoot;

          XMLDOMMgt.AddElement(XMLNode,'No.',FORMAT("No."),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Buy-from_Vendor_No.',FORMAT("Buy-from Vendor No."),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Pay-to_Vendor_No.',FORMAT("Pay-to Vendor No."),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Pay-to_Name',FORMAT("Pay-to Name"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Pay-to_Name_2',FORMAT("Pay-to Name 2"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Pay-to_Address',FORMAT("Pay-to Address"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Pay-to_Address_2',FORMAT("Pay-to Address 2"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Pay-to_City',FORMAT("Pay-to City"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Pay-to_Contact',FORMAT("Pay-to Contact"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Your_Reference',FORMAT("Your Reference"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Ship-to_Code',FORMAT("Ship-to Code"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Ship-to_Name',FORMAT("Ship-to Name"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Ship-to_Name_2',FORMAT("Ship-to Name 2"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Ship-to_Address',FORMAT("Ship-to Address"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Ship-to_Address_2',FORMAT("Ship-to Address 2"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Ship-to_City',FORMAT("Ship-to City"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Ship-to_Contact',FORMAT("Ship-to Contact"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Order_Date',FORMAT("Order Date"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Posting_Date',FORMAT("Posting Date"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Expected_Receipt_Date',FORMAT("Expected Receipt Date"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Posting_Description',FORMAT("Posting Description"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Payment_Terms_Code',FORMAT("Payment Terms Code"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Due_Date',FORMAT("Due Date"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Payment_Discount_Per',FORMAT("Payment Discount %"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Pmt._Discount_Date',FORMAT("Pmt. Discount Date"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Shipment_Method_Code',FORMAT("Shipment Method Code"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Location_Code',FORMAT("Location Code"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Shortcut_Dimension_1_Code',FORMAT("Shortcut Dimension 1 Code"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Shortcut_Dimension_2_Code',FORMAT("Shortcut Dimension 2 Code"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Vendor_Posting_Group',FORMAT("Vendor Posting Group"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Currency_Code',FORMAT("Currency Code"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Currency_Factor',FORMAT("Currency Factor"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Prices_Including_VAT',FORMAT("Prices Including VAT"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Invoice_Disc._Code',FORMAT("Invoice Disc. Code"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Language_Code',FORMAT("Language Code"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Purchaser_Code',FORMAT("Purchaser Code"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Order_Class',FORMAT("Order Class"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Comment',FORMAT(Comment),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'No._Printed',FORMAT("No. Printed"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'On_Hold',FORMAT("On Hold"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Applies-to_Doc._Type',FORMAT("Applies-to Doc. Type"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Applies-to_Doc._No.',FORMAT("Applies-to Doc. No."),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Bal._Account_No.',FORMAT("Bal. Account No."),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Receive',FORMAT(Receive),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Invoice',FORMAT(Invoice),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Amount',FORMAT(Amount),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Amount_Including_VAT',FORMAT("Amount Including VAT"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Receiving_No.',FORMAT("Receiving No."),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Posting_No.',FORMAT("Posting No."),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Last_Receiving_No.',FORMAT("Last Receiving No."),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Last_Posting_No.',FORMAT("Last Posting No."),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Vendor_Order_No.',FORMAT("Vendor Order No."),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Vendor_Shipment_No.',FORMAT("Vendor Shipment No."),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Vendor_Invoice_No.',FORMAT("Vendor Invoice No."),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Vendor_Cr._Memo_No.',FORMAT("Vendor Cr. Memo No."),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'VAT_Registration_No.',FORMAT("VAT Registration No."),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Sell-to_Customer_No.',FORMAT("Sell-to Customer No."),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Reason_Code',FORMAT("Reason Code"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Gen._Bus._Posting_Group',FORMAT("Gen. Bus. Posting Group"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Transaction_Type',FORMAT("Transaction Type"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Transport_Method',FORMAT("Transport Method"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'VAT_Country_Region_Code',FORMAT("VAT Country/Region Code"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Buy-from_Vendor_Name',FORMAT("Buy-from Vendor Name"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Buy-from_Vendor_Name_2',FORMAT("Buy-from Vendor Name 2"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Buy-from_Address',FORMAT("Buy-from Address"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Buy-from_Address_2',FORMAT("Buy-from Address 2"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Buy-from_City',FORMAT("Buy-from City"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Buy-from_Contact',FORMAT("Buy-from Contact"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Pay-to_Post_Code',FORMAT("Pay-to Post Code"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Pay-to_County',FORMAT("Pay-to County"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Pay-to_Country_Region_Code',FORMAT("Pay-to Country/Region Code"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Buy-from_Post_Code',FORMAT("Buy-from Post Code"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Buy-from_County',FORMAT("Buy-from County"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Buy-from_Country_Region_Code',FORMAT("Buy-from Country/Region Code"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Ship-to_Post_Code',FORMAT("Ship-to Post Code"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Ship-to_County',FORMAT("Ship-to County"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Ship-to_Country_Region_Code',FORMAT("Ship-to Country/Region Code"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Bal._Account_Type',FORMAT("Bal. Account Type"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Order_Address_Code',FORMAT("Order Address Code"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Entry_Point',FORMAT("Entry Point"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Correction',FORMAT(Correction),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Document_Date',FORMAT("Document Date"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Area',FORMAT(Area),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Transaction_Specification',FORMAT("Transaction Specification"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Payment_Method_Code',FORMAT("Payment Method Code"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'No._Series',FORMAT("No. Series"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Posting_No._Series',FORMAT("Posting No. Series"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Receiving_No._Series',FORMAT("Receiving No. Series"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Tax_Area_Code',FORMAT("Tax Area Code"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Tax_Liable',FORMAT("Tax Liable"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'VAT_Bus._Posting_Group',FORMAT("VAT Bus. Posting Group"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Applies-to_ID',FORMAT("Applies-to ID"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'VAT_Base_Discount_Per',FORMAT("VAT Base Discount %"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Status',FORMAT(Status),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Invoice_Discount_Calculation',FORMAT("Invoice Discount Calculation"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Invoice_Discount_Value',FORMAT("Invoice Discount Value"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Send_IC_Document',FORMAT("Send IC Document"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'IC_Status',FORMAT("IC Status"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Buy-from_IC_Partner_Code',FORMAT("Buy-from IC Partner Code"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Pay-to_IC_Partner_Code',FORMAT("Pay-to IC Partner Code"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'IC_Direction',FORMAT("IC Direction"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Prepayment_No.',FORMAT("Prepayment No."),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Last_Prepayment_No.',FORMAT("Last Prepayment No."),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Prepmt._Cr._Memo_No.',FORMAT("Prepmt. Cr. Memo No."),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Last_Prepmt._Cr._Memo_No.',FORMAT("Last Prepmt. Cr. Memo No."),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Prepayment_Per',FORMAT("Prepayment %"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Prepayment_No._Series',FORMAT("Prepayment No. Series"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Compress_Prepayment',FORMAT("Compress Prepayment"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Prepayment_Due_Date',FORMAT("Prepayment Due Date"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Prepmt._Cr._Memo_No._Series',FORMAT("Prepmt. Cr. Memo No. Series"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Prepmt._Posting_Description',FORMAT("Prepmt. Posting Description"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Prepmt._Pmt._Discount_Date',FORMAT("Prepmt. Pmt. Discount Date"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Prepmt._Payment_Terms_Code',FORMAT("Prepmt. Payment Terms Code"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Prepmt._Payment_Discount_Per',FORMAT("Prepmt. Payment Discount %"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Quote_No.',FORMAT("Quote No."),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'No._of_Archived_Versions',FORMAT("No. of Archived Versions"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Doc._No._Occurrence',FORMAT("Doc. No. Occurrence"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Campaign_No.',FORMAT("Campaign No."),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Buy-from_Contact_No.',FORMAT("Buy-from Contact No."),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Pay-to_Contact_No.',FORMAT("Pay-to Contact No."),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Responsibility_Center',FORMAT("Responsibility Center"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Completely_Received',FORMAT("Completely Received"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Posting_from_Whse._Ref.',FORMAT("Posting from Whse. Ref."),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Location_Filter',FORMAT("Location Filter"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Requested_Receipt_Date',FORMAT("Requested Receipt Date"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Promised_Receipt_Date',FORMAT("Promised Receipt Date"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Lead_Time_Calculation',FORMAT("Lead Time Calculation"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Inbound_Whse._Handling_Time',FORMAT("Inbound Whse. Handling Time"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Date_Filter',FORMAT("Date Filter"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Vendor_Authorization_No.',FORMAT("Vendor Authorization No."),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Return_Shipment_No.',FORMAT("Return Shipment No."),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Return_Shipment_No._Series',FORMAT("Return Shipment No. Series"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Ship',FORMAT(Ship),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Last_Return_Shipment_No.',FORMAT("Last Return Shipment No."),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Assigned_User_ID',FORMAT("Assigned User ID"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Registration_No.',FORMAT("Registration No."),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Commission_No.',FORMAT("Commission No."),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Ship-to_E-Mail',FORMAT("Ship-to E-Mail"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Buy-from_E-Mail',FORMAT("Buy-from E-Mail"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Delivery_No.',FORMAT("Delivery No."),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'RG_Discount',FORMAT("RG Discount"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Last_Seq._No.',FORMAT("Last Seq. No."),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Confirmation_Date',FORMAT("Confirmation Receipt Date"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Confirmation_No.',FORMAT("Confirmation No."),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Earliest_Delivery_Date',FORMAT("Earliest Delivery Date"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Latest_Delivery_Date',FORMAT("Latest Delivery Date"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Fixed_Date',FORMAT("Fixed Date"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Delivery_Position',FORMAT("Delivery Position"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Created_on',FORMAT("Created on"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Created_from',FORMAT("Created from"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Kommissionierung',FORMAT(Kommissionierung),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Re_Nr',FORMAT("REB No."),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Re_Rechnungsbetrag_brutto',FORMAT("REB Gross Invoice Amount"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Re_Rechnungsbetrag_netto',FORMAT("REB Net Invoice Amount"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Re_Eingangsdatum',FORMAT("REB Receiving Date"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Re_Stempelnummer',FORMAT("REB Stamp No."),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'DHL_reported',FORMAT("DHL reported"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'DHL_Reporting_Date',FORMAT("DHL Reporting Date"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'DHL_Confirmation',FORMAT("DHL Confirmation"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'DHL_Confirmation_Date',FORMAT("DHL Confirmation Date"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Date_Received',FORMAT("Date Received"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Time_Received',FORMAT("Time Received"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'BizTalk_Purchase_Quote',FORMAT("BizTalk Purchase Quote"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'BizTalk_Purch._Order_Cnfmn.',FORMAT("BizTalk Purch. Order Cnfmn."),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'BizTalk_Purchase_Invoice',FORMAT("BizTalk Purchase Invoice"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'BizTalk_Purchase_Receipt',FORMAT("BizTalk Purchase Receipt"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'BizTalk_Purchase_Credit_Memo',FORMAT("BizTalk Purchase Credit Memo"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Date_Sent',FORMAT("Date Sent"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Time_Sent',FORMAT("Time Sent"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'BizTalk_Request_for_Purch._Qte',FORMAT("BizTalk Request for Purch. Qte"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'BizTalk_Purchase_Order',FORMAT("BizTalk Purchase Order"),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'Vendor_Quote_No.',FORMAT("Vendor Quote No."),'',XMLChild);
          XMLDOMMgt.AddElement(XMLNode,'BizTalk_Document_Sent',FORMAT("BizTalk Document Sent"),'',XMLChild);


        END;

        //XMLDOMMgt.AddElement (XMLNode, 'LINES', '','',XMLNode);
        WITH POLine DO BEGIN
          RESET;
          SETRANGE("Document No.",PO."No.");
          IF FINDSET THEN
            REPEAT
              XMLDOMMgt.AddElement (XMLNode, 'Purchase_Order_Line', '','',XMLChild);

              XMLDOMMgt.AddElement(XMLChild,'Line_No.',FORMAT("Line No."),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Type',FORMAT(Type),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'No.',FORMAT("No."),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Buy-from_Vendor_No.',FORMAT("Buy-from Vendor No."),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Location_Code',FORMAT("Location Code"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Posting_Group',FORMAT("Posting Group"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Expected_Receipt_Date',FORMAT("Expected Receipt Date"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Description',FORMAT(Description),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Description_2',FORMAT("Description 2"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Unit_of_Measure',FORMAT("Unit of Measure"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Quantity',FORMAT(Quantity),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Outstanding_Quantity',FORMAT("Outstanding Quantity"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Qty._to_Invoice',FORMAT("Qty. to Invoice"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Qty._to_Receive',FORMAT("Qty. to Receive"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Direct_Unit_Cost',FORMAT("Direct Unit Cost"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Unit_Cost_LCY',FORMAT("Unit Cost (LCY)"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'VAT_Per',FORMAT("VAT %"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Line_Discount_Per',FORMAT("Line Discount %"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Line_Discount_Amount',FORMAT("Line Discount Amount"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Amount',FORMAT(Amount),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Amount_Including_VAT',FORMAT("Amount Including VAT"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Unit_Price_LCY',FORMAT("Unit Price (LCY)"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Allow_Invoice_Disc.',FORMAT("Allow Invoice Disc."),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Gross_Weight',FORMAT("Gross Weight"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Net_Weight',FORMAT("Net Weight"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Units_per_Parcel',FORMAT("Units per Parcel"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Unit_Volume',FORMAT("Unit Volume"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Appl.-to_Item_Entry',FORMAT("Appl.-to Item Entry"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Shortcut_Dimension_1_Code',FORMAT("Shortcut Dimension 1 Code"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Shortcut_Dimension_2_Code',FORMAT("Shortcut Dimension 2 Code"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Job_No.',FORMAT("Job No."),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Indirect_Cost_Per',FORMAT("Indirect Cost %"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Outstanding_Amount',FORMAT("Outstanding Amount"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Qty._Rcd._Not_Invoiced',FORMAT("Qty. Rcd. Not Invoiced"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Amt._Rcd._Not_Invoiced',FORMAT("Amt. Rcd. Not Invoiced"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Quantity_Received',FORMAT("Quantity Received"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Quantity_Invoiced',FORMAT("Quantity Invoiced"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Receipt_No.',FORMAT("Receipt No."),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Receipt_Line_No.',FORMAT("Receipt Line No."),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Profit_Per',FORMAT("Profit %"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Pay-to_Vendor_No.',FORMAT("Pay-to Vendor No."),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Inv._Discount_Amount',FORMAT("Inv. Discount Amount"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Vendor_Item_No.',FORMAT("Vendor Item No."),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Sales_Order_No.',FORMAT("Sales Order No."),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Sales_Order_Line_No.',FORMAT("Sales Order Line No."),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Drop_Shipment',FORMAT("Drop Shipment"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Gen._Bus._Posting_Group',FORMAT("Gen. Bus. Posting Group"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Gen._Prod._Posting_Group',FORMAT("Gen. Prod. Posting Group"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'VAT_Calculation_Type',FORMAT("VAT Calculation Type"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Transaction_Type',FORMAT("Transaction Type"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Transport_Method',FORMAT("Transport Method"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Attached_to_Line_No.',FORMAT("Attached to Line No."),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Entry_Point',FORMAT("Entry Point"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Area',FORMAT(Area),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Transaction_Specification',FORMAT("Transaction Specification"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Tax_Area_Code',FORMAT("Tax Area Code"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Tax_Liable',FORMAT("Tax Liable"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Tax_Group_Code',FORMAT("Tax Group Code"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Use_Tax',FORMAT("Use Tax"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'VAT_Bus._Posting_Group',FORMAT("VAT Bus. Posting Group"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'VAT_Prod._Posting_Group',FORMAT("VAT Prod. Posting Group"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Currency_Code',FORMAT("Currency Code"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Outstanding_Amount_LCY',FORMAT("Outstanding Amount (LCY)"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Amt._Rcd._Not_Invoiced_LCY',FORMAT("Amt. Rcd. Not Invoiced (LCY)"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Reserved_Quantity',FORMAT("Reserved Quantity"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Blanket_Order_No.',FORMAT("Blanket Order No."),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Blanket_Order_Line_No.',FORMAT("Blanket Order Line No."),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'VAT_Base_Amount',FORMAT("VAT Base Amount"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Unit_Cost',FORMAT("Unit Cost"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'System-Created_Entry',FORMAT("System-Created Entry"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Line_Amount',FORMAT("Line Amount"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'VAT_Difference',FORMAT("VAT Difference"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Inv._Disc._Amount_to_Invoice',FORMAT("Inv. Disc. Amount to Invoice"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'VAT_Identifier',FORMAT("VAT Identifier"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'IC_Partner_Ref._Type',FORMAT("IC Partner Ref. Type"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'IC_Partner_Reference',FORMAT("IC Partner Reference"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Prepayment_Per',FORMAT("Prepayment %"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Prepmt._Line_Amount',FORMAT("Prepmt. Line Amount"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Prepmt._Amt._Inv.',FORMAT("Prepmt. Amt. Inv."),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Prepmt._Amt._Incl._VAT',FORMAT("Prepmt. Amt. Incl. VAT"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Prepayment_Amount',FORMAT("Prepayment Amount"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Prepmt._VAT_Base_Amt.',FORMAT("Prepmt. VAT Base Amt."),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Prepayment_VAT_Per',FORMAT("Prepayment VAT %"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Prepmt._VAT_Calc._Type',FORMAT("Prepmt. VAT Calc. Type"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Prepayment_VAT_Identifier',FORMAT("Prepayment VAT Identifier"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Prepayment_Tax_Area_Code',FORMAT("Prepayment Tax Area Code"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Prepayment_Tax_Liable',FORMAT("Prepayment Tax Liable"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Prepayment_Tax_Group_Code',FORMAT("Prepayment Tax Group Code"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Prepmt_Amt_to_Deduct',FORMAT("Prepmt Amt to Deduct"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Prepmt_Amt_Deducted',FORMAT("Prepmt Amt Deducted"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Prepayment_Line',FORMAT("Prepayment Line"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Prepmt._Amount_Inv._Incl._VAT',FORMAT("Prepmt. Amount Inv. Incl. VAT"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Prepmt._Amount_Inv._LCY',FORMAT("Prepmt. Amount Inv. (LCY)"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'IC_Partner_Code',FORMAT("IC Partner Code"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Prepayment_VAT_Difference',FORMAT("Prepayment VAT Difference"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Prepmt_VAT_Diff._to_Deduct',FORMAT("Prepmt VAT Diff. to Deduct"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Prepmt_VAT_Diff._Deducted',FORMAT("Prepmt VAT Diff. Deducted"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Job_Task_No.',FORMAT("Job Task No."),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Job_Line_Type',FORMAT("Job Line Type"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Job_Unit_Price',FORMAT("Job Unit Price"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Job_Total_Price',FORMAT("Job Total Price"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Job_Line_Amount',FORMAT("Job Line Amount"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Job_Line_Discount_Amount',FORMAT("Job Line Discount Amount"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Job_Line_Discount_Per',FORMAT("Job Line Discount %"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Job_Unit_Price_LCY',FORMAT("Job Unit Price (LCY)"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Job_Total_Price_LCY',FORMAT("Job Total Price (LCY)"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Job_Line_Amount_LCY',FORMAT("Job Line Amount (LCY)"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Job_Line_Disc._Amount_LCY',FORMAT("Job Line Disc. Amount (LCY)"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Job_Currency_Factor',FORMAT("Job Currency Factor"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Job_Currency_Code',FORMAT("Job Currency Code"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Prod._Order_No.',FORMAT("Prod. Order No."),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Variant_Code',FORMAT("Variant Code"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Bin_Code',FORMAT("Bin Code"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Qty._per_Unit_of_Measure',FORMAT("Qty. per Unit of Measure"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Unit_of_Measure_Code',FORMAT("Unit of Measure Code"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Quantity_Base',FORMAT("Quantity (Base)"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Outstanding_Qty._Base',FORMAT("Outstanding Qty. (Base)"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Qty._to_Invoice_Base',FORMAT("Qty. to Invoice (Base)"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Qty._to_Receive_Base',FORMAT("Qty. to Receive (Base)"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Qty._Rcd._Not_Invoiced_Base',FORMAT("Qty. Rcd. Not Invoiced (Base)"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Qty._Received_Base',FORMAT("Qty. Received (Base)"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Qty._Invoiced_Base',FORMAT("Qty. Invoiced (Base)"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Reserved_Qty._Base',FORMAT("Reserved Qty. (Base)"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'FA_Posting_Date',FORMAT("FA Posting Date"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'FA_Posting_Type',FORMAT("FA Posting Type"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Depreciation_Book_Code',FORMAT("Depreciation Book Code"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Salvage_Value',FORMAT("Salvage Value"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Depr._until_FA_Posting_Date',FORMAT("Depr. until FA Posting Date"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Depr._Acquisition_Cost',FORMAT("Depr. Acquisition Cost"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Maintenance_Code',FORMAT("Maintenance Code"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Insurance_No.',FORMAT("Insurance No."),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Budgeted_FA_No.',FORMAT("Budgeted FA No."),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Duplicate_in_Depreciation_Book',FORMAT("Duplicate in Depreciation Book"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Use_Duplication_List',FORMAT("Use Duplication List"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Responsibility_Center',FORMAT("Responsibility Center"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Cross-Reference_No.',FORMAT("Cross-Reference No."),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Unit_of_Measure_Cross_Ref.',FORMAT("Unit of Measure (Cross Ref.)"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Cross-Reference_Type',FORMAT("Cross-Reference Type"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Cross-Reference_Type_No.',FORMAT("Cross-Reference Type No."),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Item_Category_Code',FORMAT("Item Category Code"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Nonstock',FORMAT(Nonstock),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Purchasing_Code',FORMAT("Purchasing Code"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Product_Group_Code',FORMAT("Product Group Code"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Special_Order',FORMAT("Special Order"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Special_Order_Sales_No.',FORMAT("Special Order Sales No."),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Special_Order_Sales_Line_No.',FORMAT("Special Order Sales Line No."),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Whse._Outstanding_Qty._Base',FORMAT("Whse. Outstanding Qty. (Base)"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Completely_Received',FORMAT("Completely Received"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Requested_Receipt_Date',FORMAT("Requested Receipt Date"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Promised_Receipt_Date',FORMAT("Promised Receipt Date"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Lead_Time_Calculation',FORMAT("Lead Time Calculation"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Inbound_Whse._Handling_Time',FORMAT("Inbound Whse. Handling Time"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Planned_Receipt_Date',FORMAT("Planned Receipt Date"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Order_Date',FORMAT("Order Date"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Allow_Item_Charge_Assignment',FORMAT("Allow Item Charge Assignment"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Qty._to_Assign',FORMAT("Qty. to Assign"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Qty._Assigned',FORMAT("Qty. Assigned"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Return_Qty._to_Ship',FORMAT("Return Qty. to Ship"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Return_Qty._to_Ship_Base',FORMAT("Return Qty. to Ship (Base)"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Return_Qty._Shipped_Not_Invd.',FORMAT("Return Qty. Shipped Not Invd."),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Ret._Qty._Shpd_Not_Invd.Base',FORMAT("Ret. Qty. Shpd Not Invd.(Base)"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Return_Shpd._Not_Invd.',FORMAT("Return Shpd. Not Invd."),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Return_Shpd._Not_Invd._LCY',FORMAT("Return Shpd. Not Invd. (LCY)"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Return_Qty._Shipped',FORMAT("Return Qty. Shipped"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Return_Qty._Shipped_Base',FORMAT("Return Qty. Shipped (Base)"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Return_Shipment_No.',FORMAT("Return Shipment No."),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Return_Shipment_Line_No.',FORMAT("Return Shipment Line No."),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Return_Reason_Code',FORMAT("Return Reason Code"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Dropshipnr.',FORMAT("Dropshipnr."),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Order_No.',FORMAT("Order No."),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Order_Line_No.',FORMAT("Order Line No."),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Delivery_Confirmation',FORMAT("Delivery Confirmation"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'DHL_Shipment_Number',FORMAT("DHL Shipment Number"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Status_Event_Code',FORMAT("Status Event Code"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Status_Code',FORMAT("Status Code"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Seq._No.',FORMAT("Seq. No."),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Damaged_Item_Quantity',FORMAT("Damaged Item Quantity"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Max._Pickup_Date',FORMAT("Max. Pickup Date"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Max._Delivery_Date',FORMAT("Max. Delivery Date"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Purchaser_Code',FORMAT("Purchaser Code"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Status',FORMAT(Status),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Last_Comment',FORMAT("Last Comment"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Promised_Receipt_Date_2',FORMAT("Promised Receipt Date 2"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Created_At',FORMAT("Created At"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Modified_At',FORMAT("Modified At"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Routing_No.',FORMAT("Routing No."),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Operation_No.',FORMAT("Operation No."),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Work_Center_No.',FORMAT("Work Center No."),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Finished',FORMAT(Finished),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Prod._Order_Line_No.',FORMAT("Prod. Order Line No."),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Overhead_Rate',FORMAT("Overhead Rate"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'MPS_Order',FORMAT("MPS Order"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Planning_Flexibility',FORMAT("Planning Flexibility"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Safety_Lead_Time',FORMAT("Safety Lead Time"),'',XMLChild1);
              XMLDOMMgt.AddElement(XMLChild,'Routing_Reference_No.',FORMAT("Routing Reference No."),'',XMLChild1);

              IF POLine."Drop Shipment" THEN
                DropShip := POLine."Drop Shipment";
            UNTIL NEXT = 0;
        END;
        IF POLine.FINDFIRST THEN
          IF POLine."Drop Shipment" AND SO.GET(SO."Document Type"::Order,POLine."Sales Order No.") THEN
            WITH SO DO BEGIN
              XMLDOMMgt.AddElement (XMLNode, 'Sales_Order', '','',XMLNode);

                XMLDOMMgt.AddElement(XMLNode, 'Document_Type',FORMAT("Document Type"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Sell-to_Customer_No.',FORMAT("Sell-to Customer No."),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'No.',FORMAT("No."),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Bill-to_Customer_No.',FORMAT("Bill-to Customer No."),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Bill-to_Name',FORMAT("Bill-to Name"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Bill-to_Name_2',FORMAT("Bill-to Name 2"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Bill-to_Address',FORMAT("Bill-to Address"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Bill-to_Address_2',FORMAT("Bill-to Address 2"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Bill-to_City',FORMAT("Bill-to City"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Bill-to_Contact',FORMAT("Bill-to Contact"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Your_Reference',FORMAT("Your Reference"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Ship-to_Code',FORMAT("Ship-to Code"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Ship-to_Name',FORMAT("Ship-to Name"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Ship-to_Name_2',FORMAT("Ship-to Name 2"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Ship-to_Address',FORMAT("Ship-to Address"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Ship-to_Address_2',FORMAT("Ship-to Address 2"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Ship-to_City',FORMAT("Ship-to City"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Ship-to_Contact',FORMAT("Ship-to Contact"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Order_Date',FORMAT("Order Date"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Posting_Date',FORMAT("Posting Date"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Shipment_Date',FORMAT("Shipment Date"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Posting_Description',FORMAT("Posting Description"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Payment_Terms_Code',FORMAT("Payment Terms Code"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Due_Date',FORMAT("Due Date"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Payment_Discount_Per',FORMAT("Payment Discount %"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Pmt._Discount_Date',FORMAT("Pmt. Discount Date"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Shipment_Method_Code',FORMAT("Shipment Method Code"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Location_Code',FORMAT("Location Code"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Shortcut_Dimension_1_Code',FORMAT("Shortcut Dimension 1 Code"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Shortcut_Dimension_2_Code',FORMAT("Shortcut Dimension 2 Code"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Customer_Posting_Group',FORMAT("Customer Posting Group"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Currency_Code',FORMAT("Currency Code"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Currency_Factor',FORMAT("Currency Factor"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Customer_Price_Group',FORMAT("Customer Price Group"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Prices_Including_VAT',FORMAT("Prices Including VAT"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Invoice_Disc._Code',FORMAT("Invoice Disc. Code"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Customer_Disc._Group',FORMAT("Customer Disc. Group"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Language_Code',FORMAT("Language Code"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Salesperson_Code',FORMAT("Salesperson Code"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Order_Class',FORMAT("Order Class"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Comment',FORMAT(Comment),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'No._Printed',FORMAT("No. Printed"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'On_Hold',FORMAT("On Hold"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Applies-to_Doc._Type',FORMAT("Applies-to Doc. Type"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Applies-to_Doc._No.',FORMAT("Applies-to Doc. No."),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Bal._Account_No.',FORMAT("Bal. Account No."),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Ship',FORMAT(Ship),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Invoice',FORMAT(Invoice),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Amount',FORMAT(Amount),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Amount_Including_VAT',FORMAT("Amount Including VAT"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Shipping_No.',FORMAT("Shipping No."),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Posting_No.',FORMAT("Posting No."),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Last_Shipping_No.',FORMAT("Last Shipping No."),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Last_Posting_No.',FORMAT("Last Posting No."),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Prepayment_No.',FORMAT("Prepayment No."),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Last_Prepayment_No.',FORMAT("Last Prepayment No."),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Prepmt._Cr._Memo_No.',FORMAT("Prepmt. Cr. Memo No."),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Last_Prepmt._Cr._Memo_No.',FORMAT("Last Prepmt. Cr. Memo No."),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'VAT_Registration_No.',FORMAT("VAT Registration No."),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Combine_Shipments',FORMAT("Combine Shipments"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Reason_Code',FORMAT("Reason Code"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Gen._Bus._Posting_Group',FORMAT("Gen. Bus. Posting Group"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'EU_3-Party_Trade',FORMAT("EU 3-Party Trade"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Transaction_Type',FORMAT("Transaction Type"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Transport_Method',FORMAT("Transport Method"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'VAT_Country_Region_Code',FORMAT("VAT Country/Region Code"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Sell-to_Customer_Name',FORMAT("Sell-to Customer Name"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Sell-to_Customer_Name_2',FORMAT("Sell-to Customer Name 2"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Sell-to_Address',FORMAT("Sell-to Address"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Sell-to_Address_2',FORMAT("Sell-to Address 2"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Sell-to_City',FORMAT("Sell-to City"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Sell-to_Contact',FORMAT("Sell-to Contact"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Bill-to_Post_Code',FORMAT("Bill-to Post Code"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Bill-to_County',FORMAT("Bill-to County"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Bill-to_Country_Region_Code',FORMAT("Bill-to Country/Region Code"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Sell-to_Post_Code',FORMAT("Sell-to Post Code"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Sell-to_County',FORMAT("Sell-to County"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Sell-to_Country_Region_Code',FORMAT("Sell-to Country/Region Code"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Ship-to_Post_Code',FORMAT("Ship-to Post Code"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Ship-to_County',FORMAT("Ship-to County"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Ship-to_Country_Region_Code',FORMAT("Ship-to Country/Region Code"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Bal._Account_Type',FORMAT("Bal. Account Type"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Exit_Point',FORMAT("Exit Point"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Correction',FORMAT(Correction),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Document_Date',FORMAT("Document Date"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'External_Document_No.',FORMAT("External Document No."),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Area',FORMAT(Area),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Transaction_Specification',FORMAT("Transaction Specification"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Payment_Method_Code',FORMAT("Payment Method Code"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Shipping_Agent_Code',FORMAT("Shipping Agent Code"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Package_Tracking_No.',FORMAT("Package Tracking No."),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'No._Series',FORMAT("No. Series"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Posting_No._Series',FORMAT("Posting No. Series"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Shipping_No._Series',FORMAT("Shipping No. Series"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Tax_Area_Code',FORMAT("Tax Area Code"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Tax_Liable',FORMAT("Tax Liable"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'VAT_Bus._Posting_Group',FORMAT("VAT Bus. Posting Group"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Reserve',FORMAT(Reserve),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Applies-to_ID',FORMAT("Applies-to ID"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'VAT_Base_Discount_Per',FORMAT("VAT Base Discount %"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Status',FORMAT(Status),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Invoice_Discount_Calculation',FORMAT("Invoice Discount Calculation"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Invoice_Discount_Value',FORMAT("Invoice Discount Value"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Send_IC_Document',FORMAT("Send IC Document"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'IC_Status',FORMAT("IC Status"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Sell-to_IC_Partner_Code',FORMAT("Sell-to IC Partner Code"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Bill-to_IC_Partner_Code',FORMAT("Bill-to IC Partner Code"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'IC_Direction',FORMAT("IC Direction"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Prepayment_Per',FORMAT("Prepayment %"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Prepayment_No._Series',FORMAT("Prepayment No. Series"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Compress_Prepayment',FORMAT("Compress Prepayment"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Prepayment_Due_Date',FORMAT("Prepayment Due Date"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Prepmt._Cr._Memo_No._Series',FORMAT("Prepmt. Cr. Memo No. Series"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Prepmt._Posting_Description',FORMAT("Prepmt. Posting Description"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Prepmt._Pmt._Discount_Date',FORMAT("Prepmt. Pmt. Discount Date"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Prepmt._Payment_Terms_Code',FORMAT("Prepmt. Payment Terms Code"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Prepmt._Payment_Discount_Per',FORMAT("Prepmt. Payment Discount %"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Quote_No.',FORMAT("Quote No."),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'No._of_Archived_Versions',FORMAT("No. of Archived Versions"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Doc._No._Occurrence',FORMAT("Doc. No. Occurrence"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Campaign_No.',FORMAT("Campaign No."),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Sell-to_Customer_Template_Code',FORMAT("Sell-to Customer Template Code"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Sell-to_Contact_No.',FORMAT("Sell-to Contact No."),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Bill-to_Contact_No.',FORMAT("Bill-to Contact No."),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Bill-to_Customer_Template_Code',FORMAT("Bill-to Customer Template Code"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Opportunity_No.',FORMAT("Opportunity No."),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Responsibility_Center',FORMAT("Responsibility Center"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Shipping_Advice',FORMAT("Shipping Advice"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Completely_Shipped',FORMAT("Completely Shipped"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Posting_from_Whse._Ref.',FORMAT("Posting from Whse. Ref."),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Location_Filter',FORMAT("Location Filter"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Requested_Delivery_Date',FORMAT("Requested Delivery Date"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Promised_Delivery_Date',FORMAT("Promised Delivery Date"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Shipping_Time',FORMAT("Shipping Time"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Outbound_Whse._Handling_Time',FORMAT("Outbound Whse. Handling Time"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Shipping_Agent_Service_Code',FORMAT("Shipping Agent Service Code"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Late_Order_Shipping',FORMAT("Late Order Shipping"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Date_Filter',FORMAT("Date Filter"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Receive',FORMAT(Receive),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Return_Receipt_No.',FORMAT("Return Receipt No."),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Return_Receipt_No._Series',FORMAT("Return Receipt No. Series"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Last_Return_Receipt_No.',FORMAT("Last Return Receipt No."),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Allow_Line_Disc.',FORMAT("Allow Line Disc."),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Get_Shipment_Used',FORMAT("Get Shipment Used"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Signature',FORMAT(Signature),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Assigned_User_ID',FORMAT("Assigned User ID"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Last_Seq._No.',FORMAT("Last Seq. No."),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Last_Marketplace',FORMAT("Last Marketplace"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'DHL_Shipment_Orders_Count',FORMAT("DHL Shipment Orders Count"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'DHL_Pickups_Count',FORMAT("DHL Pickups Count"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'DHL_Processing_Status',FORMAT("DHL Processing Status"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'DHL_Shipment_Errors_Exist',FORMAT("DHL Shipment Errors Exist"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'DHL_Pickup_Errors_Exist',FORMAT("DHL Pickup Errors Exist"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'DHL_E-mail_Send_Errors_Exist',FORMAT("DHL E-mail Send Errors Exist"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Website_No.',FORMAT("Website No."),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'BillPay_Last_Status',FORMAT("BillPay Last Status"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Transaction_No.',FORMAT("Transaction No."),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Order_Release_Date',FORMAT("Order Release Date"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Kommissionierung',FORMAT(Kommissionierung),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Waiting_for_payment_receipt',FORMAT("Waiting for payment receipt"),'',XMLChild);
                // S/gob-lku/09.07.2013/P1016
                //XMLDOMMgt.AddElement(XMLNode, 'DHL_reported',FORMAT("DHL reported"),'',XMLChild);
                //XMLDOMMgt.AddElement(XMLNode, 'DHL_Reporting_Date',FORMAT("DHL Reporting Date"),'',XMLChild);
                //XMLDOMMgt.AddElement(XMLNode, 'DHL_Reporting_No.',FORMAT("DHL Reporting No."),'',XMLChild);
                //XMLDOMMgt.AddElement(XMLNode, 'DHL_Confirmation',FORMAT("DHL Confirmation"),'',XMLChild);
                //XMLDOMMgt.AddElement(XMLNode, 'DHL_Confirmation_Date',FORMAT("DHL Confirmation Date"),'',XMLChild);
                //XMLDOMMgt.AddElement(XMLNode, 'DHL_Confirmation_No.',FORMAT("DHL Confirmation No."),'',XMLChild);
                //XMLDOMMgt.AddElement(XMLNode, 'DHL_Confirmation_Status',FORMAT("DHL Confirmation Status"),'',XMLChild);
                //XMLDOMMgt.AddElement(XMLNode, 'DHL_Posting_Date',FORMAT("DHL Posting Date"),'',XMLChild);
                //XMLDOMMgt.AddElement(XMLNode, 'DHL_Return_reported',FORMAT("DHL Return reported"),'',XMLChild);
                //XMLDOMMgt.AddElement(XMLNode, 'DHL_Return_Reporting_Date',FORMAT("DHL Return Reporting Date"),'',XMLChild);
                //XMLDOMMgt.AddElement(XMLNode, 'DHL_Return_No.',FORMAT("DHL Return No."),'',XMLChild);
                // E/gob-lku/09.07.2013/P1016
                XMLDOMMgt.AddElement(XMLNode, 'DHL_Payment_Method',FORMAT("DHL Payment Method"),'',XMLChild);
                // S/gob-lku/09.07.2013/P1016
                //XMLDOMMgt.AddElement(XMLNode, 'Payment_Reminder_1',FORMAT("1. Payment Reminder"),'',XMLChild);
                //XMLDOMMgt.AddElement(XMLNode, 'Payment_Reminder_Date_1',FORMAT("1. Payment Reminder Date"),'',XMLChild);
                //XMLDOMMgt.AddElement(XMLNode, 'Payment_Reminder_2',FORMAT("2. Payment Reminder"),'',XMLChild);
                //XMLDOMMgt.AddElement(XMLNode, 'Payment_Reminder_Date_2',FORMAT("2. Payment Reminder Date"),'',XMLChild);
                // E/gob-lku/09.07.2013/P1016
                XMLDOMMgt.AddElement(XMLNode, 'Payment_Receipt',FORMAT("Payment Receipt"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Payment_Receipt_Date',FORMAT("Payment Receipt Date"),'',XMLChild);
                // S/gob-lku/09.07.2013/P1016
                //XMLDOMMgt.AddElement(XMLNode, 'Payment_Notification',FORMAT("Payment Notification"),'',XMLChild);
                //XMLDOMMgt.AddElement(XMLNode, 'Payment_Notification_Date',FORMAT("Payment Notification Date"),'',XMLChild);
                //XMLDOMMgt.AddElement(XMLNode, 'Shipment_Notification',FORMAT("Shipment Notification"),'',XMLChild);
                //XMLDOMMgt.AddElement(XMLNode, 'Shipment_Notification_Date',FORMAT("Shipment Notification Date"),'',XMLChild);
                // E/gob-lku/09.07.2013/P1016
                XMLDOMMgt.AddElement(XMLNode, 'Payment_Confirmation_Mail',FORMAT("Payment Confirmation Mail"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Payment_Confirmation_Mailcode',FORMAT("Payment Confirmation Mailcode"),'',XMLChild);
                // S/gob-lku/09.07.2013/P1016
                //XMLDOMMgt.AddElement(XMLNode, 'Value_at_1._Payment_Reminder',FORMAT("Value at 1. Payment Reminder"),'',XMLChild);
                //XMLDOMMgt.AddElement(XMLNode, 'Set_Billed',FORMAT("Set Billed"),'',XMLChild);
                //XMLDOMMgt.AddElement(XMLNode, 'Set_Billed_at',FORMAT("Set Billed at"),'',XMLChild);
                //XMLDOMMgt.AddElement(XMLNode, 'Set_Billed_by',FORMAT("Set Billed by"),'',XMLChild);
                //XMLDOMMgt.AddElement(XMLNode, 'Set_Shipping',FORMAT("Set Shipping"),'',XMLChild);
                //XMLDOMMgt.AddElement(XMLNode, 'Set_Shipping_at',FORMAT("Set Shipping at"),'',XMLChild);
                // E/gob-lku/09.07.2013/P1016
                XMLDOMMgt.AddElement(XMLNode, 'Completed',FORMAT(Completed),'',XMLChild);
                // S/gob-lku/09.07.2013/P1016
                //XMLDOMMgt.AddElement(XMLNode, 'Released_For_Shipment',FORMAT("Released For Shipment"),'',XMLChild);
                //XMLDOMMgt.AddElement(XMLNode, 'Payment_Amount_Currently',FORMAT("Payment Amount Currently"),'',XMLChild);
                //XMLDOMMgt.AddElement(XMLNode, 'NavConnect_Reported',FORMAT("NavConnect Reported"),'',XMLChild);
                //XMLDOMMgt.AddElement(XMLNode, 'NavConnect_Reported_at',FORMAT("NavConnect Reported at"),'',XMLChild);
                //XMLDOMMgt.AddElement(XMLNode, 'NavConnect_Modified_at',FORMAT("NavConnect Modified at"),'',XMLChild);
                //XMLDOMMgt.AddElement(XMLNode, 'Customer_Info_Mail',FORMAT("Customer Info Mail"),'',XMLChild);
                //XMLDOMMgt.AddElement(XMLNode, 'Customer_Info_Date',FORMAT("Customer Info Date"),'',XMLChild);
                // E/gob-lku/09.07.2013/P1016
                XMLDOMMgt.AddElement(XMLNode, 'Bill-to_Cust._Balance_LCY',FORMAT("Bill-to Cust. Balance (LCY)"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Bill-to_Cust._Balance',FORMAT("Bill-to Cust. Balance"),'',XMLChild);
                // S/gob-lku/09.07.2013/P1016
                //XMLDOMMgt.AddElement(XMLNode, 'Marked_For_Update',FORMAT("Marked For Update"),'',XMLChild);
                //XMLDOMMgt.AddElement(XMLNode, 'eBay_Account',FORMAT("eBay Account"),'',XMLChild);
                // E/gob-lku/09.07.2013/P1016
                XMLDOMMgt.AddElement(XMLNode, 'Waiting_for_payment_receipt_At',FORMAT("Waiting for payment receipt At"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Waiting_for_payment_receipt_By',FORMAT("Waiting for payment receipt By"),'',XMLChild);
                // S/gob-lku/09.07.2013/P1016
                //XMLDOMMgt.AddElement(XMLNode, 'Address_Code',FORMAT("Address Code"),'',XMLChild);
                //XMLDOMMgt.AddElement(XMLNode, 'Payment_Reminder_3',FORMAT("3. Payment Reminder"),'',XMLChild);
                //XMLDOMMgt.AddElement(XMLNode, 'Payment_Reminder_Date_3',FORMAT("3. Payment Reminder Date"),'',XMLChild);
                //XMLDOMMgt.AddElement(XMLNode, 'Quote_Reminder_1',FORMAT("1. Quote Reminder"),'',XMLChild);
                //XMLDOMMgt.AddElement(XMLNode, 'Quote_Reminder_Date_1',FORMAT("1. Quote Reminder Date"),'',XMLChild);
                //XMLDOMMgt.AddElement(XMLNode, 'Quote_Reminder_2',FORMAT("2. Quote Reminder"),'',XMLChild);
                //XMLDOMMgt.AddElement(XMLNode, 'Quote_Reminder_Date_2',FORMAT("2. Quote Reminder Date"),'',XMLChild);
                //XMLDOMMgt.AddElement(XMLNode, 'Invoice_Notification',FORMAT("Invoice Notification"),'',XMLChild);
                //XMLDOMMgt.AddElement(XMLNode, 'Invoice_Notification_Date',FORMAT("Invoice Notification Date"),'',XMLChild);
                //XMLDOMMgt.AddElement(XMLNode, 'Shipment_Mail',FORMAT("Shipment Mail"),'',XMLChild);
                //XMLDOMMgt.AddElement(XMLNode, 'Shipment_Mail_Date',FORMAT("Shipment Mail Date"),'',XMLChild);
                //XMLDOMMgt.AddElement(XMLNode, 'Payment_Partner_Type',FORMAT("Payment Partner Type"),'',XMLChild);
                //XMLDOMMgt.AddElement(XMLNode, 'Payment_Partner_Entry_No.',FORMAT("Payment Partner Entry No."),'',XMLChild);
                //XMLDOMMgt.AddElement(XMLNode, 'FBA_Order',FORMAT("FBA Order"),'',XMLChild);
                //XMLDOMMgt.AddElement(XMLNode, 'Fulfillment_Order_No.',FORMAT("Fulfillment Order No."),'',XMLChild);
                // E/gob-lku/09.07.2013/P1016
                XMLDOMMgt.AddElement(XMLNode, 'Date_Received',FORMAT("Date Received"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Time_Received',FORMAT("Time Received"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'BizTalk_Request_for_Sales_Qte.',FORMAT("BizTalk Request for Sales Qte."),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'BizTalk_Sales_Order',FORMAT("BizTalk Sales Order"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Date_Sent',FORMAT("Date Sent"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Time_Sent',FORMAT("Time Sent"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'BizTalk_Sales_Quote',FORMAT("BizTalk Sales Quote"),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'BizTalk_Sales_Order_Cnfmn.',FORMAT("BizTalk Sales Order Cnfmn."),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Customer_Quote_No.',FORMAT("Customer Quote No."),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'Customer_Order_No.',FORMAT("Customer Order No."),'',XMLChild);
                XMLDOMMgt.AddElement(XMLNode, 'BizTalk_Document_Sent',FORMAT("BizTalk Document Sent"),'',XMLChild);

              WITH SOLine DO BEGIN
                SOLine.SETRANGE(SOLine."Document Type",SOLine."Document Type"::Order);
                SOLine.SETRANGE("Document No.",SO."No.");
                IF SOLine.FINDSET THEN REPEAT
                  XMLDOMMgt.AddElement(XMLNode, 'Sales_Order_Line', '','',XMLChild);

                  XMLDOMMgt.AddElement(XMLChild, 'Document_Type',FORMAT("Document Type"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Sell-to_Customer_No.',FORMAT("Sell-to Customer No."),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Document_No.',FORMAT("Document No."),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Line_No.',FORMAT("Line No."),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Type',FORMAT(Type),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'No.',FORMAT("No."),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Location_Code',FORMAT("Location Code"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Posting_Group',FORMAT("Posting Group"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Shipment_Date',FORMAT("Shipment Date"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Description',FORMAT(Description),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Description_2',FORMAT("Description 2"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Unit_of_Measure',FORMAT("Unit of Measure"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Quantity',FORMAT(Quantity),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Outstanding_Quantity',FORMAT("Outstanding Quantity"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Qty._to_Invoice',FORMAT("Qty. to Invoice"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Qty._to_Ship',FORMAT("Qty. to Ship"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Unit_Price',FORMAT("Unit Price"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Unit_Cost_LCY',FORMAT("Unit Cost (LCY)"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'VAT_Per',FORMAT("VAT %"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Line_Discount_Per',FORMAT("Line Discount %"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Line_Discount_Amount',FORMAT("Line Discount Amount"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Amount',FORMAT(Amount),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Amount_Including_VAT',FORMAT("Amount Including VAT"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Allow_Invoice_Disc.',FORMAT("Allow Invoice Disc."),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Gross_Weight',FORMAT("Gross Weight"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Net_Weight',FORMAT("Net Weight"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Units_per_Parcel',FORMAT("Units per Parcel"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Unit_Volume',FORMAT("Unit Volume"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Appl.-to_Item_Entry',FORMAT("Appl.-to Item Entry"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Shortcut_Dimension_1_Code',FORMAT("Shortcut Dimension 1 Code"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Shortcut_Dimension_2_Code',FORMAT("Shortcut Dimension 2 Code"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Customer_Price_Group',FORMAT("Customer Price Group"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Job_No.',FORMAT("Job No."),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Work_Type_Code',FORMAT("Work Type Code"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Outstanding_Amount',FORMAT("Outstanding Amount"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Qty._Shipped_Not_Invoiced',FORMAT("Qty. Shipped Not Invoiced"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Shipped_Not_Invoiced',FORMAT("Shipped Not Invoiced"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Quantity_Shipped',FORMAT("Quantity Shipped"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Quantity_Invoiced',FORMAT("Quantity Invoiced"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Shipment_No.',FORMAT("Shipment No."),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Shipment_Line_No.',FORMAT("Shipment Line No."),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Profit_Per',FORMAT("Profit %"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Bill-to_Customer_No.',FORMAT("Bill-to Customer No."),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Inv._Discount_Amount',FORMAT("Inv. Discount Amount"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Purchase_Order_No.',FORMAT("Purchase Order No."),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Purch._Order_Line_No.',FORMAT("Purch. Order Line No."),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Drop_Shipment',FORMAT("Drop Shipment"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Gen._Bus._Posting_Group',FORMAT("Gen. Bus. Posting Group"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Gen._Prod._Posting_Group',FORMAT("Gen. Prod. Posting Group"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'VAT_Calculation_Type',FORMAT("VAT Calculation Type"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Transaction_Type',FORMAT("Transaction Type"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Transport_Method',FORMAT("Transport Method"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Attached_to_Line_No.',FORMAT("Attached to Line No."),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Exit_Point',FORMAT("Exit Point"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Area',FORMAT(Area),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Transaction_Specification',FORMAT("Transaction Specification"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Tax_Area_Code',FORMAT("Tax Area Code"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Tax_Liable',FORMAT("Tax Liable"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Tax_Group_Code',FORMAT("Tax Group Code"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'VAT_Bus._Posting_Group',FORMAT("VAT Bus. Posting Group"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'VAT_Prod._Posting_Group',FORMAT("VAT Prod. Posting Group"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Currency_Code',FORMAT("Currency Code"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Outstanding_Amount_LCY',FORMAT("Outstanding Amount (LCY)"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Shipped_Not_Invoiced_LCY',FORMAT("Shipped Not Invoiced (LCY)"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Reserved_Quantity',FORMAT("Reserved Quantity"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Reserve',FORMAT(Reserve),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Blanket_Order_No.',FORMAT("Blanket Order No."),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Blanket_Order_Line_No.',FORMAT("Blanket Order Line No."),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'VAT_Base_Amount',FORMAT("VAT Base Amount"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Unit_Cost',FORMAT("Unit Cost"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'System-Created_Entry',FORMAT("System-Created Entry"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Line_Amount',FORMAT("Line Amount"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'VAT_Difference',FORMAT("VAT Difference"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Inv._Disc._Amount_to_Invoice',FORMAT("Inv. Disc. Amount to Invoice"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'VAT_Identifier',FORMAT("VAT Identifier"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'IC_Partner_Ref._Type',FORMAT("IC Partner Ref. Type"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'IC_Partner_Reference',FORMAT("IC Partner Reference"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Prepayment_Per',FORMAT("Prepayment %"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Prepmt._Line_Amount',FORMAT("Prepmt. Line Amount"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Prepmt._Amt._Inv.',FORMAT("Prepmt. Amt. Inv."),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Prepmt._Amt._Incl._VAT',FORMAT("Prepmt. Amt. Incl. VAT"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Prepayment_Amount',FORMAT("Prepayment Amount"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Prepmt._VAT_Base_Amt.',FORMAT("Prepmt. VAT Base Amt."),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Prepayment_VAT_Per',FORMAT("Prepayment VAT %"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Prepmt._VAT_Calc._Type',FORMAT("Prepmt. VAT Calc. Type"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Prepayment_VAT_Identifier',FORMAT("Prepayment VAT Identifier"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Prepayment_Tax_Area_Code',FORMAT("Prepayment Tax Area Code"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Prepayment_Tax_Liable',FORMAT("Prepayment Tax Liable"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Prepayment_Tax_Group_Code',FORMAT("Prepayment Tax Group Code"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Prepmt_Amt_to_Deduct',FORMAT("Prepmt Amt to Deduct"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Prepmt_Amt_Deducted',FORMAT("Prepmt Amt Deducted"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Prepayment_Line',FORMAT("Prepayment Line"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Prepmt._Amount_Inv._Incl._VAT',FORMAT("Prepmt. Amount Inv. Incl. VAT"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Prepmt._Amount_Inv._LCY',FORMAT("Prepmt. Amount Inv. (LCY)"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'IC_Partner_Code',FORMAT("IC Partner Code"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Prepayment_VAT_Difference',FORMAT("Prepayment VAT Difference"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Prepmt_VAT_Diff._to_Deduct',FORMAT("Prepmt VAT Diff. to Deduct"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Prepmt_VAT_Diff._Deducted',FORMAT("Prepmt VAT Diff. Deducted"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Job_Task_No.',FORMAT("Job Task No."),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Job_Contract_Entry_No.',FORMAT("Job Contract Entry No."),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Variant_Code',FORMAT("Variant Code"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Bin_Code',FORMAT("Bin Code"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Qty._per_Unit_of_Measure',FORMAT("Qty. per Unit of Measure"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Planned',FORMAT(Planned),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Unit_of_Measure_Code',FORMAT("Unit of Measure Code"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Quantity_Base',FORMAT("Quantity (Base)"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Outstanding_Qty._Base',FORMAT("Outstanding Qty. (Base)"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Qty._to_Invoice_Base',FORMAT("Qty. to Invoice (Base)"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Qty._to_Ship_Base',FORMAT("Qty. to Ship (Base)"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Qty._Shipped_Not_Invd._Base',FORMAT("Qty. Shipped Not Invd. (Base)"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Qty._Shipped_Base',FORMAT("Qty. Shipped (Base)"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Qty._Invoiced_Base',FORMAT("Qty. Invoiced (Base)"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Reserved_Qty._Base',FORMAT("Reserved Qty. (Base)"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'FA_Posting_Date',FORMAT("FA Posting Date"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Depreciation_Book_Code',FORMAT("Depreciation Book Code"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Depr._until_FA_Posting_Date',FORMAT("Depr. until FA Posting Date"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Duplicate_in_Depreciation_Book',FORMAT("Duplicate in Depreciation Book"),'',XMLChild1)
      ;
                  XMLDOMMgt.AddElement(XMLChild, 'Use_Duplication_List',FORMAT("Use Duplication List"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Responsibility_Center',FORMAT("Responsibility Center"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Out-of-Stock_Substitution',FORMAT("Out-of-Stock Substitution"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Substitution_Available',FORMAT("Substitution Available"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Originally_Ordered_No.',FORMAT("Originally Ordered No."),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Originally_Ordered_Var._Code',FORMAT("Originally Ordered Var. Code"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Cross-Reference_No.',FORMAT("Cross-Reference No."),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Unit_of_Measure_Cross_Ref.',FORMAT("Unit of Measure (Cross Ref.)"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Cross-Reference_Type',FORMAT("Cross-Reference Type"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Cross-Reference_Type_No.',FORMAT("Cross-Reference Type No."),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Item_Category_Code',FORMAT("Item Category Code"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Nonstock',FORMAT(Nonstock),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Purchasing_Code',FORMAT("Purchasing Code"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Product_Group_Code',FORMAT("Product Group Code"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Special_Order',FORMAT("Special Order"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Special_Order_Purchase_No.',FORMAT("Special Order Purchase No."),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Special_Order_Purch._Line_No.',FORMAT("Special Order Purch. Line No."),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Whse._Outstanding_Qty._Base',FORMAT("Whse. Outstanding Qty. (Base)"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Completely_Shipped',FORMAT("Completely Shipped"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Requested_Delivery_Date',FORMAT("Requested Delivery Date"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Promised_Delivery_Date',FORMAT("Promised Delivery Date"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Shipping_Time',FORMAT("Shipping Time"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Outbound_Whse._Handling_Time',FORMAT("Outbound Whse. Handling Time"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Planned_Delivery_Date',FORMAT("Planned Delivery Date"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Planned_Shipment_Date',FORMAT("Planned Shipment Date"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Shipping_Agent_Code',FORMAT("Shipping Agent Code"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Shipping_Agent_Service_Code',FORMAT("Shipping Agent Service Code"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Allow_Item_Charge_Assignment',FORMAT("Allow Item Charge Assignment"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Qty._to_Assign',FORMAT("Qty. to Assign"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Qty._Assigned',FORMAT("Qty. Assigned"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Return_Qty._to_Receive',FORMAT("Return Qty. to Receive"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Return_Qty._to_Receive_Base',FORMAT("Return Qty. to Receive (Base)"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Return_Qty._Rcd._Not_Invd.',FORMAT("Return Qty. Rcd. Not Invd."),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Ret._Qty._Rcd._Not_Invd.Base',FORMAT("Ret. Qty. Rcd. Not Invd.(Base)"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Return_Rcd._Not_Invd.',FORMAT("Return Rcd. Not Invd."),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Return_Rcd._Not_Invd._LCY',FORMAT("Return Rcd. Not Invd. (LCY)"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Return_Qty._Received',FORMAT("Return Qty. Received"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Return_Qty._Received_Base',FORMAT("Return Qty. Received (Base)"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Appl.-from_Item_Entry',FORMAT("Appl.-from Item Entry"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'BOM_Item_No.',FORMAT("BOM Item No."),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Return_Receipt_No.',FORMAT("Return Receipt No."),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Return_Receipt_Line_No.',FORMAT("Return Receipt Line No."),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Return_Reason_Code',FORMAT("Return Reason Code"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Allow_Line_Disc.',FORMAT("Allow Line Disc."),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Customer_Disc._Group',FORMAT("Customer Disc. Group"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Line_Status',FORMAT("Line Status"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Seq._No.',FORMAT("Seq. No."),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Vendor_No.',FORMAT("Vendor No."),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Vendor_Order_Date',FORMAT("Vendor Order Date"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Dropship_No.',FORMAT("Dropship No."),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Manufacturer_Item_No.',FORMAT("Manufacturer Item No."),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Dropship_Date',FORMAT("Dropship Date"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Item_Vendor_No.',FORMAT("Item Vendor No."),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Item_Vendor_Name',FORMAT("Item Vendor Name"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Shipment_Date_Exp._Real.',FORMAT("Shipment Date (Exp./Real.)"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Delivery_Confirmation',FORMAT("Delivery Confirmation"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Shipping_Source',FORMAT("Shipping Source"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Shipping_Type',FORMAT("Shipping Type"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'DHL_Shipment_Number',FORMAT("DHL Shipment Number"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Status_Event_Code',FORMAT("Status Event Code"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Status_Code',FORMAT("Status Code"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'DHL_Shipment_date',FORMAT("DHL Shipment date"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Resource_Type',FORMAT("Resource Type"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Delivery_Type',FORMAT("Delivery Type"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Cancellation_Date',FORMAT("Cancellation Date"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Cancellation_Qty.',FORMAT("Cancellation Qty."),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Cancellation_Reason_Code',FORMAT("Cancellation Reason Code"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Show_Cancellation_Reason',FORMAT("Show Cancellation Reason"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Qty._to_Cancel',FORMAT("Qty. to Cancel"),'',XMLChild1);
                  //H4306  01.06.15  MBY  +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
                  //XMLDOMMgt.AddElement(XMLChild, 'Discount_Reason_Code',FORMAT("Discount Reason Code"),'',XMLChild1);
                  //XMLDOMMgt.AddElement(XMLChild, 'Show_Discount_Reason',FORMAT("Show Discount Reason"),'',XMLChild1);
                  //H4306  01.06.15  MBY  -------------------------------------------------------------------------
                  XMLDOMMgt.AddElement(XMLChild, 'Created_At',FORMAT("Created At"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Modified_At',FORMAT("Modified At"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Show_Order_Date',FORMAT("Show Order Date"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Show_Vendor_Name',FORMAT("Show Vendor Name"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Customer_Line_Reference',FORMAT("Customer Line Reference"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Processing_of_order_account',FORMAT("Processing of order account"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'DHL_reported',FORMAT("DHL reported"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'DHL_Reporting_Date',FORMAT("DHL Reporting Date"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'DHL_Reporting_No.',FORMAT("DHL Reporting No."),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'DHL_Confirmation',FORMAT("DHL Confirmation"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'DHL_Confirmation_Date',FORMAT("DHL Confirmation Date"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'DHL_Confirmation_No.',FORMAT("DHL Confirmation No."),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'DHL_Position_No.',FORMAT("DHL Position No."),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'DHL_Confirmation_Status',FORMAT("DHL Confirmation Status"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'DHL_Posting_Date',FORMAT("DHL Posting Date"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'DHL_Logistical_Problem',FORMAT("DHL Logistical Problem"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'DHL_Return_reported',FORMAT("DHL Return reported"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'DHL_Return_Reporting_Date',FORMAT("DHL Return Reporting Date"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'DHL_Return_No.',FORMAT("DHL Return No."),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'DHL_Return_Cause',FORMAT("DHL Return Cause"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'DHL_Return_Stock_Status',FORMAT("DHL Return Stock Status"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Price_to_adjust',FORMAT("Price to adjust"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Shipping_Charges_to_be_paid',FORMAT("Shipping Charges to be paid"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Shipping_and_Handling_Charges',FORMAT("Shipping and Handling Charges"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Packing_Costs',FORMAT("Packing Costs"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'End_Customer_Unit_Price',FORMAT("End Customer Unit Price"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Account_Code',FORMAT("Account Code"),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Amazon_Order_No.',FORMAT("Amazon Order No."),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Amazon_Order_Item_No.',FORMAT("Amazon Order Item No."),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Payment_Transaction_No.',FORMAT("Payment Transaction No."),'',XMLChild1);
                  XMLDOMMgt.AddElement(XMLChild, 'Purchasing_Status',FORMAT("Purchasing Status"),'',XMLChild1);


                UNTIL SOLine.NEXT = 0;
              END;

        END;
      EXIT(TRUE);
    END;

    LOCAL PROCEDURE GetNode@1000000010(VAR ParentNode@1000000000 : Automation "{F5078F18-C551-11D3-89B9-0000F81FE221} 6.0:{2933BF80-7B36-11D2-B20E-00C04F983E60}:'Microsoft XML, v6.0'.IXMLDOMNode";VAR ChildNode@1000000001 : Automation "{F5078F18-C551-11D3-89B9-0000F81FE221} 6.0:{2933BF80-7B36-11D2-B20E-00C04F983E60}:'Microsoft XML, v6.0'.IXMLDOMNode";ChildNodeName@1000000002 : Text[50];CheckEmptyValue@1000000003 : Boolean) : Boolean;
    BEGIN
      ChildNode := ParentNode.selectSingleNode(ChildNodeName);
      IF ISCLEAR(ChildNode) THEN BEGIN
        //MESSAGE(XMLNode.nodeName);          cr
        //GenerateError(STRSUBSTNO(Text003,ImportFileName));
        EXIT(FALSE);
      END;
      IF CheckEmptyValue AND (ChildNode.text = '') THEN EXIT(FALSE);
      EXIT(TRUE);
    END;

    LOCAL PROCEDURE FormatBooleanOut@1000000019(BoolVal@1000000000 : Boolean) : Text[30];
    BEGIN
      IF BoolVal THEN EXIT('true');
      EXIT('false');
    END;

    LOCAL PROCEDURE Ansi2Ascii@10(_String@1150001 : Text[250]) _Output@1150000 : Text[250];
    BEGIN
      // Converts from ANSI to ASCII
      EXIT(CONVERTSTR(_String,'',
                              ''));
    END;

    LOCAL PROCEDURE Ascii2Ansi@1150001(_String@1150001 : Text[1024]) @1150000 : Text[1024];
    BEGIN
      // Converts from ASCII to ANSI
      EXIT(CONVERTSTR(_String,'',
                              ''));
    END;

    PROCEDURE UpdatePO@1000000002(POXML@1000000000 : BigText) : Boolean;
    VAR
      PO@1000000003 : Record 38;
      POLine@1000000002 : Record 39;
      DHL@1000000001 : Record 50021;
      i@1000000004 : Integer;
      LineNo@1000000005 : Integer;
      decVar@1000000006 : Decimal;
      dateVar@1000000007 : Date;
      InStream@1000000010 : InStream;
      OutStream@1000000009 : OutStream;
      tempBlob@1000000008 : Record 99008535;
    BEGIN
      tempBlob.INIT;
      tempBlob."Primay Key" := 1;
      tempBlob.Blob.CREATEOUTSTREAM(OutStream);
      tempBlob.Blob.CREATEINSTREAM(InStream);
      POXML.WRITE(OutStream);
      IF ISCLEAR(XMLDom) THEN
        CREATE(XMLDom);
      IF NOT XMLDom.load(InStream) THEN EXIT(FALSE);


      XMLRoot := XMLDom.documentElement;

      XMLNode := XMLRoot; //!!!
      WITH PO DO BEGIN
        IF GetNode(XMLNode,XMLChild,'No.',TRUE) THEN
          IF PO.GET(PO."Document Type"::Order,XMLChild.text) THEN BEGIN
            POLine.SETRANGE("Document Type",POLine."Document Type"::Order);
            POLine.SETRANGE("Document No.",PO."No.");
            IF POLine.FINDLAST THEN LineNo := POLine."Line No."
            ELSE LineNo := 0;

            IF GetNode(XMLNode,XMLChild,'Promised_Receipt_Date',TRUE) THEN BEGIN
              IF EVALUATE(dateVar,XMLChild.text) THEN BEGIN
                PO.VALIDATE("Promised Receipt Date",dateVar);
                PO.MODIFY(TRUE);
              END;
            END;


            XMLNodeList := XMLNode.childNodes;
            i := 1;

            WHILE (i <= XMLNodeList.length) DO BEGIN
              XMLNode := XMLNodeList.nextNode;
              CASE XMLNode.nodeName OF
                'Purchase_Order_Line' : BEGIN
                  WITH POLine DO BEGIN
                    IF GetNode(XMLNode,XMLChild,'No.',TRUE) THEN BEGIN
                      POLine.SETRANGE(Type,POLine.Type::Item);
                      POLine.SETRANGE("No.",XMLChild.text);
                      IF NOT POLine.FINDFIRST THEN BEGIN
                        POLine.INIT;
                        POLine."Document Type" := POLine."Document Type"::Order;
                        POLine."Document No." := PO."No.";
                        POLine.VALIDATE(Type,POLine.Type::Item);
                        POLine."Line No." := LineNo;
                        LineNo := LineNo + 10000;
                        POLine.VALIDATE("No.",XMLChild.text);
                        POLine.INSERT(TRUE);
                      END;

                      IF GetNode(XMLNode,XMLChild,'Quantity',TRUE) THEN BEGIN
                        IF EVALUATE(decVar,XMLChild.text) THEN
                          VALIDATE(Quantity,decVar);
                      END;
                      IF NOT INSERT THEN MODIFY;
                    END;
                  END; //with
                END;  //line
              END; //case
              i := i + 1;
            END;    // while
          END;
      END;  //with
    END;

    PROCEDURE UpdatePOHeader@1000000003(PONo@1000000001 : Code[20];PromisedDeliveryDate@1000000000 : Date);
    VAR
      PO@1000000004 : Record 38;
      POLine@1000000003 : Record 39;
      DHL@1000000002 : Record 50021;
    BEGIN
      IF PO.GET(PONo) THEN BEGIN
        PO."Promised Receipt Date" := PromisedDeliveryDate;
        PO.MODIFY;
      END;
    END;

    PROCEDURE UpdatePOLine@1000000004(PONo@1000000004 : Code[20];ItemNo@1000000003 : Code[20];Qty@1000000005 : Decimal);
    VAR
      PO@1000000002 : Record 38;
      POLine@1000000001 : Record 39;
      DHL@1000000000 : Record 50021;
      LineNo@1000000006 : Integer;
    BEGIN
      POLine.SETRANGE("Document Type",POLine."Document Type"::Order);
      POLine.SETRANGE("Document No.",PONo);
      IF POLine.FINDLAST THEN LineNo := POLine."Line No."
      ELSE LineNo := 0;

      POLine.SETRANGE(Type,POLine.Type::Item);
      POLine.SETRANGE("No.",ItemNo);
      IF POLine.FINDFIRST THEN BEGIN
        POLine.Quantity := Qty;
        POLine.MODIFY;
      END ELSE BEGIN
        POLine.INIT;
        POLine."Document Type" := POLine."Document Type"::Order;
        POLine."Document No." := PONo;
        POLine.VALIDATE(Type,POLine.Type::Item);
        POLine."Line No." := LineNo;
        POLine.VALIDATE("No.",ItemNo);
        POLine.VALIDATE(Quantity,Qty);
        POLine.INSERT(TRUE);
      END;
    END;

    EVENT XMLDomIn@1000000007::ondataavailable@198();
    BEGIN
    END;

    EVENT XMLDomIn@1000000007::onreadystatechange@-609();
    BEGIN
    END;

    EVENT XMLDom@1000000008::ondataavailable@198();
    BEGIN
    END;

    EVENT XMLDom@1000000008::onreadystatechange@-609();
    BEGIN
    END;

    BEGIN
    {
      +--------------------------------------------------+
      |                     Copyright                   |
      |       GOB Software & Systeme GmbH & Co. KG       |
      +--------------------------------------------------+
      |                     home24 GmbH                  |
      +--------------------------------------------------+

      Version   Date      Consultant  Comment
      ____________________________________________________________________________________________________________________________________
      P1016     09.07.13  gob-lku     Deactivation of unused eBay fields


      +--------------------------------------------+
      |                                            |
      |                  Home24                    |
      |       Internal Customizing by NAV-Team     |
      |                                            |
      +--------------------------------------------+

      Project No. Date     Shortcut  Description
      _____________________________________________
      H4306       01.06.15 MBY       Solve all compilation errors in NAV2009
    }
    END.
  }
}

