OBJECT Codeunit 50052 DD Interface Inbound
{
  OBJECT-PROPERTIES
  {
    Date=12.11.14;
    Time=12:00:00;
    Modified=Yes;
    Version List=DD1.05,GOB,HME1726;
  }
  PROPERTIES
  {
    TableNo=472;
    OnRun=BEGIN
            //IF GUIALLOWED THEN
            //  IF CONFIRM('startinbound',TRUE) THEN;

            StartInbound;
          END;

  }
  CODE
  {
    VAR
      SalesSetup@1003 : Record 311;
      Error000@1004 : TextConst 'DEU=MARC Interface Error 1000: Folder %1 not found.;ENU=MARC Interface Error : Folder %1 not found.';
      DDSetup@1000000005 : Record 50060;
      TempDDHeader@1039 : TEMPORARY Record 50061;
      TempDDLine@1040 : TEMPORARY Record 50062;
      FlatFileArr@1001 : ARRAY [1000] OF Text[1024];
      Result@1002 : Variant;
      FileIn@1005 : Record 2000000022;
      FileROP@1000000008 : Record 2000000022;
      FileEXP@1000000009 : Record 2000000022;
      f@1006 : File;
      Loop@1008 : Integer;
      Data@1009 : Text[1024];
      Error001@1010 : TextConst 'DEU=MARC Interface Error 1001: Filename longer then 1024 characters.;ENU=MARC Interface Error : Filename longer then 1024 characters.';
      ArrayOfFields@1011 : ARRAY [250] OF Text[260];
      Error002@1012 : TextConst 'DEU=MARC Interface Error 1002: Unexpected Value for Field %2 in File %1. Line [%3];ENU="MARC Interface Error : Unexpected Value for Field %2 in File %1. "';
      Filler@1013 : Char;
      ArrayOfErrorVar@1014 : ARRAY [100] OF Text[1024];
      FileCounter@1007 : Integer;
      Error003@1015 : TextConst 'DEU=MARC Interface Error 1003: Numeric Value expected in Field %2 in File %1. Line [%3];ENU="MARC Interface Error : Numeric Value expected in Field %2 in File %1. "';
      Error004@1016 : TextConst 'DEU=MARC Interface Error 1004: Date Value expected in Field %2 in File %1. Line [%3];ENU="MARC Interface Error : Date Value expected in Field %2 in File %1. "';
      Error005@1017 : TextConst 'DEU=MARC Interface Error 1005: Time Value expected in Field %2 in File %1. Line [%3];ENU="MARC Interface Error : Time Value expected in Field %2 in File %1. "';
      FileOut@1018 : Record 2000000022;
      Error006@1019 : TextConst 'DEU=MARC Interface Error 1006: No Header Sequenz found  in File %1.';
      Error007@1020 : TextConst 'DEU=MARC Interface Error 1007: No Trailer Sequenz found  in File %1.';
      LineCounter@1021 : Integer;
      Error008@1023 : TextConst 'DEU=MARC Interface Error 1008: Record Reference  required in %1  %2  %3  %4;ENU=MARC Interface Error : Record Reference  required in %1  %2  %3  %4';
      Error009@1022 : TextConst 'DEU=MARC Interface Error 1009: Field Reference  required in %1  %2  %3  %4;ENU=MARC Interface Error : Field Reference  required in %1  %2  %3  %4';
      HeaderEntryNo@1024 : Integer;
      HeaderError@1035 : Integer;
      LineError@1037 : Integer;
      FileError@1000 : Integer;
      OrderNo@1025 : Code[10];
      GlobalRecRef@1026 : RecordRef;
      TempPath@1027 : Text[1024];
      TransNo@1028 : Code[20];
      Error010@1029 : TextConst 'DEU=MARC Interface Error 1010: Transmission No. requiered in File %1.';
      Error011@1030 : TextConst 'DEU=MARC Interface Error 1011:  No clearly allocation possible for %1 %2 %3.';
      Error012@1031 : TextConst 'DEU=MARC Interface Error 1012:  No applied %1-Record for %2 %3 %4.';
      Error013@1032 : TextConst 'DEU=MARC Interface Error 1013:  Unknown Item No. in File %1. Line [%2].';
      Error014@1036 : TextConst 'DEU=MARC Interface Error 1014:  Error in Header %1 %2.';
      Error015@1038 : TextConst 'DEU=MARC Interface Error 1015:  Error in some Line of Order %1.';
      Error016@1045 : TextConst 'DEU=MARC Interface Error 1016: The environment variable %1 is not defined.;ENU=MARC Interface Error : The environment variable %1 is not defined.';
      Error017@1000000000 : TextConst 'DEU=%1 darf nicht "%2" in %3 %4 %5 %6 %7.;ENU=%1 should no be "%2" in %3 %4 %5 %6 %7.';
      Error018@1000000003 : TextConst 'ENU=MARC Interface Error 1018:  Packing Line cannot be inserted';
      Text000@1033 : TextConst 'DEU=&orc,&wac,&ccc,&rcc;ENU=&Ship,&Invoice,Ship &and Invoice';
      Selection@1034 : Integer;
      NO_HDR_RECORDS@1044 : Integer;
      NO_DETAIL_RECORDS@1043 : Integer;
      NO_DETAIL_RECORDS_IN_FILE@1042 : Integer;
      NO_LINE_ITEMS@1041 : Integer;
      TRANSACTION_ID@1046 : Code[20];
      WshFileSystem@1000000007 : Automation "{F935DC20-1CF0-11D0-ADB9-00C04FD58A0B} 1.0:{0D43FE01-F093-11CF-8940-00A0C9054228}:'Windows Script Host Object Model'.FileSystemObject";
      WshFolder@1000000006 : Automation "{F935DC20-1CF0-11D0-ADB9-00C04FD58A0B} 1.0:{C7C3F5B3-88A3-11D0-ABCB-00A0C90FFFC0}:'Windows Script Host Object Model'.Folder";
      Error019@1000000004 : TextConst 'ENU=No corresponding MarcLineOut found!';
      GlobalJobQueueEntry@1115500000 : Record 472;
      Msg@1115500001 : Text[50];
      OldDocNo@1000000001 : Code[20];
      DDLog@1000000002 : Record 50066;
      OrderStatusLog@1000000010 : Record 50069;
      OrderLogText@1000000011 : Text[50];
      HeaderEntryNo2@1000000012 : Integer;
      CUParcelStatusHistoryMgmt@1000000013 : Codeunit 80011;
      FPCGeneralSetup@1000000014 : Record 50055;
      SuppressMessage@1000000015 : Boolean;

    PROCEDURE StartInbound@1115500001();
    BEGIN

      InitInterface;
      Interface;
      EndInterface;
    END;

    PROCEDURE InitInterface@18();
    BEGIN
      //CLEARALL;
      DDSetup.GET;
      DDSetup.TESTFIELD("Interface Folder (In)");
      FTPDownload;

      //Filler := 32;

      //Sales Order Import Result (15)
      FileROP.RESET;
      FileROP.SETRANGE(Path,DDSetup."Interface Folder (In)");
      FileROP.SETFILTER(Name,'%1','15*');
      IF FileROP.FIND('-') THEN BEGIN
        REPEAT
            FileCounter += 1;
            FlatFileArr[FileCounter] := FileROP.Name;
        UNTIL (FileROP.NEXT = 0) OR (FileCounter = ARRAYLEN(FlatFileArr));
      END;

      //Purchase Order Import Result (30)
      FileROP.RESET;
      FileROP.SETRANGE(Path,DDSetup."Interface Folder (In)");
      FileROP.SETFILTER(Name,'%1','30*');
      IF FileROP.FIND('-') THEN BEGIN
        REPEAT
            FileCounter += 1;
            FlatFileArr[FileCounter] := FileROP.Name;
        UNTIL (FileROP.NEXT = 0) OR (FileCounter = ARRAYLEN(FlatFileArr));
      END;

      //Supplier Import Result (71)
      FileROP.RESET;
      FileROP.SETRANGE(Path,DDSetup."Interface Folder (In)");
      FileROP.SETFILTER(Name,'%1','71*');
      IF FileROP.FIND('-') THEN BEGIN
        REPEAT
            FileCounter += 1;
            FlatFileArr[FileCounter] := FileROP.Name;
        UNTIL (FileROP.NEXT = 0) OR (FileCounter = ARRAYLEN(FlatFileArr));
      END;


      //Sales Order Status Change (17)
      FileROP.RESET;
      FileROP.SETRANGE(Path,DDSetup."Interface Folder (In)");
      FileROP.SETFILTER(Name,'%1','17*');
      IF FileROP.FIND('-') THEN BEGIN
        REPEAT
            FileCounter += 1;
            FlatFileArr[FileCounter] := FileROP.Name;
        UNTIL (FileROP.NEXT = 0) OR (FileCounter = ARRAYLEN(FlatFileArr));
      END;

      //Shipment Confirmation (13)
      FileROP.RESET;
      FileROP.SETRANGE(Path,DDSetup."Interface Folder (In)");
      FileROP.SETFILTER(Name,'%1','13*');
      IF FileROP.FIND('-') THEN BEGIN
        REPEAT
            FileCounter += 1;
            FlatFileArr[FileCounter] := FileROP.Name;
        UNTIL (FileROP.NEXT = 0) OR (FileCounter = ARRAYLEN(FlatFileArr));
      END;

      //Manifest Shipping Confirmation (18)
      FileROP.RESET;
      FileROP.SETRANGE(Path,DDSetup."Interface Folder (In)");
      FileROP.SETFILTER(Name,'%1','18*');
      IF FileROP.FIND('-') THEN BEGIN
        REPEAT
            FileCounter += 1;
            FlatFileArr[FileCounter] := FileROP.Name;
        UNTIL (FileROP.NEXT = 0) OR (FileCounter = ARRAYLEN(FlatFileArr));
      END;

      //Customer Return (14)
      FileROP.RESET;
      FileROP.SETRANGE(Path,DDSetup."Interface Folder (In)");
      FileROP.SETFILTER(Name,'%1','14*');
      IF FileROP.FIND('-') THEN BEGIN
        REPEAT
            FileCounter += 1;
            FlatFileArr[FileCounter] := FileROP.Name;
        UNTIL (FileROP.NEXT = 0) OR (FileCounter = ARRAYLEN(FlatFileArr));
      END;

      //Stock Mutation (20)
      FileROP.RESET;
      FileROP.SETRANGE(Path,DDSetup."Interface Folder (In)");
      FileROP.SETFILTER(Name,'%1','20*');
      IF FileROP.FIND('-') THEN BEGIN
        REPEAT
            FileCounter += 1;
            FlatFileArr[FileCounter] := FileROP.Name;
        UNTIL (FileROP.NEXT = 0) OR (FileCounter = ARRAYLEN(FlatFileArr));
      END;

      //CYCC (11)
      FileIn.RESET;
      FileIn.SETRANGE(Path,DDSetup."Interface Folder (In)");
      FileIn.SETFILTER(Name,'%1','11*');  //CYCC
      IF FileIn.FIND('-') THEN BEGIN
        //H0594  02.10.13  ABR  ++++++++++++++++++++++++++++++++++++
        IF DDSetup."Import Inventory File" THEN
        //H0594  02.10.13  ABR  ------------------------------------
        InitSKU;
        REPEAT
            //H0594  02.10.13  ABR  ++++++++++++++++++++++++++++++++++++
            IF NOT DDSetup."Import Inventory File" THEN BEGIN
              CreateBackupFile(FileIn.Name,FALSE);
              DeleteFile(DDSetup."Interface Folder (In)" + '\' + FileIn.Name);
            END ELSE BEGIN
            //H0594  02.10.13  ABR  ------------------------------------
            FileCounter += 1;
            FlatFileArr[FileCounter] := FileIn.Name;
            //H0594  02.10.13  ABR  ++++++++++++++++++++++++++++++++++++
            END;
            //H0594  02.10.13  ABR  ------------------------------------
        UNTIL (FileIn.NEXT = 0) OR (FileCounter = ARRAYLEN(FlatFileArr));
      END;

      //Article Import Result (16)
      FileROP.RESET;
      FileROP.SETRANGE(Path,DDSetup."Interface Folder (In)");
      FileROP.SETFILTER(Name,'%1','16*');
      IF FileROP.FIND('-') THEN BEGIN
        REPEAT
            FileCounter += 1;
            FlatFileArr[FileCounter] := FileROP.Name;
        UNTIL (FileROP.NEXT = 0) OR (FileCounter = ARRAYLEN(FlatFileArr));
      END;
    END;

    PROCEDURE Interface@1();
    BEGIN
      IF NOT CHECKFFLEXISTS THEN
        EXIT;
      FOR Loop := 1 TO FileCounter DO BEGIN

        IF (ReadFileHeader (FlatFileArr[Loop])) THEN
          ReadTransmission(FlatFileArr[Loop]);
        DDLog.InsertLog(0,0,0,'FTP',STRSUBSTNO('Read file: %1',FlatFileArr[Loop]));

      END;
    END;

    PROCEDURE EndInterface@24();
    BEGIN
      FOR Loop := 1 TO FileCounter DO BEGIN
        CreateBackupFile(FlatFileArr[Loop],FALSE);
        DeleteFile(DDSetup."Interface Folder (In)" + '\' + FlatFileArr[Loop]);
      END;

      CLEARALL;
    END;

    PROCEDURE ReadFileHeader@10(Ffl@1000 : Text[1024]) : Boolean;
    VAR
      TRNHError@1001 : Boolean;
    BEGIN
      //PO460/gob-sfe/18.10.12
      //TransNo := COPYSTR(Ffl,7,STRLEN(Ffl)-10);   //Date+Time
      //TransNo := COPYSTR(Ffl,1,STRPOS(Ffl,'.')-1);
      TransNo := COPYSTR(Ffl,3,STRPOS(Ffl,'.')-3); //P0647
      //P0460/gob-sfe/18.10.12
      EXIT( (STRLEN(TransNo)<>0) );
    END;

    PROCEDURE ReadTransmission@5(File@1005 : Text[1024]);
    VAR
      DDHeader@1006 : Record 50061;
      DDHeader2@1012 : Record 50061;
      DDLine@1007 : Record 50062;
      DDLine2@1013 : Record 50062;
      DDItem@1015 : Record 50059;
      DDItem2@1016 : Record 50059;
      DDSupplier@1000000006 : Record 50064;
      DDSupplier2@1000000007 : Record 50064;
      DDDataElement@1008 : Record 50058;
      fIn@1004 : File;
      fOut@1003 : File;
      Text@1002 : Text[1024];
      Pointer@1001 : Integer;
      LineNo@1000 : Integer;
      RecRef@1010 : RecordRef;
      FldRef@1009 : FieldRef;
      RecordView@1011 : Text[250];
      FldRef2@1014 : FieldRef;
      ConfirmedInventory@1017 : Decimal;
      TransDate@1000000000 : Date;
      TransTime@1000000001 : Time;
      cuPostCYCC@1000000002 : Codeunit 50057;
      window@1000000003 : Dialog;
      MarcHeaderORDC@1000000004 : Record 50061;
      SperrStatus@1000000005 : Integer;
    BEGIN
      //MESSAGE('read file: %1',File);

      LineCounter := 0;
      OldDocNo:='';
      HeaderEntryNo:=0;

      IF GUIALLOWED THEN window.OPEN('Import Line :#1#####');

      fIn.TEXTMODE(TRUE);
      fIn.OPEN(SETFILENAME(File));
      REPEAT
        LineCounter += 1;
        IF GUIALLOWED THEN window.UPDATE(1,FORMAT(LineCounter));
        fIn.READ(Text);
        CASE GETFILETYPE(File) OF

          '17':// Sales Order Status Change
            BEGIN
              IF HeaderEntryNo=0 THEN BEGIN
                DDHeader.INIT;
                DDHeader."Entry No." := GETORDHENTRYNO;
                HeaderEntryNo := DDHeader."Entry No.";
                DDHeader."Document Entry Type" := DDHeader."Document Entry Type"::Sales;
                DDHeader."Document Type" := DDHeader."Document Type"::Order;
                DDHeader.Direction := DDHeader.Direction::"in";
                DDHeader."DD Status":=DDHeader."DD Status"::"status change";
                DDHeader."Entry Date" := WORKDATE;
                DDHeader."File Name" := FlatFileArr[Loop];
                DDHeader."File Position"  := LineCounter;
                DDHeader."Record ID" := '17';
                DDHeader."Trans. No." := TransNo;
                DDHeader."Entry Time" := TIME;
                SetTransDateTimeHeader(DDHeader,TransDate,TransTime);
                DDHeader."Trans. Date" := TransDate;
                DDHeader."Trans. Time" := TransTime;
                DDHeader.INSERT;
              END;

                DDLine.INIT;
                DDLine."Entry No." := GETORDLENTRYNO;
                DDLine."Document Entry Type" := DDLine."Document Entry Type"::Sales;
                DDLine."Header Entry No." := HeaderEntryNo;
                DDLine."Document Type" := DDLine."Document Type"::Order;
                DDLine.Type := DDLine.Type::Item;
                DDLine."DD Status":=DDLine."DD Status"::"status change";
                DDLine.Direction := DDLine.Direction::"in";
                DDLine."Entry Date" := WORKDATE;
                DDLine."File Name" := FlatFileArr[Loop];
                DDLine."File Position"  := LineCounter;
                DDLine."Record ID" := '17';
                DDLine."Trans. No." := TransNo;
                DDLine."Entry Time" := TIME;
                SetTransDateTimeLine(DDLine,TransDate,TransTime);
                DDLine."Trans. Date" := TransDate;
                DDLine."Trans. Time" := TransTime;

                IF DDLine.INSERT THEN;


                DDLine2.RESET;
                DDLine2.SETRANGE("Entry No.",DDLine."Entry No.");
                RecordView := DDLine2.GETVIEW;
                GlobalRecRef.CLOSE;
                GlobalRecRef.OPEN(DATABASE::"DD Line");
                GlobalRecRef.SETVIEW(RecordView);
                IF GlobalRecRef.FIND('-') THEN;

                CheckTransmission(Text,GETFILETYPE(File));
                InsertRecordFromGlobalRecRef
                  (DDDataElement."Table ID"::"17",DATABASE::"DD Line",RecordView);

                SetOrderStatusChange;

            END;

          '15':// Sales Order Import Result
            BEGIN
              {
              IF HeaderEntryNo=0 THEN BEGIN
                DDHeader.INIT;
                DDHeader."Entry No." := GETORDHENTRYNO;
                HeaderEntryNo := DDHeader."Entry No.";
                DDHeader."Document Entry Type" := DDHeader."Document Entry Type"::Sales;
                DDHeader."Document Type" := DDHeader."Document Type"::Order;
                DDHeader.Direction := DDHeader.Direction::"in";
                DDHeader."DD Status":=DDHeader."DD Status"::transmitted;
                DDHeader."Entry Date" := WORKDATE;
                DDHeader."File Name" := FlatFileArr[Loop];
                DDHeader."File Position"  := LineCounter;
                DDHeader."Record ID" := '15';
                DDHeader."Trans. No." := TransNo;
                DDHeader."Entry Time" := TIME;
                SetTransDateTimeHeader(DDHeader,TransDate,TransTime);
                DDHeader."Trans. Date" := TransDate;
                DDHeader."Trans. Time" := TransTime;
                DDHeader.INSERT;
              END ELSE BEGIN
              }
                DDLine.INIT;
                DDLine."Entry No." := GETORDLENTRYNO;
                DDLine."Document Entry Type" := DDLine."Document Entry Type"::Sales;
                DDLine."Header Entry No." := HeaderEntryNo2;
                DDLine."Document Type" := DDLine."Document Type"::Order;
                DDLine.Type := DDLine.Type::Item;
                DDLine."DD Status":=DDLine."DD Status"::transmitted;
                DDLine.Direction := DDLine.Direction::"in";
                DDLine."Entry Date" := WORKDATE;
                DDLine."File Name" := FlatFileArr[Loop];
                DDLine."File Position"  := LineCounter;
                DDLine."Record ID" := '15';
                DDLine."Trans. No." := TransNo;
                DDLine."Entry Time" := TIME;
                SetTransDateTimeLine(DDLine,TransDate,TransTime);
                DDLine."Trans. Date" := TransDate;
                DDLine."Trans. Time" := TransTime;

                IF DDLine.INSERT THEN;

                DDLine2.RESET;
                DDLine2.SETRANGE("Entry No.",DDLine."Entry No.");
                RecordView := DDLine2.GETVIEW;
                GlobalRecRef.CLOSE;
                GlobalRecRef.OPEN(DATABASE::"DD Line");
                GlobalRecRef.SETVIEW(RecordView);
                IF GlobalRecRef.FIND('-') THEN;

                CheckTransmission(Text,GETFILETYPE(File));
                InsertRecordFromGlobalRecRef
                  (DDDataElement."Table ID"::"15",DATABASE::"DD Line",RecordView);

                IF CreateHeader<>0 THEN BEGIN
                  DDLine.DELETE
                END ELSE BEGIN
                  SetOrderImportResult('51_L');
                END;
              //END;
            END;

          '30':// Purchase Order Import Result
            BEGIN
              IF HeaderEntryNo=0 THEN BEGIN
                DDHeader.INIT;
                DDHeader."Entry No." := GETORDHENTRYNO;
                HeaderEntryNo := DDHeader."Entry No.";
                DDHeader."Document Entry Type" := DDHeader."Document Entry Type"::Purchase;
                DDHeader."Document Type" := DDHeader."Document Type"::Order;
                DDHeader.Direction := DDHeader.Direction::"in";
                DDHeader."DD Status":=DDHeader."DD Status"::transmitted;
                DDHeader."Entry Date" := WORKDATE;
                DDHeader."File Name" := FlatFileArr[Loop];
                DDHeader."File Position"  := LineCounter;
                DDHeader."Record ID" := '30';
                DDHeader."Trans. No." := TransNo;
                DDHeader."Entry Time" := TIME;
                SetTransDateTimeHeader(DDHeader,TransDate,TransTime);
                DDHeader."Trans. Date" := TransDate;
                DDHeader."Trans. Time" := TransTime;
                DDHeader.INSERT;
              END;
              DDLine.INIT;
              DDLine."Entry No." := GETORDLENTRYNO;
              DDLine."Document Entry Type" := DDLine."Document Entry Type"::Purchase;
              DDLine."Header Entry No." := HeaderEntryNo;
              DDLine."Document Type" := DDLine."Document Type"::Order;
              DDLine.Type := DDLine.Type::Item;
              DDLine."DD Status":=DDLine."DD Status"::transmitted;
              DDLine.Direction := DDLine.Direction::"in";
              DDLine."Entry Date" := WORKDATE;
              DDLine."File Name" := FlatFileArr[Loop];
              DDLine."File Position"  := LineCounter;
              DDLine."Record ID" := '30';
              DDLine."Trans. No." := TransNo;
              DDLine."Entry Time" := TIME;
              SetTransDateTimeLine(DDLine,TransDate,TransTime);
              DDLine."Trans. Date" := TransDate;
              DDLine."Trans. Time" := TransTime;

              IF DDLine.INSERT THEN;

              DDLine2.RESET;
              DDLine2.SETRANGE("Entry No.",DDLine."Entry No.");
              RecordView := DDLine2.GETVIEW;
              GlobalRecRef.CLOSE;
              GlobalRecRef.OPEN(DATABASE::"DD Line");
              GlobalRecRef.SETVIEW(RecordView);
              IF GlobalRecRef.FIND('-') THEN;

              CheckTransmission(Text,GETFILETYPE(File));
              InsertRecordFromGlobalRecRef
                (DDDataElement."Table ID"::"30",DATABASE::"DD Line",RecordView);

              SetOrderImportResult('60');
            END;

          '13':// Shipment Confirmation
            BEGIN
              IF HeaderEntryNo=0 THEN BEGIN
                DDHeader.INIT;
                DDHeader."Entry No." := GETORDHENTRYNO;
                HeaderEntryNo := DDHeader."Entry No.";
                DDHeader."Document Entry Type" := DDHeader."Document Entry Type"::Sales;
                DDHeader."Document Type" := DDHeader."Document Type"::Order;
                DDHeader.Direction := DDHeader.Direction::"in";
                DDHeader."DD Status":=DDHeader."DD Status"::shipment;
                DDHeader."Entry Date" := WORKDATE;
                DDHeader."File Name" := FlatFileArr[Loop];
                DDHeader."File Position"  := LineCounter;
                DDHeader."Record ID" := '13';
                DDHeader."Trans. No." := TransNo;
                DDHeader."Entry Time" := TIME;
                SetTransDateTimeHeader(DDHeader,TransDate,TransTime);
                DDHeader."Trans. Date" := TransDate;
                DDHeader."Trans. Time" := TransTime;
                DDHeader.INSERT;
              END;
              DDLine.INIT;
              DDLine."Entry No." := GETORDLENTRYNO;
              DDLine."Document Entry Type" := DDLine."Document Entry Type"::Sales;
              DDLine."Header Entry No." := HeaderEntryNo;
              DDLine."Document Type" := DDLine."Document Type"::Order;
              DDLine.Type := DDLine.Type::Item;
              DDLine."DD Status":=DDLine."DD Status"::shipment;
              DDLine.Direction := DDLine.Direction::"in";
              DDLine."Entry Date" := WORKDATE;
              DDLine."File Name" := FlatFileArr[Loop];
              DDLine."File Position"  := LineCounter;
              DDLine."Record ID" := '13';
              DDLine."Trans. No." := TransNo;
              DDLine."Entry Time" := TIME;
              SetTransDateTimeLine(DDLine,TransDate,TransTime);
              DDLine."Trans. Date" := TransDate;
              DDLine."Trans. Time" := TransTime;

              IF DDLine.INSERT THEN;

              DDLine2.RESET;
              DDLine2.SETRANGE("Entry No.",DDLine."Entry No.");
              RecordView := DDLine2.GETVIEW;
              GlobalRecRef.CLOSE;
              GlobalRecRef.OPEN(DATABASE::"DD Line");
              GlobalRecRef.SETVIEW(RecordView);
              IF GlobalRecRef.FIND('-') THEN;

              CheckTransmission(Text,GETFILETYPE(File));
              InsertRecordFromGlobalRecRef
                (DDDataElement."Table ID"::"13",DATABASE::"DD Line",RecordView);

              ShipmentConfirmation;
            END;

          '18':// Manifest Shipping Confirmation
            BEGIN
              IF HeaderEntryNo=0 THEN BEGIN
                DDHeader.INIT;
                DDHeader."Entry No." := GETORDHENTRYNO;
                HeaderEntryNo := DDHeader."Entry No.";
                DDHeader."Document Entry Type" := DDHeader."Document Entry Type"::Sales;
                DDHeader."Document Type" := DDHeader."Document Type"::Order;
                DDHeader.Direction := DDHeader.Direction::"in";
                DDHeader."DD Status":=DDHeader."DD Status"::manifest;
                DDHeader."Entry Date" := WORKDATE;
                DDHeader."File Name" := FlatFileArr[Loop];
                DDHeader."File Position"  := LineCounter;
                DDHeader."Record ID" := '18';
                DDHeader."Trans. No." := TransNo;
                DDHeader."Entry Time" := TIME;
                SetTransDateTimeHeader(DDHeader,TransDate,TransTime);
                DDHeader."Trans. Date" := TransDate;
                DDHeader."Trans. Time" := TransTime;
                DDHeader.INSERT;
              END;
              DDLine.INIT;
              DDLine."Entry No." := GETORDLENTRYNO;
              DDLine."Document Entry Type" := DDLine."Document Entry Type"::Sales;
              DDLine."Header Entry No." := HeaderEntryNo;
              DDLine."Document Type" := DDLine."Document Type"::Order;
              DDLine.Type := DDLine.Type::Item;
              DDLine."DD Status":=DDLine."DD Status"::manifest;
              DDLine.Direction := DDLine.Direction::"in";
              DDLine."Entry Date" := WORKDATE;
              DDLine."File Name" := FlatFileArr[Loop];
              DDLine."File Position"  := LineCounter;
              DDLine."Record ID" := '18';
              DDLine."Trans. No." := TransNo;
              DDLine."Entry Time" := TIME;
              SetTransDateTimeLine(DDLine,TransDate,TransTime);
              DDLine."Trans. Date" := TransDate;
              DDLine."Trans. Time" := TransTime;

              IF DDLine.INSERT THEN;

              DDLine2.RESET;
              DDLine2.SETRANGE("Entry No.",DDLine."Entry No.");
              RecordView := DDLine2.GETVIEW;
              GlobalRecRef.CLOSE;
              GlobalRecRef.OPEN(DATABASE::"DD Line");
              GlobalRecRef.SETVIEW(RecordView);
              IF GlobalRecRef.FIND('-') THEN;

              CheckTransmission(Text,GETFILETYPE(File));
              InsertRecordFromGlobalRecRef
                (DDDataElement."Table ID"::"18",DATABASE::"DD Line",RecordView);

              ManifestShippingConfirmation;
            END;

          '20':// Stock Mutation
            BEGIN
              IF HeaderEntryNo=0 THEN BEGIN
                DDHeader.INIT;
                DDHeader."Entry No." := GETORDHENTRYNO;
                HeaderEntryNo := DDHeader."Entry No.";
                DDHeader."Document Entry Type" := DDHeader."Document Entry Type"::Purchase;
                DDHeader."Document Type" := DDHeader."Document Type"::Order;
                DDHeader.Direction := DDHeader.Direction::"in";
                DDHeader."DD Status":=DDHeader."DD Status"::transmitted;
                DDHeader."Entry Date" := WORKDATE;
                DDHeader."File Name" := FlatFileArr[Loop];
                DDHeader."File Position"  := LineCounter;
                DDHeader."Record ID" := '20';
                DDHeader."Trans. No." := TransNo;
                DDHeader."Entry Time" := TIME;
                SetTransDateTimeHeader(DDHeader,TransDate,TransTime);
                DDHeader."Trans. Date" := TransDate;
                DDHeader."Trans. Time" := TransTime;
                DDHeader.INSERT;
              END;
              DDLine.INIT;
              DDLine."Entry No." := GETORDLENTRYNO;
              DDLine."Document Entry Type" := DDLine."Document Entry Type"::Purchase;
              DDLine."Header Entry No." := HeaderEntryNo;
              DDLine."Document Type" := DDLine."Document Type"::Order;
              DDLine.Type := DDLine.Type::Item;
              //P0460/gob-sfe/18.10.12
              DDLine."Trans. No." := TransNo;
              IF NOT CheckDoubleTransmission(DDLine."Trans. No.",DDLine) THEN
                DDLine."DD Status":=DDLine."DD Status"::transmitted
              ELSE BEGIN
                DDLine."DD Status":=DDLine."DD Status"::error;
                DDLine."Error Code":='1019';
                DDLine."Error Description":='Already imported Transmission'
              END;
              //P0460/gob-sfe/18.10.12
              DDLine.Direction := DDLine.Direction::"in";
              DDLine."Entry Date" := WORKDATE;
              DDLine."File Name" := FlatFileArr[Loop];
              DDLine."File Position"  := LineCounter;
              DDLine."Record ID" := '20';
              DDLine."Entry Time" := TIME;
              SetTransDateTimeLine(DDLine,TransDate,TransTime);
              DDLine."Trans. Date" := TransDate;
              DDLine."Trans. Time" := TransTime;

              IF DDLine.INSERT THEN;

              DDLine2.RESET;
              DDLine2.SETRANGE("Entry No.",DDLine."Entry No.");
              RecordView := DDLine2.GETVIEW;
              GlobalRecRef.CLOSE;
              GlobalRecRef.OPEN(DATABASE::"DD Line");
              GlobalRecRef.SETVIEW(RecordView);
              IF GlobalRecRef.FIND('-') THEN;

              CheckTransmission(Text,GETFILETYPE(File));
              InsertRecordFromGlobalRecRef
                (DDDataElement."Table ID"::"20",DATABASE::"DD Line",RecordView);

              StockMutation;
            END;


          '71':// Supplier Import Result
            BEGIN
              DDSupplier.INIT;
              DDSupplier."Entry No." := GETSupplierENTRYNO;
              DDSupplier."Trans. Status":=DDSupplier."Trans. Status"::transmitted;
              DDSupplier.Direction := DDSupplier.Direction::"in";
              DDSupplier."Entry Date" := WORKDATE;
              DDSupplier."File Name" := FlatFileArr[Loop];
              DDSupplier."File Position"  := LineCounter;
              DDSupplier."Record ID" := '71';
              DDSupplier."Trans. No." := TransNo;
              DDSupplier."Entry Time" := TIME;
              //SetTransDateTimeLine(DDSupplier,TransDate,TransTime);
              DDSupplier."Trans. Date" := TODAY;
              DDSupplier."Trans. Time" := TIME;
              IF DDSupplier.INSERT THEN;

              DDSupplier2.RESET;
              DDSupplier2.SETRANGE("Entry No.",DDSupplier."Entry No.");
              RecordView := DDSupplier2.GETVIEW;
              GlobalRecRef.CLOSE;
              GlobalRecRef.OPEN(DATABASE::"DD Supplier");
              GlobalRecRef.SETVIEW(RecordView);
              IF GlobalRecRef.FIND('-') THEN;

              CheckTransmission(Text,GETFILETYPE(File));
              InsertRecordFromGlobalRecRef
                (DDDataElement."Table ID"::"71",DATABASE::"DD Supplier",RecordView);

              SetSupplierImportResult;
            END;


          '14':// Return Order
            BEGIN
              IF HeaderEntryNo=0 THEN BEGIN
                DDHeader.INIT;
                DDHeader."Entry No." := GETORDHENTRYNO;
                HeaderEntryNo := DDHeader."Entry No.";
                DDHeader."Document Entry Type" := DDHeader."Document Entry Type"::Sales;
                DDHeader."Document Type" := DDHeader."Document Type"::Order;
                DDHeader.Direction := DDHeader.Direction::"in";
                DDHeader."DD Status":=DDHeader."DD Status"::transmitted;
                DDHeader."Entry Date" := WORKDATE;
                DDHeader."File Name" := FlatFileArr[Loop];
                DDHeader."File Position"  := LineCounter;
                DDHeader."Record ID" := '14';
                DDHeader."Trans. No." := TransNo;
                DDHeader."Entry Time" := TIME;
                SetTransDateTimeHeader(DDHeader,TransDate,TransTime);
                DDHeader."Trans. Date" := TransDate;
                DDHeader."Trans. Time" := TransTime;
                DDHeader.INSERT;
              END;

              DDLine.INIT;
              DDLine."Entry No." := GETORDLENTRYNO;
              DDLine."Document Entry Type" := DDLine."Document Entry Type"::Sales;
              DDLine."Header Entry No." := HeaderEntryNo;
              DDLine."Document Type" := DDLine."Document Type"::Order;
              DDLine.Type := DDLine.Type::Item;
              DDLine."DD Status":=DDLine."DD Status"::transmitted;
              DDLine.Direction := DDLine.Direction::"in";
              DDLine."Entry Date" := WORKDATE;
              DDLine."File Name" := FlatFileArr[Loop];
              DDLine."File Position"  := LineCounter;
              DDLine."Record ID" := '14';
              DDLine."Trans. No." := TransNo;
              DDLine."Entry Time" := TIME;
              SetTransDateTimeLine(DDLine,TransDate,TransTime);
              DDLine."Trans. Date" := TransDate;
              DDLine."Trans. Time" := TransTime;

              IF DDLine.INSERT THEN;


              DDLine2.RESET;
              DDLine2.SETRANGE("Entry No.",DDLine."Entry No.");
              RecordView := DDLine2.GETVIEW;
              GlobalRecRef.CLOSE;
              GlobalRecRef.OPEN(DATABASE::"DD Line");
              GlobalRecRef.SETVIEW(RecordView);
              IF GlobalRecRef.FIND('-') THEN;

              CheckTransmission(Text,GETFILETYPE(File));
              InsertRecordFromGlobalRecRef
                (DDDataElement."Table ID"::"14",DATABASE::"DD Line",RecordView);

              //SetOrderStatusChange;

            END;

          '11':// CYCC (11)
            BEGIN
              DDItem.INIT;
              DDItem."Entry No." := GETSKUENTRYNO;
              DDItem."Entry Date" := WORKDATE;
              DDItem."Trans. Status" := DDItem."Trans. Status"::new;
              DDItem."File Name" := FlatFileArr[Loop];
              DDItem.Direction := DDItem.Direction::"in";
              DDItem."Trans. No." := TransNo;
              DDItem."Record ID" := '11';
              DDItem."File Position" := LineCounter;
              DDItem."Entry Time" := TIME;
              SetTransDateTimeSKU(DDItem,TransDate,TransTime);
              DDItem."Trans. Date" := TransDate;
              DDItem."Trans. Time" := TransTime;

              IF DDItem.INSERT THEN;

              DDItem2.RESET;
              DDItem2.SETRANGE("Entry No.",DDItem."Entry No.");
              RecordView := DDItem2.GETVIEW;
              GlobalRecRef.CLOSE;

              GlobalRecRef.OPEN(DATABASE::"DD Material");
              GlobalRecRef.SETVIEW(RecordView);
              IF GlobalRecRef.FIND('-') THEN;

              CheckTransmission(Text,GETFILETYPE(File));
              {
              IF EVALUATE(ConfirmedInventory,COPYSTR(Text,50,9)) THEN BEGIN
                FldRef := GlobalRecRef.FIELD(79514);//"Confirmed Inventory"
                FldRef.VALUE := ConfirmedInventory;
                IF GlobalRecRef.MODIFY THEN;
              END;

              IF EVALUATE(SperrStatus,COPYSTR(Text,47,3)) THEN BEGIN
                FldRef := GlobalRecRef.FIELD(79535);//"SperrStatus"
                FldRef.VALUE := SperrStatus;
              END;
              }
              InsertRecordFromGlobalRecRef
                (DDDataElement."Table ID"::"11",DATABASE::"DD Material",RecordView);
            END;

          '16':// Article Import Result (16)
            BEGIN
              DDItem.INIT;
              DDItem."Entry No." := GETSKUENTRYNO;
              DDItem."Entry Date" := WORKDATE;
              DDItem."Trans. Status" := DDItem."Trans. Status"::transmitted;
              DDItem."File Name" := FlatFileArr[Loop];
              DDItem.Direction := DDItem.Direction::"in";
              DDItem."Trans. No." := TransNo;
              DDItem."Record ID" := '16';
              DDItem."File Position" := LineCounter;
              DDItem."Entry Time" := TIME;
              SetTransDateTimeSKU(DDItem,TransDate,TransTime);
              DDItem."Trans. Date" := TransDate;
              DDItem."Trans. Time" := TransTime;

              IF DDItem.INSERT THEN;

              DDItem2.RESET;
              DDItem2.SETRANGE("Entry No.",DDItem."Entry No.");
              RecordView := DDItem2.GETVIEW;
              GlobalRecRef.CLOSE;

              GlobalRecRef.OPEN(DATABASE::"DD Material");
              GlobalRecRef.SETVIEW(RecordView);
              IF GlobalRecRef.FIND('-') THEN;

              CheckTransmission(Text,GETFILETYPE(File));

              InsertRecordFromGlobalRecRef
                (DDDataElement."Table ID"::"16",DATABASE::"DD Material",RecordView);

              SetArticleImportResult();

            END;

        END;
      UNTIL fIn.POS = fIn.LEN;

      IF GUIALLOWED THEN window.CLOSE;
      fIn.CLOSE;
    END;

    PROCEDURE CheckTransmission@19(Text@1003 : Text[1024];Record_ID@1004 : Text[30]);
    VAR
      DDDataElement@1002 : Record 50058;
      DDDataElement2@1001 : Record 50058;
      i@1000 : Integer;
    BEGIN
      CLEAR(ArrayOfFields);

      WITH DDDataElement DO BEGIN
        RESET;
        SETCURRENTKEY("Table ID","Field Index");
        CASE UPPERCASE(DELCHR(Record_ID,'=',FORMAT(Filler))) OF
          '15':
             SETRANGE("Table ID",DDDataElement."Table ID"::"15");
          '13':
             SETRANGE("Table ID",DDDataElement."Table ID"::"13");
          '20':
             SETRANGE("Table ID",DDDataElement."Table ID"::"20");
          '18':
             SETRANGE("Table ID",DDDataElement."Table ID"::"18");
          '11':
             SETRANGE("Table ID",DDDataElement."Table ID"::"11");
          '14':
             SETRANGE("Table ID",DDDataElement."Table ID"::"14");
          '30':
             SETRANGE("Table ID",DDDataElement."Table ID"::"30");
          '17':
             SETRANGE("Table ID",DDDataElement."Table ID"::"17");
          '71':
             SETRANGE("Table ID",DDDataElement."Table ID"::"71");
          '16':
             SETRANGE("Table ID",DDDataElement."Table ID"::"16");
        END;
        IF FIND('+') THEN BEGIN
          FOR i := 1 TO "Field Index" DO BEGIN
            DDDataElement2.GET("Table ID",i);
            CheckData(Text,DDDataElement2,i);
          END;
        END;
      END;
    END;

    PROCEDURE ReadTransTrailer@9(Ffl@1000 : Text[1024]) : Boolean;
    VAR
      TRLRError@1001 : Boolean;
    BEGIN
      Data := READFFLPOSITIION(SETFILENAME(Ffl),2);
      TRLRError := FALSE;
      IF COPYSTR(Data,1,4) <> 'TRLR' THEN BEGIN
        ArrayOfErrorVar[1] := Ffl;
        //ErrorHandler(1007)
        TRLRError := TRUE;


      END;

      EXIT(NOT TRLRError);
    END;

    PROCEDURE CheckData@6(Data@1000 : Text[1024];DDDataElement@1003 : Record 50058;Index@1004 : Integer);
    VAR
      DDDataElement2@1002 : Record 50058;
      i@1001 : Integer;
      Number@1005 : Decimal;
      Time@1006 : Time;
      Date@1007 : Date;
      StartPosLoc@1000000000 : Integer;
      LengthLoc@1000000001 : Integer;
    BEGIN
      WITH DDDataElement DO BEGIN

        StartPosLoc:=FindPosition(Data,Index);
        LengthLoc:=FindLength(Data,StartPosLoc);

        ArrayOfFields[Index] := COPYSTR( Data,StartPosLoc, LengthLoc );

        IF (COPYSTR(ArrayOfFields[Index],1,1)='"') THEN ArrayOfFields[Index]:=''; //wenn kein Inhalt, dann l”schen

        IF Type = DDDataElement.Type::const THEN BEGIN
          IF LOWERCASE(
               DELCHR(Value,'=',FORMAT(Filler))) <>
             LOWERCASE(
               DELCHR(ArrayOfFields[Index],'=',FORMAT(Filler)))
          THEN BEGIN
            ArrayOfErrorVar[1] :=  FlatFileArr[Loop];
            ArrayOfErrorVar[2] := "Field ID";
            ArrayOfErrorVar[3] :=  FORMAT(LineCounter);
            ErrorHandler(1002);
          END;
        END;

        IF Type = DDDataElement.Type::Date THEN
          IF NOT EVALUATE(Date,ArrayOfFields[Index]) THEN BEGIN
            ArrayOfErrorVar[1] :=  FlatFileArr[Loop];
            ArrayOfErrorVar[2] := "Field ID";
            ArrayOfErrorVar[3] :=  FORMAT(LineCounter);
            ErrorHandler(1004);
          END;

        IF Type = DDDataElement.Type::Time THEN
          IF NOT EVALUATE(Time,ArrayOfFields[Index]) THEN BEGIN
            ArrayOfErrorVar[1] :=  FlatFileArr[Loop];
            ArrayOfErrorVar[2] := "Field ID";
            ArrayOfErrorVar[3] :=  FORMAT(LineCounter);
            ErrorHandler(1005);
          END;

        IF (DDDataElement."Data Type" = DDDataElement."Data Type"::NUMBER) AND
           (DDDataElement.Type <> DDDataElement.Type::Filler) AND (DDDataElement.Status=DDDataElement.Status::RQ)
        THEN
          IF NOT EVALUATE(Number,ArrayOfFields[Index]) THEN BEGIN
            ArrayOfErrorVar[1] :=  FlatFileArr[Loop];
            ArrayOfErrorVar[2] := "Field ID";
            ArrayOfErrorVar[3] :=  FORMAT(LineCounter);
            ErrorHandler(1003);
          END;

        IF Type = DDDataElement.Type::Reference THEN BEGIN
          CheckReference(DDDataElement);
          IF CHECKFIELD(DDDataElement."Record Reference",DDDataElement."Field Reference") THEN;
         END;

        IF Type = DDDataElement.Type::"var" THEN
          IF CHECKENVIRONVAR(DDDataElement.Value) THEN BEGIN
            IF GETENVIRONVAR(DDDataElement.Value,DDDataElement) <> FORMAT(ArrayOfFields[Index]) THEN;
          END;

      END;
    END;

    PROCEDURE FindPosition@1000000000(Text@1000000001 : Text[1024];Index@1000000000 : Integer) Pos : Integer;
    VAR
      DDSetup@1000000002 : Record 50060;
      j@1000000003 : Integer;
      FieldCounter@1000000004 : Integer;
    BEGIN
      IF Index=1 THEN
        EXIT(2);

      DDSetup.GET;
      j:=0;
      FieldCounter:=0;
      REPEAT
        j+=1;
        IF COPYSTR(Text,j,1)=DDSetup.Separator THEN
          FieldCounter+=1;
      UNTIL ( j>=STRLEN(Text) ) OR (FieldCounter=Index-1);

      EXIT(j+2);
    END;

    PROCEDURE FindLength@1000000001(Text@1000000001 : Text[1024];StartPosition@1000000000 : Integer) : Integer;
    VAR
      j@1000000002 : Integer;
    BEGIN
      DDSetup.GET;
      j:=StartPosition;

      REPEAT
        j+=1;
      UNTIL ( j>=STRLEN(Text) ) OR (COPYSTR(Text,j,1)=DDSetup.FieldEndDelimeter);

      EXIT(j-StartPosition);
    END;

    PROCEDURE InsertRecordFromGlobalRecRef@36(Table_ID@1004 : '11,13,14,15,16,17,18,20,30,71';Record_Reference@1005 : Integer;RecordView@1006 : Text[250]);
    VAR
      DDDataElement@1000 : Record 50058;
      Item@1011 : Record 27;
      RecRef@1003 : RecordRef;
      FldRef@1002 : FieldRef;
      Number@1001 : Decimal;
      Date@1007 : Date;
      Time@1008 : Time;
      Caption@1009 : Text[50];
      PrimaryKey@1010 : Text[250];
    BEGIN
      {
      IF Table_ID = Table_ID::EIM THEN BEGIN
        RecRef.OPEN(DATABASE::Item);
        PrimaryKey := RecRef.CURRENTKEY;
      END;
      }
      WITH DDDataElement DO BEGIN
        RESET;
        SETCURRENTKEY("Table ID",Type);
        SETRANGE("Table ID",Table_ID);
        SETRANGE(Type,Type::Reference);
        SETRANGE("Record Reference",Record_Reference);
        IF FIND('-') THEN
          REPEAT
            IF GlobalRecRef.FIELDEXIST("Field Reference") THEN BEGIN
              FldRef := GlobalRecRef.FIELD("Field Reference");
              Caption := FldRef.CAPTION;
              IF NOT ISFLOWFIELD(GlobalRecRef.NUMBER,FldRef.NUMBER) THEN BEGIN

                CASE FORMAT(FldRef.TYPE) OF
                  'Text',
                  'Code':
                    BEGIN
                      FldRef.VALUE := CharToOEM(COPYSTR(
                        ArrayOfFields["Field Index"],1,FldRef.LENGTH));
                      {
                      //Prfung, ob Artikel vorhanden
                      IF Table_ID = Table_ID::EIM THEN
                        IF FldRef.CAPTION = PrimaryKey THEN
                          IF NOT Item.GET(FldRef.VALUE) THEN BEGIN
                            ArrayOfErrorVar[1] := FlatFileArr[Loop];
                            ArrayOfErrorVar[2] := FORMAT(LineCounter);
                            ErrorHandler(1013);
                          END;
                      }
                    END;
                  'Decimal':
                    BEGIN
                      IF Status=Status::RQ THEN
                        EVALUATE(Number,ArrayOfFields["Field Index"])
                      //P0460/gob-sfe/18.10.12
                      ELSE IF (Status=Status::OP) THEN
                        IF (ArrayOfFields["Field Index"]='') THEN
                          EVALUATE(Number,FORMAT(0))
                        ELSE
                          EVALUATE(Number,FORMAT(ArrayOfFields["Field Index"]));
                      //P0460/gob-sfe/18.10.12
                      FldRef.VALUE := Number;
                    END;
                  'Integer':
                    BEGIN
                      IF Status=Status::RQ THEN
                        EVALUATE(Number,ArrayOfFields["Field Index"])
                      ELSE IF (ArrayOfFields["Field Index"]='')  AND (Status=Status::OP) THEN
                        EVALUATE(Number,FORMAT(FldRef.VALUE)); //P0174/gob-sfe/13.08.2012
                      FldRef.VALUE := Number;
                    END;
                  'Date':
                    BEGIN
                      FldRef.VALUE := FORMATDATE(ArrayOfFields["Field Index"]);
                    END;
                  'Time':
                    BEGIN
                      EVALUATE(Time,ArrayOfFields["Field Index"]);
                      FldRef.VALUE := Time;
                    END;
                END;

              END;
              IF GlobalRecRef.MODIFY THEN;
            END;
          UNTIL NEXT = 0;
      END;
    END;

    PROCEDURE CreateHeader@1000000010() "HeaderNo." : Integer;
    VAR
      FldRef@1000000000 : FieldRef;
      IntTmp@1000000001 : Integer;
      CodeTmp@1000000002 : Code[10];
      DDHeader@1000000003 : Record 50061;
      TransDate@1000000005 : Date;
      TransTime@1000000004 : Time;
    BEGIN
      FldRef := GlobalRecRef.FIELD(76110); //"Pos. No."
      EVALUATE(IntTmp,FORMAT(FldRef.VALUE));
      IF IntTmp=0 THEN BEGIN
        DDHeader.INIT;
        DDHeader."Entry No." := GETORDHENTRYNO;
        HeaderEntryNo2 := DDHeader."Entry No.";
        FldRef := GlobalRecRef.FIELD(3); //"Document No."
        DDHeader."No.":=FldRef.VALUE;
        //P0410/gob-sfe/05.10.12
        FldRef := GlobalRecRef.FIELD(79535); //"Import Result Code"
        DDHeader."Import Result Code":=FldRef.VALUE;
        FldRef := GlobalRecRef.FIELD(79536); //"Import Result Message"
        DDHeader."Import Result Message":=FldRef.VALUE;
        //P0410/gob-sfe/05.10.12
        DDHeader."Document Entry Type" := DDHeader."Document Entry Type"::Sales;
        DDHeader."Document Type" := DDHeader."Document Type"::Order;
        DDHeader.Direction := DDHeader.Direction::"in";
        DDHeader."DD Status":=DDHeader."DD Status"::transmitted;
        DDHeader."Entry Date" := WORKDATE;
        DDHeader."File Name" := FlatFileArr[Loop];
        DDHeader."File Position"  := LineCounter;
        DDHeader."Record ID" := '15';
        DDHeader."Trans. No." := TransNo;
        DDHeader."Entry Time" := TIME;
        SetTransDateTimeHeader(DDHeader,TransDate,TransTime);
        DDHeader."Trans. Date" := TransDate;
        DDHeader."Trans. Time" := TransTime;
        DDHeader.INSERT;
        EXIT(DDHeader."Entry No.");
      END;
    END;

    PROCEDURE SetOrderImportResult@1000000002(RecordType@1000000000 : Code[10]);
    VAR
      DDLineIn@1003 : Record 50062;
      TempDDHeaderOut@1006 : Record 50061;
      DDLineOut@1004 : Record 50062;
      TempDDLineOut@1007 : Record 50062;
      FldRef@1001 : FieldRef;
      DDHeaderInLoc@1000000001 : Record 50061;
      CancelType@1000000002 : Text[30];
    BEGIN
      FldRef := GlobalRecRef.FIELD(79501); //"Entry No."

      //Sales Order + Purchase Order Import Result
      IF (RecordType='51_L') OR (RecordType='60') THEN BEGIN
        DDLineIn.GET(FldRef.VALUE);
        WITH DDLineOut DO BEGIN
          SETCURRENTKEY("Record ID","DD Status","Document Entry Type","Document Type","Document No.","DD Pos. No.",Direction);
          SETRANGE("Record ID",RecordType);
          SETRANGE("DD Status",DDLineOut."DD Status"::transmitted);
          SETRANGE("Document Entry Type",DDLineIn."Document Entry Type");
          SETRANGE("Document Type",DDLineIn."Document Type");
          SETRANGE("Document No.",DDLineIn."Document No.");
          SETRANGE("DD Pos. No.",DDLineIn."DD Pos. No.");
          SETRANGE(Direction,DDLineOut.Direction::out);
          SETRANGE("Trans. No.",DDLineIn."Trans. No."); //a/P0647/gob-sfe/05.12.12

          //SETFILTER("Import Result Code",'%1','');
          TempDDLineOut.SETCURRENTKEY("Record ID","DD Status","Document Entry Type","Document Type",
                                      "Document No.","DD Pos. No.",Direction);
          TempDDLineOut.COPYFILTERS(DDLineOut);
          { No Error when multiple Import Results
          IF TempDDLineOut.COUNT > 1 THEN BEGIN
            ArrayOfErrorVar[1] := DDLineIn.TABLECAPTION;
            ArrayOfErrorVar[2] := DDLineIn.FIELDCAPTION("Entry No.");
            ArrayOfErrorVar[3] := FORMAT(DDLineIn."Entry No.");
            ErrorHandler(1011);
            EXIT;
          END;
          }
          IF FIND('-') THEN BEGIN
            IF NOERRORS THEN BEGIN
            //a/P0647/gob-sfe/05.12.12
              IF DDLineOut.Quantity<>0 THEN
                CancelType:='Order'
              ELSE
                CancelType:='Cancel';
              DDLineOut."Import Result Code":=DDLineIn."Import Result Code";
              IF DDLineIn."Import Result Message"<>'' THEN
                DDLineOut."Import Result Message":=DDLineIn."Import Result Message"+' '+CancelType+' '+'denied' //P0647
              ELSE
                DDLineOut."Import Result Message":=CancelType+' accepted'; //P0647
            END;
            //e/P0647/gob-sfe/05.12.12
            //"Assoc. Entry No." := DDLineIn."Entry No.";  //P0198
            DDLineIn."Assoc. Entry No.":=DDLineOut."Entry No.";
            IF MODIFY THEN;

            IF DDLineIn.MODIFY THEN;


          IF DDLineIn."Import Result Message"<>'' THEN BEGIN
            //OrderLogText:=DDLineIn."Import Result Message"+': '+DDLineIn."Import Result Code"+;
            OrderLogText:= DDLineOut."Import Result Message"; //a/P0647/gob-sfe/05.12.12
            IF DDLineIn."Import Result Code"='D' THEN
                DDLog.InsertLog(1,1,DDLineOut."Entry No.",DDLineIn."Import Result Code",DDLineOut."Import Result Message"); //P0140
          END ELSE BEGIN
          //P0410/gob-sfe/05.10.12
            DDHeaderInLoc.GET(DDLineIn."Header Entry No.");
            DDLog.InsertLog(0,0,DDLineOut."Header Entry No.",
              DDHeaderInLoc."Import Result Code",DDHeaderInLoc."Import Result Message"); //P0140
            OrderLogText:=DDLineOut."Import Result Message"; //P0140
          END;
          //P0410/gob-sfe/05.10.12
          IF (RecordType='51_L')  THEN
            //a/P0475/gob-sfe/22.10.2012
            //OrderStatusLog.CreateOrderStatus(0,DDLineOut."Document No.",DDLineOut."Line No.",'15',OrderLogText);
            OrderStatusLog.CreateOrderStatus(0,DDLineOut."Order No. Navision",DDLineOut."Line No.",'15',OrderLogText);
            //e/P0475/gob-sfe/22.10.2012
          // S/P0988
          // IF (RecordType='60')  THEN
          //   OrderStatusLog.CreateOrderStatus(1,DDLineOut."Document No.",DDLineOut."Line No.",'15',OrderLogText);
          // E/P0988
          END ELSE BEGIN
            ArrayOfErrorVar[1] := RecordType;
            ArrayOfErrorVar[2] := DDLineIn.TABLECAPTION;
            ArrayOfErrorVar[3] := DDLineIn.FIELDCAPTION("Entry No.");
            ArrayOfErrorVar[4] := FORMAT(DDLineIn."Entry No.");
            ErrorHandler(1012);
            EXIT;
          END;
        END;
      END;
    END;

    PROCEDURE SetOrderStatusChange@1000000017();
    VAR
      DDLineIn@1003 : Record 50062;
      TempDDHeaderOut@1006 : Record 50061;
      DDLineOut@1004 : Record 50062;
      TempDDLineOut@1007 : Record 50062;
      FldRef@1001 : FieldRef;
      DDHeaderOut@1000000000 : Record 50061;
      FPCGeneralSetup@1000000001 : Record 50055;
      InterfaceProcessMgt@1000000002 : Codeunit 50087;
      InterfaceProcessLog@1000000003 : Record 50087;
    BEGIN
      FldRef := GlobalRecRef.FIELD(79501); //"Entry No."

      DDLineIn.GET(FldRef.VALUE);
      OldDocNo:=DDLineIn."Document No.";  //remember old document no.

      WITH DDLineOut DO BEGIN
        SETCURRENTKEY("Record ID","DD Status","Document Entry Type","Document Type","Document No.","DD Pos. No.",Direction);
        SETRANGE("Record ID",'51_L');
        SETFILTER("DD Status",'%1|%2',DDLineOut."DD Status"::transmitted,DDLineOut."DD Status"::"status change");
        SETRANGE("Document Entry Type",DDLineIn."Document Entry Type");
        SETRANGE("Document Type",DDLineIn."Document Type");
        SETRANGE("Document No.",DDLineIn."Document No.");
        SETRANGE("DD Pos. No.",DDLineIn."DD Pos. No.");
        SETRANGE(Direction,DDLineOut.Direction::out);
        TempDDLineOut.SETCURRENTKEY("Record ID","DD Status","Document Entry Type","Document Type",
                                    "Document No.","DD Pos. No.",Direction);
        TempDDLineOut.COPYFILTERS(DDLineOut);
        IF TempDDLineOut.COUNT > 1 THEN BEGIN
          ArrayOfErrorVar[1] := DDLineIn.TABLECAPTION;
          ArrayOfErrorVar[2] := DDLineIn.FIELDCAPTION("Entry No.");
          ArrayOfErrorVar[3] := FORMAT(DDLineIn."Entry No.");
          ErrorHandler(1011);
          EXIT;
        END;
        IF FIND('-') THEN BEGIN
          IF NOERRORS THEN BEGIN
            DDLineOut."Quantity on Picklist":=DDLineIn."Quantity on Picklist";
            DDLineOut."Quantity in Backorder":=DDLineIn."Quantity on Picklist";
            DDLineOut."Import Result Message":=DDLineIn."Import Result Message";
            DDLineOut."DD Status":=DDLineOut."DD Status"::"status change";
            DDHeaderOut.GET(DDLineOut."Header Entry No.");
            DDHeaderOut."DD Status":=DDHeaderOut."DD Status"::"status change";
            DDHeaderOut.MODIFY;

          END;
          //"Assoc. Entry No." := DDLineIn."Entry No.";  //P0198
          DDLineIn."Assoc. Entry No." := "Entry No.";  //P0198

          IF MODIFY THEN;

          IF DDLineIn.MODIFY THEN;

          IF DDLineIn."Import Result Message"<>'' THEN BEGIN
            OrderLogText:=DDLineIn."Import Result Message"+': '+DDLineIn."Import Result Code";
            IF (DDLineIn."Import Result Message"<>'Picklist created') THEN
              DDLog.InsertLog(1,1,DDLineOut."Entry No.",DDLineIn."Import Result Code",DDLineIn."Import Result Message"); //P0164
          END ELSE
            OrderLogText:='Status Change for Sales Order';
           //a/P0475/gob-sfe/22.10.2012
          //OrderStatusLog.CreateOrderStatus(0,DDLineOut."Document No.",DDLineOut."Line No.",'17',OrderLogText);
          OrderStatusLog.CreateOrderStatus(0,DDLineOut."Order No. Navision",DDLineOut."Line No.",'17',OrderLogText);
          //e/P0475/gob-sfe/22.10.2012
          //A/P0564
          IF DDLineIn."Import Result Message" = 'Picklist created' THEN BEGIN
            CLEAR(InterfaceProcessMgt);
            FPCGeneralSetup.GET;
            FPCGeneralSetup.TESTFIELD("Interface Code DocData");
            FPCGeneralSetup.TESTFIELD("Status Pick");
            FPCGeneralSetup.TESTFIELD("Status Transport");
            FPCGeneralSetup.TESTFIELD("Trigger Docdata Interface");
            IF InterfaceProcessMgt.TriggerActive(FPCGeneralSetup."Trigger Docdata Interface") THEN
              InterfaceProcessMgt.UpdateProcessLogForInterface(DDLineOut."Order No. Navision",
                                                               DDLineOut."Line No.",
                                                               FPCGeneralSetup."Interface Code DocData",
                                                               FPCGeneralSetup."Status Pick",
                                                               FPCGeneralSetup."Status Transport",
                                                               FPCGeneralSetup."Trigger Docdata Interface");

          END;
          //E/P0564
          //S/P0966
          IF DDLineIn."Import Result Message" IN ['Backorder','Not on stock'] THEN BEGIN
            // Check if is in transport, set processed PICK
            FPCGeneralSetup.GET;
            FPCGeneralSetup.TESTFIELD("Interface Code DocData");
            FPCGeneralSetup.TESTFIELD("Status Transport");
            InterfaceProcessLog.RESET;
            InterfaceProcessLog.SETRANGE("Entry Type",InterfaceProcessLog."Entry Type"::Sales);
            InterfaceProcessLog.SETRANGE("Entry Subtype",InterfaceProcessLog."Entry Subtype"::Order);
            InterfaceProcessLog.SETRANGE("Document No.",DDLineOut."Order No. Navision");
            InterfaceProcessLog.SETRANGE("Document Line No.",DDLineOut."Line No.");
            InterfaceProcessLog.SETRANGE(Interface,FPCGeneralSetup."Interface Code DocData");
            IF InterfaceProcessLog.FINDLAST THEN BEGIN
              IF InterfaceProcessLog.Status = FPCGeneralSetup."Status Transport" THEN BEGIN
                InterfaceProcessMgt.InitDDPickAsProcessed(TRUE);
                InterfaceProcessMgt.UpdateProcessLogForInterface(DDLineOut."Order No. Navision",
                                                                 DDLineOut."Line No.",
                                                                 FPCGeneralSetup."Interface Code DocData",
                                                                 FPCGeneralSetup."Status Transport",
                                                                 FPCGeneralSetup."Status Pick",
                                                                 FPCGeneralSetup."Trigger Docdata Interface");
              InterfaceProcessMgt.InitDDPickAsProcessed(FALSE);
              END;
            END;
          END;
          //E/P0966
        END ELSE BEGIN
          ArrayOfErrorVar[1] := '51_L';
          ArrayOfErrorVar[2] := DDLineIn.TABLECAPTION;
          ArrayOfErrorVar[3] := DDLineIn.FIELDCAPTION("Entry No.");
          ArrayOfErrorVar[4] := FORMAT(DDLineIn."Entry No.");
          ErrorHandler(1012);
          EXIT;
        END;
      END;
    END;

    PROCEDURE SetSupplierImportResult@1000000018();
    VAR
      DDSuppIn@1003 : Record 50064;
      TempDDsuppOut@1006 : Record 50064;
      DDSuppOut@1004 : Record 50064;
      FldRef@1001 : FieldRef;
    BEGIN
      FldRef := GlobalRecRef.FIELD(79501); //"Entry No."

      DDSuppIn.GET(FldRef.VALUE);
      WITH DDSuppOut DO BEGIN
        SETCURRENTKEY("Record ID","No.",Direction);
        SETRANGE("Record ID",'70');
        SETRANGE("No.",DDSuppIn."No.");
        SETRANGE("Trans. Status",DDSuppOut."Trans. Status"::transmitted);
        SETRANGE(Direction,DDSuppOut.Direction::out);
        //SETFILTER("Import Result Code",'%1','');
        {
        TempDDsuppOut.SETCURRENTKEY("Record ID","No.",Direction);
        TempDDsuppOut.COPYFILTERS(DDSuppOut);
        IF TempDDsuppOut.COUNT > 1 THEN BEGIN
          ArrayOfErrorVar[1] := DDSuppIn.TABLECAPTION;
          ArrayOfErrorVar[2] := DDSuppIn.FIELDCAPTION("Entry No.");
          ArrayOfErrorVar[3] := FORMAT(DDSuppIn."Entry No.");
          ErrorHandler(1011);
          EXIT;
        END;
        }
        IF FINDLAST THEN BEGIN
          IF NOERRORS THEN BEGIN
            DDSuppOut."Import Result Code":=DDSuppIn."Import Result Code";
            DDSuppOut."Import Result Message":=DDSuppIn."Import Result Message";
          END;
          "Assoc. Entry No." := DDSuppIn."Entry No.";
          DDSuppIn."Assoc. Entry No." := DDSuppOut."Entry No.";
          IF MODIFY THEN;

          IF DDSuppIn.MODIFY THEN;

        END ELSE BEGIN
          ArrayOfErrorVar[1] := '71';
          ArrayOfErrorVar[2] := DDSuppIn.TABLECAPTION;
          ArrayOfErrorVar[3] := DDSuppIn.FIELDCAPTION("Entry No.");
          ArrayOfErrorVar[4] := FORMAT(DDSuppIn."Entry No.");
          ErrorHandler(1012);
          EXIT;
        END;
      END;
    END;

    PROCEDURE ShipmentConfirmation@14();
    VAR
      DDHeaderIn@1000 : Record 50061;
      DDLineIn@1003 : Record 50062;
      DDHeaderOut@1005 : Record 50061;
      TempDDHeaderOut@1006 : Record 50061;
      DDLineOut@1004 : Record 50062;
      TempDDLineOut@1007 : Record 50062;
      TempDDLine@1000000002 : TEMPORARY Record 50062;
      FldRef@1001 : FieldRef;
      DDHeaderOut2@1000000000 : Record 50061;
      DDHeaderIn2@1000000001 : Record 50061;
      LocItem@1115500001 : Record 27;
      LocDDHeader@1115500002 : Record 50061;
      LocDDLine@1115500003 : Record 50062;
      LastNo@1115500004 : Integer;
      FPCGeneralSetup@1000000003 : Record 50055;
      InterfaceProcessMgt@1000000004 : Codeunit 50087;
      "**** HME *********************"@1000000005 : Integer;
      DPDSetupL@1000000006 : Record 50221;
    BEGIN
      FldRef := GlobalRecRef.FIELD(79501); //"Entry No."

      DDLineIn.GET(FldRef.VALUE);
      WITH DDLineOut DO BEGIN
        SETCURRENTKEY("Record ID","DD Status","Document Entry Type","Document Type","Document No.","DD Pos. No.",Direction);
        SETRANGE("Record ID",'51_L');
        SETRANGE("DD Status",DDLineOut."DD Status"::"status change");
        SETRANGE("Document Entry Type",DDLineIn."Document Entry Type");
        SETRANGE("Document Type",DDLineIn."Document Type");
        SETRANGE("No.",DDLineIn."No.");
        SETRANGE(Direction,DDLineOut.Direction::out);
        SETRANGE("Document No.",DDLineIn."Document No.");
        SETRANGE("DD Pos. No.",DDLineIn."DD Pos. No.");
        TempDDLineOut.SETCURRENTKEY("Record ID","DD Status","Document Entry Type","Document Type",
          "Document No.","DD Pos. No.",Direction);
        TempDDLineOut.COPYFILTERS(DDLineOut);
        IF TempDDLineOut.COUNT > 1 THEN BEGIN
          ArrayOfErrorVar[1] := DDLineIn.TABLECAPTION;
          ArrayOfErrorVar[2] := DDLineIn.FIELDCAPTION("Entry No.");
          ArrayOfErrorVar[3] := FORMAT(DDLineIn."Entry No.");
          ErrorHandler(1011);
        END;
        IF FIND('-') THEN BEGIN

          //fr Roll-back einer Transaktion
          TempDDLine.INIT;
          TempDDLine := DDLineOut;
          IF TempDDLine.INSERT THEN;

          IF NOERRORS THEN
            "DD Status" := DDLineOut."DD Status"::shipment;
            //"Assoc. Entry No." := DDLineIn."Entry No.";  //P0198
            "Qty. to Ship" := DDLineIn."Qty. to Ship";
            "Confirmation Date":=WORKDATE;
            DDHeaderOut2.GET("Header Entry No.");
            DDHeaderOut2."DD Status":=DDHeaderOut2."DD Status"::shipment;
            DDHeaderOut2.MODIFY;

          IF MODIFY THEN;

          DDLineIn."DD Status" := DDLineIn."DD Status"::shipment;
          DDLineIn.Company := DDLineOut.Company;
          DDLineIn."Assoc. Entry No." := DDLineOut."Entry No.";

          // A/gob-lku/08.01.2013/P0725
          //IF DDLineIn."Tracking No."<>'' THEN
          IF DDLineIn."Tracking No." <> '' THEN BEGIN
            //OrderLogText:=COPYSTR('Interim Track. ID: '+DDLineIn."Tracking No.",1,STRLEN(OrderLogText))
            // A/gob-lku/09.01.2013/P0730
            //OrderLogText := COPYSTR('Interim Track. ID: ' + DDLineIn."Tracking No.",1,STRLEN(OrderLogText));
            OrderLogText := COPYSTR('Interim Track. ID: ' + DDLineIn."Tracking No.",1,MAXSTRLEN(OrderLogText));
            // E/gob-lku/09.01.2013/P0730

            //H1268 20.06.14 DMA +++++++++++++++++++++++++++++++++
            DPDSetupL.GET;
            IF DPDSetupL."Shipping Agent DPD" = DDLineOut."Shipping Agent Code" THEN
              //H1416 28.07.14 DMA +++++++++++++++++++++++++++++++++++++++++++++++++
              IF STRLEN(DDLineIn."Tracking No.") >= 15 THEN BEGIN
              //H1416 28.07.14 DMA -------------------------------------------------
              OrderLogText := COPYSTR('Interim Track. ID: ' + COPYSTR(DDLineIn."Tracking No.", 1, STRLEN(
                DDLineIn."Tracking No.")-1),1,MAXSTRLEN(OrderLogText));
              //H1416 28.07.14 DMA +++++++++++++++++++++++++++++++++++++++++++++++++
              END;
              //H1416 28.07.14 DMA -------------------------------------------------

            //H1268 20.06.14 DMA ---------------------------------

            InsertDDTracking2DHL(DDLineOut."Order No. Navision",DDLineOut."Line No.",DDLineIn."Tracking No.",DDLineIn);

          //ELSE
          END ELSE
          // E/gob-lku/08.01.2013/P0725
            OrderLogText := 'Shipping Confirmation';
          //a/P0475/gob-sfe/22.12.2012
          //OrderStatusLog.CreateOrderStatus(0,DDLineOut."Document No.",DDLineOut."Line No.",'20',OrderLogText);
          OrderStatusLog.CreateOrderStatus(0,DDLineOut."Order No. Navision",DDLineOut."Line No.",'20',OrderLogText);
          //e/P0475/gob-sfe/22.12.2012
          //A/P0564
          CLEAR(InterfaceProcessMgt);
          FPCGeneralSetup.GET;
          FPCGeneralSetup.TESTFIELD("Interface Code DocData");
          FPCGeneralSetup.TESTFIELD("Status Pick");
          FPCGeneralSetup.TESTFIELD("Status Transport");
          FPCGeneralSetup.TESTFIELD("Trigger Docdata Interface");
          IF InterfaceProcessMgt.TriggerActive(FPCGeneralSetup."Trigger Docdata Interface") THEN
            InterfaceProcessMgt.UpdateProcessLogForInterface(DDLineOut."Order No. Navision",
                                                             DDLineOut."Line No.",
                                                             FPCGeneralSetup."Interface Code DocData",
                                                             FPCGeneralSetup."Status Pick",
                                                             FPCGeneralSetup."Status Transport",
                                                             FPCGeneralSetup."Trigger Docdata Interface");
          //E/P0564
          IF DDLineIn.MODIFY THEN;
        END ELSE BEGIN
          ArrayOfErrorVar[1] := '51_L';
          ArrayOfErrorVar[2] := DDLineIn.TABLECAPTION;
          ArrayOfErrorVar[3] := DDLineIn.FIELDCAPTION("Entry No.");
          ArrayOfErrorVar[4] := FORMAT(DDLineIn."Entry No.");
          ErrorHandler(1012);
          DDHeaderIn2.GET(DDLineIn."Header Entry No.");
          DDHeaderIn2."DD Status":=DDHeaderIn2."DD Status"::error;
          DDHeaderIn2."Error Description":='Error during checking the Lines';
          IF DDHeaderIn2.MODIFY THEN;
          IF DDHeaderOut2.GET(DDHeaderIn2."Assoc. Entry No.") THEN BEGIN
            DDHeaderOut2."DD Status":=DDHeaderOut2."DD Status"::error;
            DDHeaderOut2."Error Description":='Error during checking the Lines';
            IF DDHeaderOut2.MODIFY THEN;
          END;
        END;
      END; //With
    END;

    PROCEDURE ManifestShippingConfirmation@1000000020();
    VAR
      DDHeaderIn@1000 : Record 50061;
      DDLineIn@1003 : Record 50062;
      DDHeaderOut@1005 : Record 50061;
      TempDDHeaderOut@1006 : Record 50061;
      DDLineOut@1004 : Record 50062;
      TempDDLineOut@1007 : Record 50062;
      TempDDLine@1000000002 : TEMPORARY Record 50062;
      FldRef@1001 : FieldRef;
      DDHeaderOut2@1000000000 : Record 50061;
      DDHeaderIn2@1000000001 : Record 50061;
      LocItem@1115500001 : Record 27;
      LocDDHeader@1115500002 : Record 50061;
      LocDDLine@1115500003 : Record 50062;
      LastNo@1115500004 : Integer;
      FPCGeneralSetup@1000000003 : Record 50055;
      InterfaceProcessMgt@1000000004 : Codeunit 50087;
    BEGIN
      FldRef := GlobalRecRef.FIELD(79501); //"Entry No."

      DDLineIn.GET(FldRef.VALUE);
      WITH DDLineOut DO BEGIN
        SETCURRENTKEY("Record ID","DD Status","Document Entry Type","Document Type","Document No.","DD Pos. No.",Direction);
        SETRANGE("Record ID",'51_L');
        //a/P0155/gob-sfe/08.08.12
        //auch bei Teilrckmeldung manifest bercksichtigen
        //SETRANGE("DD Status",DDLineOut."DD Status"::shipment);
        SETFILTER("DD Status",'%1|%2',"DD Status"::manifest,"DD Status"::shipment);
        //e/P0155/gob-sfe/08.08.12
        SETRANGE("Document Entry Type",DDLineIn."Document Entry Type");
        SETRANGE("Document Type",DDLineIn."Document Type");
        SETRANGE("No.",DDLineIn."No.");
        SETRANGE(Direction,DDLineOut.Direction::out);
        SETRANGE("Document No.",DDLineIn."Document No.");
        SETRANGE("DD Pos. No.",DDLineIn."DD Pos. No.");
        TempDDLineOut.SETCURRENTKEY("Record ID","DD Status","Document Entry Type","Document Type",
          "Document No.","DD Pos. No.",Direction);
        TempDDLineOut.COPYFILTERS(DDLineOut);
        IF TempDDLineOut.COUNT > 1 THEN BEGIN
          ArrayOfErrorVar[1] := DDLineIn.TABLECAPTION;
          ArrayOfErrorVar[2] := DDLineIn.FIELDCAPTION("Entry No.");
          ArrayOfErrorVar[3] := FORMAT(DDLineIn."Entry No.");
          ErrorHandler(1011);
        END;
        IF FIND('-') THEN BEGIN

          //fr Roll-back einer Transaktion
          TempDDLine.INIT;
          TempDDLine := DDLineOut;
          IF TempDDLine.INSERT THEN;

          IF NOERRORS THEN BEGIN
            "DD Status" := DDLineOut."DD Status"::manifest;
            //"Assoc. Entry No." := DDLineIn."Entry No.";  //P0198
            "Qty. to Ship" := DDLineIn."Qty. to Ship";
            "Manifestation Date":=WORKDATE;
            DDHeaderOut2.GET("Header Entry No.");
            DDHeaderOut2."DD Status":=DDHeaderOut2."DD Status"::manifest;
            DDHeaderOut2.MODIFY;

          END;
          //A,gob-dst,P0231
          DDLineOut."Shipment Date" := DDLineIn."Shipment Date";
          //E,gob-dst,P0231
          IF MODIFY THEN;

          DDLineIn."DD Status" := DDLineIn."DD Status"::manifest;
          DDLineIn."Assoc. Entry No." := DDLineOut."Entry No.";

          IF DDLineIn."Tracking No."<>'' THEN BEGIN
            OrderLogText:='Tracking ID: '+DDLineIn."Tracking No.";
            //a/gob-sfe/P0148
            //a/gob-sfe/P0518
            //InsertDDTracking2DHL(DDLineOut."Document No.",DDLineOut."Line No.",DDLineIn."Tracking No.",DDLineIn);
            InsertDDTracking2DHL(DDLineOut."Order No. Navision",DDLineOut."Line No.",DDLineIn."Tracking No.",DDLineIn);
            //e/gob-sfe/P0518
            //e/gob-sfe/P0148
          END ELSE
            OrderLogText:='Shipping Manifestion';
          //e/P0475/gob-sfe/22.12.2012
          //OrderStatusLog.CreateOrderStatus(0,DDLineOut."Document No.",DDLineOut."Line No.",'21',OrderLogText);
          OrderStatusLog.CreateOrderStatus(0,DDLineOut."Order No. Navision",DDLineOut."Line No.",'21',OrderLogText);
          //e/P0475/gob-sfe/22.12.2012
          //A/P0564
          CLEAR(InterfaceProcessMgt);
          FPCGeneralSetup.GET;
          FPCGeneralSetup.TESTFIELD("Status Pick");
          FPCGeneralSetup.TESTFIELD("Status Transport");
          FPCGeneralSetup.TESTFIELD("Interface Code DocData");
          FPCGeneralSetup.TESTFIELD("Trigger Docdata Interface");
          IF InterfaceProcessMgt.TriggerActive(FPCGeneralSetup."Trigger Docdata Interface") THEN
            InterfaceProcessMgt.UpdateProcessLogForInterface(DDLineOut."Order No. Navision",
                                                             DDLineOut."Line No.",
                                                             FPCGeneralSetup."Interface Code DocData",
                                                             FPCGeneralSetup."Status Pick",
                                                             FPCGeneralSetup."Status Transport",
                                                             FPCGeneralSetup."Trigger Docdata Interface");
          //E/P0564
          IF DDLineIn.MODIFY THEN;
        END ELSE BEGIN
          ArrayOfErrorVar[1] := '51_L';
          ArrayOfErrorVar[2] := DDLineIn.TABLECAPTION;
          ArrayOfErrorVar[3] := DDLineIn.FIELDCAPTION("Entry No.");
          ArrayOfErrorVar[4] := FORMAT(DDLineIn."Entry No.");
          ErrorHandler(1012);
          DDHeaderIn2.GET(DDLineIn."Header Entry No.");
          DDHeaderIn2."DD Status":=DDHeaderIn2."DD Status"::error;
          DDHeaderIn2."Error Description":='Error during checking the Lines';
          IF DDHeaderIn2.MODIFY THEN;
          IF DDHeaderOut2.GET(DDHeaderIn2."Assoc. Entry No.") THEN BEGIN
            DDHeaderOut2."DD Status":=DDHeaderOut2."DD Status"::error;
            DDHeaderOut2."Error Description":='Error during checking the Lines';
            IF DDHeaderOut2.MODIFY THEN;
          END;
        END;
      END; //With
    END;

    PROCEDURE StockMutation@1000000021();
    VAR
      DDHeaderIn@1000 : Record 50061;
      DDLineIn@1003 : Record 50062;
      DDHeaderOut@1005 : Record 50061;
      TempDDHeaderOut@1006 : Record 50061;
      DDLineOut@1004 : Record 50062;
      TempDDLineOut@1007 : Record 50062;
      TempDDLine@1000000002 : TEMPORARY Record 50062;
      FldRef@1001 : FieldRef;
      DDHeaderOut2@1000000000 : Record 50061;
      DDHeaderIn2@1000000001 : Record 50061;
      LocItem@1115500001 : Record 27;
      LocDDHeader@1115500002 : Record 50061;
      LocDDLine@1115500003 : Record 50062;
      LastNo@1115500004 : Integer;
    BEGIN
      FldRef := GlobalRecRef.FIELD(79501); //"Entry No."

      DDLineIn.GET(FldRef.VALUE);
      //P0460/gob-sfe/18.10.12
      IF DDLineIn."Error Code"<>'' THEN
        EXIT;
      //P0460/gob-sfe/18.10.12

      WITH DDLineOut DO BEGIN
        SETCURRENTKEY("Record ID","DD Status","Document Entry Type","Document Type","Document No.","DD Pos. No.",Direction);
        SETRANGE("Record ID",'60');
        //P0460/gob-sfe/18.10.12
        //SETRANGE("DD Status",DDLineOut."DD Status"::transmitted);
        SETFILTER("DD Status",'%1|%2',DDLineOut."DD Status"::transmitted,DDLineOut."DD Status"::shipment);
        //P0460/gob-sfe/18.10.12
        SETRANGE("Document Entry Type",DDLineIn."Document Entry Type");
        // S/P0603
        //setfilter transfer / order
        //SETRANGE("Document Type",DDLineIn."Document Type");
        SETFILTER("Document Type",'%1|%2',DDLineIn."Document Type" :: Order,DDLineIn."Document Type" :: Transfer);
        // E/P0603

        SETRANGE("No.",DDLineIn."No.");
        SETRANGE(Direction,DDLineOut.Direction::out);
        SETRANGE("Document No.",DDLineIn."Document No.");
        SETRANGE("No.",DDLineIn."No.");
        TempDDLineOut.SETCURRENTKEY("Record ID","DD Status","Document Entry Type","Document Type",
          "Document No.","DD Pos. No.",Direction);
        TempDDLineOut.COPYFILTERS(DDLineOut);
        IF TempDDLineOut.COUNT > 1 THEN BEGIN
          ArrayOfErrorVar[1] := DDLineIn.TABLECAPTION;
          ArrayOfErrorVar[2] := DDLineIn.FIELDCAPTION("Entry No.");
          ArrayOfErrorVar[3] := FORMAT(DDLineIn."Entry No.");
          ErrorHandler(1011);
        END;
        IF FIND('-') THEN BEGIN

          //fr Roll-back einer Transaktion
          TempDDLine.INIT;
          TempDDLine := DDLineOut;
          IF TempDDLine.INSERT THEN;

          IF NOERRORS THEN BEGIN //P0460/gob-sfe/18.10.12
            "DD Status" := DDLineOut."DD Status"::shipment;
            "Assoc. Entry No." := DDLineIn."Entry No.";
            "Qty. to Ship" := DDLineIn."Quantity Good";
            "Confirmation Date":=WORKDATE;
            DDHeaderOut2.GET("Header Entry No.");
            DDHeaderOut2."DD Status":=DDHeaderOut2."DD Status"::shipment;
            DDHeaderOut2.MODIFY;
          END; //P0460/gob-sfe/18.10.12
          IF MODIFY THEN;
          // S/P0603
          //fr transfer daten zurckschreiben
          DDLineIn."Document Type" := DDLineOut."Document Type";
          DDLineIn."Order No. Navision" := DDLineOut."Order No. Navision";
          // E/P0603

          DDLineIn."DD Status" := DDLineIn."DD Status"::shipment;
          DDLineIn.Company := DDLineOut.Company;
          DDLineIn."Assoc. Entry No." := DDLineOut."Entry No.";
          OrderStatusLog.CreateOrderStatus(1,DDLineIn."Document No.",DDLineIn."Line No.",'P40','partial shipment');

          IF DDLineIn.MODIFY THEN;
        END ELSE BEGIN
          ArrayOfErrorVar[1] := '20';
          ArrayOfErrorVar[2] := DDLineIn.TABLECAPTION;
          ArrayOfErrorVar[3] := DDLineIn.FIELDCAPTION("Entry No.");
          ArrayOfErrorVar[4] := FORMAT(DDLineIn."Entry No.");
          ErrorHandler(1012);
          DDHeaderIn2.GET(DDLineIn."Header Entry No.");
          DDHeaderIn2."DD Status":=DDHeaderIn2."DD Status"::error;
          DDHeaderIn2."Error Description":='Error during checking the Lines';
          IF DDHeaderIn2.MODIFY THEN;
          IF DDHeaderOut2.GET(DDHeaderIn2."Assoc. Entry No.") THEN BEGIN
            DDHeaderOut2."DD Status":=DDHeaderOut2."DD Status"::error;
            DDHeaderOut2."Error Description":='Error during checking the Lines';
            IF DDHeaderOut2.MODIFY THEN;
          END;
        END;
      END; //With
    END;

    PROCEDURE SetArticleImportResult@1000000024();
    VAR
      DDItemIn@1003 : Record 50059;
      TempDDItemOut@1006 : Record 50059;
      DDItemOut@1004 : Record 50059;
      FldRef@1001 : FieldRef;
    BEGIN
      FldRef := GlobalRecRef.FIELD(79501); //"Entry No."

      DDItemIn.GET(FldRef.VALUE);
      WITH DDItemOut DO BEGIN
        SETCURRENTKEY("Record ID",Direction,"No.","Trans. Status");
        SETRANGE("Record ID",'53');
        SETRANGE("No.",DDItemIn."No.");
        SETRANGE("Trans. Status",DDItemOut."Trans. Status"::transmitted);
        SETRANGE(Direction,DDItemOut.Direction::out);
        SETFILTER("Import Result Code",'%1','');
        TempDDItemOut.SETCURRENTKEY("Record ID",Direction,"No.","Trans. Status");
        TempDDItemOut.COPYFILTERS(DDItemOut);
        IF TempDDItemOut.COUNT > 1 THEN BEGIN
          ArrayOfErrorVar[1] := DDItemIn.TABLECAPTION;
          ArrayOfErrorVar[2] := DDItemIn.FIELDCAPTION("Entry No.");
          ArrayOfErrorVar[3] := FORMAT(DDItemIn."Entry No.");
          ErrorHandler(1011);
          EXIT;
        END;
        IF FIND('-') THEN BEGIN
          IF NOERRORS THEN BEGIN
            DDItemOut."Import Result Code":=DDItemIn."Import Result Code";
            DDItemOut."Import Result Message":=DDItemIn."Import Result Message";
          END;
          //"Assoc. Entry No." := DDItemIn."Entry No.";
          //DDItemIn."Assoc. Entry No.":=DDItemOut."Entry No.";
          IF MODIFY THEN;

          //IF DDItemIn.MODIFY THEN;

        END ELSE BEGIN
          ArrayOfErrorVar[1] := '16';
          ArrayOfErrorVar[2] := DDItemIn.TABLECAPTION;
          ArrayOfErrorVar[3] := DDItemIn.FIELDCAPTION("Entry No.");
          ArrayOfErrorVar[4] := FORMAT(DDItemIn."Entry No.");
          ErrorHandler(1012);
          EXIT;
        END;
      END;
    END;

    PROCEDURE SetToError@29();
    VAR
      DDLine@1000 : Record 50062;
      DDHeader@1001 : Record 50061;
      FldRef@1002 : FieldRef;
      FldRef2@1003 : FieldRef;
      ErrorCode@1004 : Code[10];
      ErrorDescription@1005 : Text[100];
    BEGIN
      //A/08.01.2004/gob-ko/
      EXIT;
      //E/08.01.2004/gob-ko/

      //Status in ORDH,ORDL,PORH,PORL zurcksetzen
      IF TempDDHeader.FIND('-') THEN
        REPEAT
          IF DDHeader.GET(TempDDHeader."Entry No.") THEN BEGIN
            DDHeader := TempDDHeader;
            IF DDHeader.MODIFY THEN;
          END;
        UNTIL TempDDHeader.NEXT = 0;
      IF TempDDLine.FIND('-') THEN
        REPEAT
          IF DDLine.GET(TempDDLine."Entry No.") THEN BEGIN
            DDLine := TempDDLine;
            IF DDLine.MODIFY THEN;
          END;
        UNTIL TempDDLine.NEXT = 0;

      //Status in ORDC,RECH,RECL setzen
      DDLine.RESET;
      DDLine.SETRANGE("Header Entry No.",HeaderEntryNo);
      DDLine.SETFILTER("DD Status",'<>%1',DDLine."DD Status"::error);
      DDLine.MODIFYALL("DD Status",DDLine."DD Status"::error);

      IF DDHeader.GET(HeaderEntryNo) THEN BEGIN
        DDHeader."DD Status" := DDHeader."DD Status"::error;
        IF DDHeader.MODIFY THEN;
      END;
    END;

    LOCAL PROCEDURE HASVALUE@32(Value@1000 : Variant) : Boolean;
    VAR
      HasValue@1001 : Boolean;
      Int@1002 : Integer;
      Dec@1003 : Decimal;
      D@1007 : Date;
      T@1008 : Time;
    BEGIN
      CASE TRUE OF
        Value.ISBOOLEAN :
          HasValue := Value;
        Value.ISOPTION :
          HasValue := TRUE;
        Value.ISINTEGER :
          BEGIN
            Int := Value;
            HasValue := Int <> 0;
          END;
        Value.ISDECIMAL :
          BEGIN
            Dec := Value;
            HasValue := Dec <> 0;
          END;
        Value.ISDATE :
          BEGIN
            D := Value;
            HasValue := D <> 0D;
          END;
        Value.ISTIME :
          BEGIN
            T := Value;
            HasValue := T <> 0T;
          END;
        Value.ISBINARY :
          HasValue := FALSE;
        ELSE
          HasValue := FORMAT(Value) <> '';
      END;
      EXIT(HasValue);
    END;

    PROCEDURE READFFLPOSITIION@1108300006(paFileName@1108300000 : Text[250];Record_ID@1000 : ' ,Header,Trailer') : Text[1024];
    VAR
      Text@1108300001 : Text[1024];
      Pointer@1001 : Integer;
      k@1002 : Integer;
    BEGIN
      f.TEXTMODE(TRUE);
      IF f.OPEN(paFileName) THEN BEGIN
        CASE Record_ID OF
          Record_ID::Header:
            Pointer := 0;
          Record_ID::Trailer:
            Pointer := f.LEN-49;
        END;
        IF f.LEN > 0 THEN BEGIN
          f.SEEK(Pointer);
          f.READ(Text);
        END;
        f.CLOSE;
        EXIT(Text);
      END;
    END;

    PROCEDURE CHECKFFLEXISTS@2() : Boolean;
    BEGIN
      EXIT(FileCounter > 0)
    END;

    PROCEDURE SETFILENAME@7(File@1001 : Text[1024]) : Text[1024];
    VAR
      FilePath@1002 : Text[1024];
      Path@1000 : Text[250];
    BEGIN
      //IF GUIALLOWED AND (COMPANYNAME<>'KCD-NWL') THEN Path:='v:\kanebo\in'
      //ELSE

      Path := DDSetup."Interface Folder (In)";

      IF STRLEN(Path + '\' + File) > 1024 THEN
        ErrorHandler(1001);
      EXIT(STRSUBSTNO('%1%2%3',Path,'\',File));
    END;

    PROCEDURE GETFILENAME@41(File@1000 : Text[1024]) : Text[50];
    BEGIN
      EXIT(
        REVSTR(
          COPYSTR(
            REVSTR(File),1,STRPOS(REVSTR(File),'\')-1)));
    END;

    PROCEDURE GETFILETYPE@15(FlatFile@1001 : Text[1024]) Extension : Text[3];
    VAR
      Text@1000 : Text[30];
    BEGIN
      Extension := COPYSTR(FlatFile,1,2);

      EXIT(UPPERCASE(Extension));
    END;

    PROCEDURE REVSTR@35(paString@1108300000 : Text[1024]) : Text[1024];
    VAR
      Length@1108300001 : Integer;
      i@1108300002 : Integer;
      Code@1108300003 : Text[1024];
      RevCode@1108300004 : Text[1024];
      OK@1000 : Boolean;
    BEGIN
      //Text wird gedreht

      Code := paString;
      OK := TRUE;
      FOR i := 1 TO STRLEN(paString) DO BEGIN
        IF  OK THEN BEGIN
          RevCode := RevCode + COPYSTR(Code,STRLEN(Code),1);
          Code := DELSTR(Code,STRLEN(Code),1);
          IF STRLEN(Code) = 0 THEN
            OK := FALSE;
        END;
      END;
      EXIT(RevCode);
    END;

    LOCAL PROCEDURE CHECKFIELD@26(TableNumber@1001 : Integer;FieldNumber@1002 : Integer) : Boolean;
    VAR
      Field@1000 : Record 2000000041;
    BEGIN
      IF Field.GET(TableNumber,FieldNumber) THEN
        EXIT(TRUE)
      ELSE
        EXIT(FALSE);
    END;

    PROCEDURE GETSKUENTRYNO@20() : Integer;
    VAR
      DDItem@1000 : Record 50059;
    BEGIN
      DDItem.LOCKTABLE(TRUE); //a/P0610/gob-sfe/27.11.12
      IF DDItem.FIND('+') THEN
        EXIT(DDItem."Entry No." + 1)
      ELSE
        EXIT(1);
    END;

    PROCEDURE GETORDHENTRYNO@11() : Integer;
    VAR
      DDHeader@1000 : Record 50061;
    BEGIN
      DDHeader.LOCKTABLE(TRUE); //a/P0610/gob-sfe/27.11.12
      IF DDHeader.FIND('+') THEN
        EXIT(DDHeader."Entry No." + 1)
      ELSE
        EXIT(1);
    END;

    PROCEDURE GETORDLENTRYNO@8() : Integer;
    VAR
      DDLine@1000 : Record 50062;
    BEGIN
      DDLine.LOCKTABLE(TRUE); //a/P0610/gob-sfe/27.11.12
      IF DDLine.FIND('+') THEN
        EXIT(DDLine."Entry No." + 1)
      ELSE
        EXIT(1);
    END;

    PROCEDURE GETSupplierENTRYNO@1000000019() : Integer;
    VAR
      DDSupp@1000 : Record 50064;
    BEGIN
      DDSupp.LOCKTABLE(TRUE); //a/P0610/gob-sfe/27.11.12
      IF DDSupp.FIND('+') THEN
        EXIT(DDSupp."Entry No." + 1)
      ELSE
        EXIT(1);
    END;

    PROCEDURE CheckReference@27(DDDataElement@1000 : Record 50058);
    BEGIN
      IF DDDataElement."Record Reference" = 0 THEN BEGIN
        ArrayOfErrorVar[1] := DDDataElement.TABLECAPTION;
        ArrayOfErrorVar[2] := FORMAT(DDDataElement."Table ID");
        ArrayOfErrorVar[3] := DDDataElement.FIELDCAPTION("Field ID");
        ArrayOfErrorVar[4] := DDDataElement."Field ID";
        ErrorHandler(1008)
      END;

      IF DDDataElement."Field Reference" = 0 THEN BEGIN
        ArrayOfErrorVar[1] := DDDataElement.TABLECAPTION;
        ArrayOfErrorVar[2] := FORMAT(DDDataElement."Table ID");
        ArrayOfErrorVar[3] := DDDataElement.FIELDCAPTION("Field ID");
        ArrayOfErrorVar[4] := DDDataElement."Field ID";
        ErrorHandler(1009)
      END;
    END;

    PROCEDURE CharDef@16(VAR Char@1000 : ARRAY [2,10] OF Char);
    BEGIN
      Char[1,1] := 196;
      Char[1,2] := 214;
      Char[1,3] := 220;
      Char[1,4] := 223;
      Char[1,5] := 228;
      Char[1,6] := 246;
      Char[1,7] := 252;

      Char[2,1] := 142;
      Char[2,2] := 153;
      Char[2,3] := 154;
      Char[2,4] := 225;
      Char[2,5] := 132;
      Char[2,6] := 148;
      Char[2,7] := 129;
    END;

    PROCEDURE CharToANSI@23(Text@1000 : Text[250]) : Text[250];
    VAR
      Position@1001 : Integer;
      Char@1002 : ARRAY [2,10] OF Char;
      i@1003 : Integer;
    BEGIN
      CharDef(Char);
      FOR Position := 1 TO STRLEN(Text) DO
        FOR i := 1 TO 7 DO
          IF Text[Position] = Char[2,i] THEN
            Text[Position] := Char[1,i];
      EXIT(Text)
    END;

    PROCEDURE CharToOEM@22(Text@1000 : Text[250]) : Text[250];
    VAR
      Position@1001 : Integer;
      Char@1002 : ARRAY [2,10] OF Char;
      i@1003 : Integer;
    BEGIN
      CharDef(Char);
      FOR Position := 1 TO STRLEN(Text) DO
        FOR i := 1 TO 7 DO
          IF Text[Position] = Char[1,i] THEN
            Text[Position] := Char[2,i];
      EXIT(Text)
    END;

    PROCEDURE FORMATDATE@12(Text@1000 : Text[8]) : Date;
    VAR
      Date@1001 : Date;
    BEGIN
      //Datumsformat : YYYYMMTT
      IF Text = '' THEN
        EXIT(0D);

      EVALUATE(Date,
        STRSUBSTNO('%1%2%3',
          COPYSTR(Text,7,2),
          COPYSTR(Text,5,2),
          COPYSTR(Text,1,4)));
      EXIT(Date);
    END;

    PROCEDURE ISFLOWFIELD@28(TableNumber@1001 : Integer;FieldNumber@1000 : Integer) : Boolean;
    VAR
      Field@1002 : Record 2000000041;
    BEGIN
      GETFIELD(TableNumber,FieldNumber,Field);
      EXIT(Field.Class = Field.Class::FlowField);
    END;

    LOCAL PROCEDURE GETFIELD@34(TableNumber@1001 : Integer;FieldNumber@1002 : Integer;VAR Field2@1003 : Record 2000000041);
    VAR
      Field@1000 : Record 2000000041;
    BEGIN
      IF Field.GET(TableNumber,FieldNumber) THEN
        Field2 := Field;
    END;

    PROCEDURE CHECKENVIRONVAR@42(Value@1000 : Text[30]) : Boolean;
    BEGIN
      CASE Value OF

        '%TRANSACTION_ID%',
        '%NO_DETAIL_RECORDS%',
        '%NO_HDR_RECORDS%',
        '%PROD_STAT%',
        '%DATA_TYPE%',
        '%TRAN_NO%',
        '%NO_DETAIL_RECORDS%',
        '%NO_DETAIL_RECORDS%',
        '%NO_LINE_ITEMS%':

           EXIT(TRUE);
        ELSE BEGIN
          ArrayOfErrorVar[1] := Value;
          ErrorHandler(1016)
        END;

      END;
    END;

    PROCEDURE GETENVIRONVAR@40(Value@1000 : Text[30];DDDataElement@1001 : Record 50058) : Text[250];
    VAR
      No@1002 : Code[20];
    BEGIN
      CASE Value OF

        '%TRAN_NO%'          : EXIT(TransNo);
        '%NO_LINE_ITEMS%'    : EXIT(FORMAT(NO_LINE_ITEMS));
        '%TRANSACTION_ID%'   : EXIT(TRANSACTION_ID);
        '%NO_HDR_RECORDS%'   : EXIT(FORMAT(NO_HDR_RECORDS));
        '%NO_DETAIL_RECORDS%':
          CASE DDDataElement."Table ID" OF
            DDDataElement."Table ID"::"17":
              EXIT(FORMAT(NO_DETAIL_RECORDS));
            ELSE
              EXIT(FORMAT(NO_DETAIL_RECORDS_IN_FILE));
          END;
      END;
    END;

    PROCEDURE ErrorHandler@4(ErrorNo@1000 : Integer);
    VAR
      FldRef@1001 : FieldRef;
      FldRef2@1002 : FieldRef;
      FldRef3@1003 : FieldRef;
    BEGIN
      FldRef := GlobalRecRef.FIELD(79507); //"Error Code";
      FldRef.VALUE := FORMAT(ErrorNo);

      FldRef2 := GlobalRecRef.FIELD(79511); //"Error Description";

      CASE ErrorNo OF
        1001:
          FldRef2.VALUE :=
            COPYSTR(
              Error001,
            STRPOS(Error001,':'),
            FldRef2.LENGTH);
        1002:
          FldRef2.VALUE :=
            COPYSTR(
              STRSUBSTNO(
                Error002,
                ArrayOfErrorVar[1],
                ArrayOfErrorVar[2],
                ArrayOfErrorVar[3]),
              STRPOS(Error002,':'),
              FldRef2.LENGTH);
        1003:
          FldRef2.VALUE :=
            COPYSTR(
              STRSUBSTNO(
                Error003,
                ArrayOfErrorVar[1],
                ArrayOfErrorVar[2],
                ArrayOfErrorVar[3]),
              STRPOS(Error003,':'),
              FldRef2.LENGTH);
        1004:
          FldRef2.VALUE :=
            COPYSTR(
              STRSUBSTNO(
                Error004,
                ArrayOfErrorVar[1],
                ArrayOfErrorVar[2],
                ArrayOfErrorVar[3]),
              STRPOS(Error004,':'),
              FldRef2.LENGTH);
        1005:
          FldRef2.VALUE :=
            COPYSTR(
              STRSUBSTNO(
                Error005,
                ArrayOfErrorVar[1],
                ArrayOfErrorVar[2],
                ArrayOfErrorVar[3]),
              STRPOS(Error005,':'),
              FldRef2.LENGTH);
        1006:
          FldRef2.VALUE :=
            COPYSTR(
              STRSUBSTNO(
                Error006,
                ArrayOfErrorVar[1]),
              STRPOS(Error006,':'),
              FldRef2.LENGTH);
        1007:
          FldRef2.VALUE :=
            COPYSTR(
              STRSUBSTNO(
                Error007,
                ArrayOfErrorVar[1]),
              STRPOS(Error007,':'),
              FldRef2.LENGTH);
        1008:
          FldRef2.VALUE :=
            COPYSTR(
            STRSUBSTNO(
              Error008,
                ArrayOfErrorVar[1],
                ArrayOfErrorVar[2],
                ArrayOfErrorVar[3],
                ArrayOfErrorVar[4]),
              STRPOS(Error008,':'),
              FldRef2.LENGTH);
        1009:
          FldRef2.VALUE :=
            COPYSTR(
              STRSUBSTNO(
                Error009,
                ArrayOfErrorVar[1],
                ArrayOfErrorVar[2],
                ArrayOfErrorVar[3],
                ArrayOfErrorVar[4]),
              STRPOS(Error009,':'),
              FldRef2.LENGTH);
        1010:
          FldRef2.VALUE :=
            COPYSTR(
              STRSUBSTNO(
                Error010,
                ArrayOfErrorVar[1]),
              STRPOS(Error010,':'),
              FldRef2.LENGTH);
        1011:
          FldRef2.VALUE :=
            COPYSTR(
              STRSUBSTNO(
                Error011,
                ArrayOfErrorVar[1],
                ArrayOfErrorVar[2],
                ArrayOfErrorVar[3]),
              STRPOS(Error011,':'),
              FldRef2.LENGTH);
        1012:
          FldRef2.VALUE :=
            COPYSTR(
              STRSUBSTNO(
                Error012,
                ArrayOfErrorVar[1],
                ArrayOfErrorVar[2],
                ArrayOfErrorVar[3],
                ArrayOfErrorVar[4]),
              STRPOS(Error012,':'),
              FldRef2.LENGTH);
        1013:
          FldRef2.VALUE :=
            COPYSTR(
              STRSUBSTNO(
                Error013,
                ArrayOfErrorVar[1],
                ArrayOfErrorVar[2]),
              STRPOS(Error013,':'),
              FldRef2.LENGTH);
        1014:
          FldRef2.VALUE :=
            COPYSTR(
              STRSUBSTNO(
                Error015,
                ArrayOfErrorVar[1],
                ArrayOfErrorVar[2]),
              STRPOS(Error014,':'),
              FldRef2.LENGTH);
        1015:
          FldRef2.VALUE :=
            COPYSTR(
              STRSUBSTNO(
                Error015,
                ArrayOfErrorVar[1]),
              STRPOS(Error015,':'),
              FldRef2.LENGTH);
        1016:
          FldRef2.VALUE :=
            COPYSTR(
              STRSUBSTNO(
                Error016,
                ArrayOfErrorVar[1]),
              STRPOS(Error016,':'),
              FldRef2.LENGTH);
        1018:
          FldRef2.VALUE := Error018;
      END;

      FldRef3 := GlobalRecRef.FIELD(79503); //"Trans. Satus";
      FldRef3.VALUE := 4;

      IF GlobalRecRef.MODIFY THEN;

      CLEAR(ArrayOfErrorVar);

      SendMail(FORMAT(FldRef2.VALUE));
    END;

    PROCEDURE NOERRORS@30() : Boolean;
    VAR
      FldREf@1000 : FieldRef;
    BEGIN
      FldREf := GlobalRecRef.FIELD(79507); //"Error Code";
      EXIT
       (NOT HASVALUE(FldREf.VALUE));
    END;

    PROCEDURE CreateBackupFile@3(File@1000 : Text[1024];Temp@1008 : Boolean) : Text[1024];
    VAR
      SalesSetup@1009 : Record 311;
      fIn@1001 : File;
      fOut@1003 : File;
      Text@1002 : Text[1024];
      Pointer@1004 : Integer;
      LineNo@1005 : Integer;
      BackUpFile@1006 : Text[1024];
      FileName@1007 : Text[1024];
    BEGIN
      IF File = '' THEN
        EXIT;
      DDSetup.GET;

      IF Temp THEN BEGIN
        SetTempPath;
        FileName := TempPath + '\' + GETFILENAME(File) + '.tmp';
        File     := DDSetup."Interface Backup Folder" + '\' + GETFILENAME(File) + '.bak';
      END ELSE BEGIN
        FileName := DDSetup."Interface Backup Folder" + '\' + File + '.bak';
        File     := DDSetup."Interface Folder (In)" + '\' + File;
      END;


      DDSetup.GET;
      CREATE(WshFileSystem);
      WshFileSystem.CopyFile(File,FileName,TRUE);
      //WshFileSystem.DeleteFile(File,TRUE);
      CLEAR(WshFileSystem);

      EXIT(BackUpFile)

      {
      fOut.CREATE(FileName);
      fOut.WRITEMODE(TRUE);
      fOut.TEXTMODE(TRUE);
      fOut.OPEN(FileName);

      BackUpFile := fOut.NAME;

      fIn.TEXTMODE(TRUE);
      fIn.OPEN(File);
      REPEAT
        LineNo += 1;
        fIn.READ(Text);
        Pointer := fIn.POS;
        IF Temp THEN
          fOut.WRITE('['+FORMAT(LineNo)+']' + Text)
        ELSE
          fOut.WRITE(Text);
        fOut.TRUNC;
      UNTIL fIn.POS = fIn.LEN;
      fIn.CLOSE;
      fOut.CLOSE;
      }
    END;

    PROCEDURE DeleteFile@33(FileName@1001 : Text[1024]);
    BEGIN
      IF EXISTS(FileName) THEN
        ERASE(FileName);
    END;

    PROCEDURE SetTempPath@25();
    BEGIN
      TempPath := ENVIRON('tmp');
      IF TempPath = '' THEN
        TempPath := ENVIRON('temp');
      IF TempPath = '' THEN
        TempPath := 'c:\temp';
    END;

    PROCEDURE SendMail@70701(ErrorText@1000 : Text[100]);
    VAR
      Mail@1001 : Codeunit 397;
      MailSend@1002 : Boolean;
      Text000@1006 : TextConst 'DEU=Ihr Mailclient lieferte die folgende Fehlermeldung.\;ENU=Your mail client has returned the following error.\';
    BEGIN
      {***
      IF NOT Mail.NewMessage(
        DDSetup."LM Mail Recipient",
        '',
        ErrorText,
        '',
        DDSetup."Interface Folder (In)"+'\'+FlatFileArr[FileCounter],
        FALSE)
      THEN
        ERROR(Text000 + FORMAT(Mail.GetErrorCode) + ' : ' + Mail.GetErrorDesc + '.');


      IF NOT DDSetup."LM send E-Mail" THEN
        EXIT;
      IF NOT CREATE(olApp) THEN
        EXIT;
      IF NOT CREATE(oSafeMailItem) THEN
        EXIT;

      olMailItem := olApp.Session.GetDefaultFolder(5).Items.Add;
      olMailItem.Subject(ErrorText);
      olMailItem.Attachments.Add(DDSetup."Interface Folder (In)"+'\'+FlatFileArr[FileCounter]);
      oSafeMailItem.Item := olMailItem;
      oSafeMailItem.AuthKey := 'GOB';
      oSafeMailItem.Recipients.Add(DDSetup."LM Mail Recipient");
      oSafeMailItem.Send;
      EXIT;
      } // complete deaktivated....SFE
    END;

    PROCEDURE InsertMARSalesOnDelete@1000000003(SalesHeader@1000000000 : Record 36);
    VAR
      SalesHeaderLM@1000000001 : Record 50061;
      SalesHeaderLM2@1000000002 : Record 50061;
      SalesLineLM@1000000004 : Record 50062;
      SalesLineLM2@1000000006 : Record 50062;
      SalesLine@1000000005 : Record 37;
      cuLMInterfaceOut@1000000003 : Codeunit 50051;
    BEGIN
      {
      //A/18.11.2003/gob-ko/
      WITH SalesHeader DO BEGIN

        IF "LM Entry No." = 0 THEN
          EXIT;

        IF NOT SalesHeaderLM.GET("LM Entry No.") THEN
          EXIT;

        IF SalesHeaderLM."Trans. Status" = SalesHeaderLM."Trans. Status"::"1" THEN BEGIN

          SalesHeaderLM2.INIT;
          SalesHeaderLM2 := SalesHeaderLM;
          SalesHeaderLM2."Entry No." := cuLMInterfaceOut.GETORDHENTRYNO;
          SalesHeaderLM2."Order No. Navision" := SalesHeader."No.";
          cuLMInterfaceOut.SetOrderNoHeader(SalesHeaderLM);
          SalesHeaderLM2."MARC Action" := SalesHeaderLM2."MARC Action"::"4";
          SalesHeaderLM2."Entry Date" := WORKDATE;
          SalesHeaderLM2."Entry Time" := TIME;
          SalesHeaderLM2."Trans. Status" := SalesHeaderLM2."Trans. Status"::"0";
          SalesHeaderLM2."File Name" := '';
          SalesHeaderLM2."File Position" := 0;
          SalesHeaderLM2."Record ID" := '';
          SalesHeaderLM2."Trans. No." := '';
          SalesHeaderLM2.INSERT;
        END;

        SalesHeaderLM."Trans. Status" := SalesHeaderLM."Trans. Status"::"5";
        SalesHeaderLM.MODIFY;

        SalesLine.RESET;
        SalesLine.SETRANGE("Document Type","Document Type");
        SalesLine.SETRANGE("Document No.","No.");
        IF SalesLine.FIND('-') THEN
          REPEAT
            IF SalesLineLM.GET(SalesLine."LM Entry No.") THEN BEGIN

              IF SalesLineLM."Trans. Status" = SalesLineLM."Trans. Status"::"1" THEN BEGIN
                SalesLineLM2.INIT;
                SalesLineLM2 := SalesLineLM;
                SalesLineLM2."Entry No." := cuLMInterfaceOut.GETORDLENTRYNO;
                SalesLineLM2."Document No." := SalesHeaderLM2."No.";
                SalesLineLM2."Order No. Navision" := SalesHeaderLM2."Order No. Navision";
                SalesLineLM2."Trans. Status" := SalesLineLM2."Trans. Status"::"0";
                SalesLineLM2."MARC Action" := SalesLineLM2."MARC Action"::"4";
                SalesLineLM2."Entry Date" := WORKDATE;
                SalesLineLM2."Entry Time" := TIME;
                SalesLineLM2."Header Entry No." := SalesHeaderLM."Entry No.";
                SalesLineLM2."File Name" := '';
                SalesLineLM2."Trans. No." := '';
                SalesLineLM2."Record ID" := '';
                SalesLineLM2."File Position" := 0;
                SalesLineLM2.INSERT;
                SalesLineLM2."Header Entry No." := SalesHeaderLM2."Entry No.";
                SalesLineLM2.MODIFY;

              END;

              SalesLineLM."Trans. Status" := SalesLineLM."Trans. Status"::"5";
              SalesLineLM.MODIFY;

            END;
          UNTIL SalesLine.NEXT = 0;

      END;
      //E/18.11.2003/gob-ko/
      }
    END;

    PROCEDURE InsertMARPurchOnDelete@1000000004(PurchHeader@1000000000 : Record 38);
    VAR
      PurchHeaderLM@1000000006 : Record 50061;
      PurchHeaderLM2@1000000005 : Record 50061;
      PurchLineLM@1000000004 : Record 50062;
      PurchLineLM2@1000000003 : Record 50062;
      PurchLine@1000000002 : Record 39;
      cuLMInterfaceOut@1000000001 : Codeunit 50051;
    BEGIN
      {
      //A/18.11.2003/gob-ko/
      WITH PurchHeader DO BEGIN

        IF "LM Entry No." = 0 THEN
          EXIT;

        IF NOT PurchHeaderLM.GET("LM Entry No.") THEN
          EXIT;

        IF PurchHeaderLM."Trans. Status" = PurchHeaderLM."Trans. Status"::"1" THEN BEGIN

          PurchHeaderLM2.INIT;
          PurchHeaderLM2 := PurchHeaderLM;
          PurchHeaderLM2."Entry No." := cuLMInterfaceOut.GETORDHENTRYNO;
          PurchHeaderLM2."Order No. Navision" := PurchHeader."No.";
          //cuLMInterfaceOut.SetOrderNoHeader(PurchHeaderLM2);
          PurchHeaderLM2."MARC Action" := PurchHeaderLM2."MARC Action"::"5";
          PurchHeaderLM2."Entry Date" := WORKDATE;
          PurchHeaderLM2."Entry Time" := TIME;
          PurchHeaderLM2."Trans. Status" := PurchHeaderLM2."Trans. Status"::"0";
          PurchHeaderLM2."File Name" := '';
          PurchHeaderLM2."File Position" := 0;
          PurchHeaderLM2."Record ID" := '';
          PurchHeaderLM2."Trans. No." := '';
          PurchHeaderLM2.INSERT;
        END;

        PurchHeaderLM."Trans. Status" := PurchHeaderLM."Trans. Status"::"5";
        PurchHeaderLM.MODIFY;

        PurchLine.RESET;
        PurchLine.SETRANGE("Document Type","Document Type");
        PurchLine.SETRANGE("Document No.","No.");
        IF PurchLine.FIND('-') THEN
          REPEAT
            IF PurchLineLM.GET(PurchLine."LM Entry No.") THEN BEGIN

              IF PurchLineLM."Trans. Status" = PurchLineLM."Trans. Status"::"1" THEN BEGIN
                PurchLineLM2.INIT;
                PurchLineLM2 := PurchLineLM;
                PurchLineLM2."Entry No." := cuLMInterfaceOut.GETORDLENTRYNO;
                PurchLineLM2."Document No." := PurchHeaderLM2."No.";
                PurchLineLM2."Order No. Navision" := PurchHeaderLM2."Order No. Navision";
                PurchLineLM2."Trans. Status" := PurchLineLM2."Trans. Status"::"0";
                PurchLineLM2."MARC Action" := PurchLineLM2."MARC Action"::"5";
                PurchLineLM2."Entry Date" := WORKDATE;
                PurchLineLM2."Entry Time" := TIME;
                PurchLineLM2."Header Entry No." := PurchHeaderLM."Entry No.";
                PurchLineLM2."File Name" := '';
                PurchLineLM2."Trans. No." := '';
                PurchLineLM2."Record ID" := '';
                PurchLineLM2."File Position" := 0;
                PurchLineLM2.INSERT;
                PurchLineLM2."Header Entry No." := PurchHeaderLM2."Entry No.";
                PurchLineLM2.MODIFY;

              END;

              PurchLineLM."Trans. Status" := PurchLineLM."Trans. Status"::"5";
              PurchLineLM.MODIFY;

            END;
          UNTIL PurchLine.NEXT = 0;

      END;

      //E/18.11.2003/gob-ko/
      }
    END;

    PROCEDURE GETCOMPANYNAME@1000000008(OrderNo@1000000000 : Code[20]) : Text[50];
    VAR
      Company@1000000001 : Record 2000000006;
      OrderNo2@1000000002 : Code[20];
    BEGIN
      //A/25.11.2003/gob-ko/
      OrderNo2 := OrderNo;

      CASE COPYSTR(OrderNo,1,1) OF
        'CH':
              BEGIN
                IF COPYSTR(OrderNo2,2,1) = 'T' THEN BEGIN
                  IF Company.GET('KCCH - TEST') THEN
                    EXIT(Company.Name)
                END ELSE
                  IF Company.GET('KCCH') THEN;
                    EXIT(Company.Name);
              END;
        'D' :
              BEGIN
                IF COPYSTR(OrderNo2,2,1) = 'T' THEN BEGIN
                  IF Company.GET('KCD - TEST') THEN
                    EXIT(Company.Name)
                END ELSE
                  IF Company.GET('KCD') THEN;
                    EXIT(Company.Name);
              END;
        'E' :
              BEGIN
                IF COPYSTR(OrderNo2,2,1) = 'T' THEN BEGIN
                  IF Company.GET('KCE - TEST') THEN
                    EXIT(Company.Name)
                END ELSE
                  IF Company.GET('KCE') THEN;
                    EXIT(Company.Name);
              END;
        'F' :
              BEGIN
                IF COPYSTR(OrderNo2,2,1) = 'T' THEN BEGIN
                  IF Company.GET('KCF - TEST') THEN
                    EXIT(Company.Name)
                END ELSE
                  IF Company.GET('KCF') THEN;
                    EXIT(Company.Name);
              END;
        'I' :
              BEGIN
                IF COPYSTR(OrderNo2,2,1) = 'T' THEN BEGIN
                  IF Company.GET('KCI - TEST') THEN
                    EXIT(Company.Name)
                END ELSE
                  IF Company.GET('KCI') THEN;
                    EXIT(Company.Name);
              END;
        'UK':
              BEGIN
                IF COPYSTR(OrderNo2,2,1) = 'T' THEN BEGIN
                  IF Company.GET('KCUK - TEST') THEN
                    EXIT(Company.Name)
                END ELSE
                  IF Company.GET('KCUK') THEN;
                    EXIT(Company.Name);
              END;
        'Q' :
              BEGIN
                IF COPYSTR(OrderNo2,2,1) = 'T' THEN BEGIN
                  IF Company.GET('KHQ - TEST') THEN
                    EXIT(Company.Name)
                END ELSE
                  IF Company.GET('KHQ') THEN;
                    EXIT(Company.Name);
              END;
      END;
      //E/25.11.2003/gob-ko/
    END;

    PROCEDURE SetTransDateTimeHeader@1000000007(DDHeader@1000000000 : Record 50061;VAR TransDate@1000000002 : Date;VAR TransTime@1000000003 : Time);
    VAR
      FileIn2@1000000001 : Record 2000000022;
    BEGIN
      //A/28.05.2004/gob-ko/
      FileIn2.RESET;
      FileIn2.SETRANGE(Path,DDSetup."Interface Folder (In)");
      FileIn2.SETFILTER(Name,DDHeader."File Name");
      IF FileIn2.FIND('-') THEN BEGIN
        IF NOT EVALUATE(TransDate,
               COPYSTR(DDHeader."File Name",9,2)+
               COPYSTR(DDHeader."File Name",7,2)+
               COPYSTR(DDHeader."File Name",5,2)) THEN
          TransDate := FileIn2.Date;
        IF NOT EVALUATE(TransTime,COPYSTR(DDHeader."File Name",11,6)) THEN
          TransTime := FileIn2.Time;
      END;
      //E/28.05.2004/gob-ko/
    END;

    PROCEDURE SetTransDateTimeLine@1000000012(DDLine@1000000000 : Record 50062;VAR TransDate@1000000003 : Date;VAR TransTime@1000000002 : Time);
    VAR
      FileIn2@1000000001 : Record 2000000022;
    BEGIN
      FileIn2.RESET;
      FileIn2.SETRANGE(Path,DDSetup."Interface Folder (In)");
      FileIn2.SETFILTER(Name,DDLine."File Name");
      IF FileIn2.FIND('-') THEN BEGIN
        IF NOT EVALUATE(TransDate,
               COPYSTR(DDLine."File Name",9,2)+
               COPYSTR(DDLine."File Name",7,2)+
               COPYSTR(DDLine."File Name",5,2)) THEN
          TransDate := FileIn2.Date;
        IF NOT EVALUATE(TransTime,COPYSTR(DDLine."File Name",11,6)) THEN
          TransTime := FileIn2.Time;
      END;
      //E/28.05.2004/gob-ko/
    END;

    PROCEDURE SetTransDateTimeSKU@1000000013(DDItem@1000000000 : Record 50059;VAR TransDate@1000000003 : Date;VAR TransTime@1000000002 : Time);
    VAR
      FileIn2@1000000001 : Record 2000000022;
    BEGIN
      FileIn2.RESET;
      FileIn2.SETRANGE(Path,DDSetup."Interface Folder (In)");
      FileIn2.SETFILTER(Name,DDItem."File Name");
      IF FileIn2.FIND('-') THEN BEGIN
        IF NOT EVALUATE(TransDate,
               COPYSTR(DDItem."File Name",3,2)+
               COPYSTR(DDItem."File Name",7,2)+
               COPYSTR(DDItem."File Name",5,2)) THEN
          TransDate := FileIn2.Date;
        IF NOT EVALUATE(TransTime,COPYSTR(DDItem."File Name",9,6)) THEN
          TransTime := FileIn2.Time;
      END;
      //E/28.05.2004/gob-ko/
    END;

    PROCEDURE CompleteShortpick@1000000005(DDHeader@1000000000 : Record 50061) ShortPick : Boolean;
    VAR
      DDLine@1000000001 : Record 50062;
      ConfQty@1000000002 : Decimal;
    BEGIN
      //A/GOB-SFE/09.08.04
      IF DDHeader."Record ID"='ORDH' THEN BEGIN
        ConfQty:=0;
        DDLine.RESET;
        DDLine.SETRANGE("Header Entry No.",DDHeader."Entry No.");
        IF DDLine.FIND('-') THEN
          REPEAT
            ConfQty:=ConfQty+DDLine."Qty. to Ship";
          UNTIL (DDLine.NEXT=0) OR (ConfQty<>0);
      EXIT(ConfQty=0);
      END ELSE EXIT(FALSE);
      //E/GOB-SFE/09.08.04
    END;

    PROCEDURE ManualCYCC@1000000006();
    VAR
      LMSKU@1000000000 : Record 50059;
    BEGIN
      {
      FileIn.RESET;
      FileIn.SETRANGE(Path,'v:\kanebo\in');
      FileIn.SETFILTER(Name,'%1','DATIMS*');
      IF FileIn.FIND('-') THEN BEGIN
        REPEAT
          FileCounter += 1;
          FlatFileArr[FileCounter] := FileIn.Name;
        UNTIL (FileIn.NEXT = 0) OR (FileCounter = ARRAYLEN(FlatFileArr));
      END;

      IF NOT CHECKFFLEXISTS THEN BEGIN
        MESSAGE('No files in "C:\kanebo\in" found!');
        EXIT;
      END;
      IF CONFIRM('%1 file(s) found.\Do you want to import the CYCC records?',TRUE,FORMAT(FileCounter)) THEN BEGIN
        LMSKU.RESET;
        LMSKU.SETCURRENTKEY("Record ID",Direction,"Trans. Status","No.","Plt. Status");
        LMSKU.SETRANGE("Record ID",'INVS');
        LMSKU.SETRANGE(Direction,LMSKU.Direction::"1");
        LMSKU.SETRANGE("Trans. Status",LMSKU."Trans. Status"::"0");
        LMSKU.MODIFYALL("Trans. Status",LMSKU."Trans. Status"::"7");

        FOR Loop := 1 TO FileCounter DO BEGIN
          IF (NOT ReadTransHeader (FlatFileArr[Loop])) AND
             (NOT ReadTransTrailer(FlatFileArr[Loop]))
          THEN
            ReadTransmission(FlatFileArr[Loop]);
        END;

      END;
      MESSAGE('All records processed.');

      CLEARALL;
      }
    END;

    PROCEDURE InsertPackingLines@1000000009();
    VAR
      FieldRef@1000000000 : FieldRef;
      LMLineIn@1000000001 : Record 50062;
      LMLineOut@1000000005 : Record 50062;
      TempLMLineOut@1000000006 : TEMPORARY Record 50062;
      LMHeaderIn@1000000002 : Record 50061;
    BEGIN
      {
      //A/GOB-SFE/23.02.06

      FieldRef := GlobalRecRef.FIELD(79501); //"Entry No."
      DDLineIn.GET(FieldRef.VALUE);

      DDLineOut.SETCURRENTKEY("Record ID","Trans. Status","Document Entry Type","Document Type","Document No.",
                "No.","Line No.",Direction,Company);
      DDLineOut.SETRANGE("Record ID",'ROL');
      //DDLineOut.SETRANGE("Trans. Status",DDLineOut."Trans. Status"::"no changes");
      //GOB-SFE/02.06.06
      DDLineOut.SETFILTER("Trans. Status",'%1|%2',DDLineOut."Trans. Status"::"3",DDLineOut."Trans. Status"::"2");
      DDLineOut.SETRANGE("Document Entry Type",DDLineIn."Document Entry Type");
      DDLineOut.SETRANGE("Document Type",DDLineIn."Document Type");
      DDLineOut.SETRANGE("No.",DDLineIn."No.");
      DDLineOut.SETRANGE(Direction,DDLineOut.Direction::"0");
      DDLineOut.SETRANGE("Document No.",DDLineIn."Document No.");
      DDLineOut.SETRANGE("LM Pos. No.",DDLineIn."LM Pos. No.");

      TempDDLineOut.SETCURRENTKEY("Record ID","Trans. Status","Document Entry Type","Document Type","Document No.",
           "No.","Line No.",Direction,Company);
      TempDDLineOut.COPYFILTERS(DDLineOut);
      IF TempDDLineOut.COUNT <> 1 THEN BEGIN
        ArrayOfErrorVar[1] := DDLineIn.TABLECAPTION;
        ArrayOfErrorVar[2] := DDLineIn.FIELDCAPTION("Entry No.");
        ArrayOfErrorVar[3] := FORMAT(DDLineIn."Entry No.");
        ErrorHandler(1011);
      END;
      DDLineOut.LOCKTABLE(true); //a/P0610/gob-sfe/27.11.12
      IF DDLineOut.FIND('-') THEN BEGIN
        DDLineIn."Assoc. Entry No.":=DDLineOut."Entry No.";
        DDLineIn.MODIFY;

        PckLine.CHANGECOMPANY(DDLineOut.Company);
        IF PckLine.GET(DDLineOut."Order No. Navision",DDLineOut."Line No.",DDLineIn."Container ID") THEN BEGIN
          PckLine.Quantity:=PckLine.Quantity+DDLineIn.Quantity;
          PckLine.MODIFY;
        END ELSE BEGIN
          PckLine.INIT;
          PckLine."Document No.":=DDLineOut."Order No. Navision"; //key
          PckLine."Line No.":=DDLineOut."Line No.";               //key
          PckLine."Container ID":=DDLineIn."Container ID";        //key
          PckLine."No.":=DDLineIn."No.";
          PckLine.Quantity:=DDLineIn.Quantity;
          PckLine."Marc Pos No.":=DDLineIn."LM Pos. No.";
          IF DDHeaderIn.GET(DDLineIn."Header Entry No.") THEN
            PckLine.NVE:=DDHeaderIn.NVE;

          IF NOT PckLine.INSERT THEN BEGIN
            ArrayOfErrorVar[1] := DDLineIn.TABLECAPTION;
            ArrayOfErrorVar[2] := DDLineIn.FIELDCAPTION("Entry No.");
            ArrayOfErrorVar[3] := FORMAT(DDLineIn."Entry No.");
            ErrorHandler(1018);
          END;
        END;
      END ELSE BEGIN
        ArrayOfErrorVar[1] := DDLineIn.TABLECAPTION;
        ArrayOfErrorVar[2] := DDLineIn.FIELDCAPTION("Entry No.");
        ArrayOfErrorVar[3] := FORMAT(DDLineIn."Entry No.");
        ErrorHandler(1019);
      END;

      //E/GOB-SFE/23.02.06

      }
    END;

    PROCEDURE FTPDownload@1000000025() : Boolean;
    VAR
      FTPClient@1000000000 : Automation "{42A8A505-1CD3-4CA4-A7EA-E6EBCC481DDC} 1.0:{B32A3669-654B-4CEF-980E-C7753F1FA524}:'FTPNav'.FTPNavClass";
    BEGIN
      //IF ISCLEAR(FTPClient) THEN CREATE(FTPClient);
      DDSetup.GET;
      IF NOT DDSetup."FTP Active" THEN
        EXIT;

      CLEAR(FTPClient);
      CREATE(FTPClient);
      IF NOT FTPClient.DownloadDirectory(
              DDSetup."ftp server",
              DDSetup."ftp login",
              DDSetup."ftp password",
              DDSetup.EmissionDir,
              DDSetup."Interface Folder (In)",
              TRUE,FALSE)
      THEN BEGIN
        DDLog.InsertLog(0,1,0,'FTP',STRSUBSTNO('FTP Download not successfull: %1',FTPClient.GetLastErrorText));
        EXIT(FALSE);
      END;
      DDLog.InsertLog(0,0,0,'FTP',STRSUBSTNO('FTP Download successfull',''));
      EXIT(TRUE);
    END;

    PROCEDURE CheckSYN@1000000011(FileIn@1000000000 : Record 2000000022) : Boolean;
    VAR
      FileCheck@1000000001 : Record 2000000022;
    BEGIN

      FileCheck.RESET;
      FileCheck.SETRANGE(Path,FileIn.Path);
      FileCheck.SETFILTER(Name,'SYN'+COPYSTR(FileIn.Name,4,STRLEN(FileIn.Name)-3));
      EXIT(FileCheck.FIND('-'));
    END;

    PROCEDURE GetFiles@1000000014();
    VAR
      FileIn@1000000000 : Record 2000000022;
      OK@1000000001 : Integer;
    BEGIN
      EXIT;
      {
      DDSetup.GET;

      IF DDSetup."Operational mode"=DDSetup."Operational mode"::"2" THEN
        OK := SHELL('\\kanas-1\c$\lm_interface_Test\kc_copy.bat')
      ELSE
        OK := SHELL('\\kanas-1\c$\lm_interface_Test\kc_copy.bat');


      FileIn.SETRANGE(Path,DDSetup."Interface Folder (In)");
      FileIn.SETRANGE("Is a file",TRUE);
      IF FileIn.FIND('-') THEN
        REPEAT
          IF NOT FILE.ERASE('z:\'+FileIn.Name) THEN
            MESSAGE('Couldnt delete file %1',FileIn.Name)
          ELSE MESSAGE('file deleted: %1',FileIn.Name);
        UNTIL FileIn.NEXT=0;
      }
    END;

    PROCEDURE InitSKU@1000000015();
    VAR
      DDSKU@1000000000 : Record 50059;
    BEGIN


      DDSKU.RESET;
      DDSKU.SETCURRENTKEY("Record ID",Direction,"Trans. Status","No.");
      DDSKU.SETRANGE("Record ID",'11');
      DDSKU.SETRANGE(Direction,DDSKU.Direction::"in");
      DDSKU.SETRANGE("Trans. Status",DDSKU."Trans. Status"::new);
      DDSKU.MODIFYALL("Trans. Status",DDSKU."Trans. Status"::canceled);
      //H1726 04.11.14 TST -------------------------------
      IF GUIALLOWED AND NOT SuppressMessage THEN
      //H1726 04.11.14 TST +++++++++++++++++++++++++++++++
        MESSAGE('All old inventory status swichted to "canceled"');
    END;

    PROCEDURE CreateMovement@1000000016(VAR DDLineIn@1000000000 : Record 50062) OK : Boolean;
    VAR
      DDMoveLine@1000000001 : Record 50063;
    BEGIN
      WITH DDLineIn DO BEGIN
        //IF DDLineIn."Movement Type"<>50 THEN
        //  EXIT(FALSE);

        DDMoveLine.INIT;
        DDMoveLine."Entry No.":="Entry No.";
        DDMoveLine."Movement Type":="Movement Type";
        DDMoveLine."Item No.":="No.";
        DDMoveLine.Quantity:="Qty. to Ship";
        IF "Document No."<>'' THEN
          DDMoveLine."Document No.":="Document No."
        ELSE
          DDMoveLine."Document No.":=FORMAT("Entry No.");
        DDMoveLine.Position:="DD Pos. No.";
        DDMoveLine.Status:=DDMoveLine.Status::new;
        DDMoveLine."Posting Date":=DDLineIn."Movement Date";
        DDMoveLine."Posting Time":=DDLineIn."Movement Time";
        DDMoveLine."Trans. No.":="Trans. No.";
        CASE DDMoveLine."Movement Type" OF
          11: DDMoveLine.BWA:=DDMoveLine.BWA::"pos. Inv";
          12: DDMoveLine.BWA:=DDMoveLine.BWA::PO;
          31: DDMoveLine.BWA:=DDMoveLine.BWA::"neg. Inv";
          50: DDMoveLine.BWA:=DDMoveLine.BWA::Block;
        END;

        EXIT(DDMoveLine.INSERT);
      END;
    END;

    PROCEDURE CreateLogEntry@1115500004(MsgCode@1115500001 : Code[10];MsgText@1115500000 : Text[50]);
    VAR
      JobQueueEntry@1115500004 : Record 472;
      Msg@1115500003 : Text[50];
      JobDispatcher@1115500002 : Codeunit 448;
    BEGIN
      //gob-sfe/21.12.10 deaktiviert
      //JobDispatcher.InsertLogEntryGOB(GlobalJobQueueEntry,MsgCode,MsgText);
    END;

    PROCEDURE InsertDDTracking2DHL@1000000022(p_OrderNo@1108200001 : Code[20];p_LineNo@1108200002 : Integer;InTrackingID@1108200003 : Code[20];DDLineInLoc@1000000001 : Record 50062);
    VAR
      LocRec@1108200005 : Record 50021;
      Purchasing@1108200007 : Record 5721;
      InsertEntry@1108200006 : Boolean;
      InsertEntryArchive@1000000004 : Boolean;
      SalesLine@1108200008 : Record 37;
      PurchLine@1108200009 : Record 39;
      SalesOrderShipmentsDHL@1000000000 : Record 50020;
      FPCMgt@1000000002 : Codeunit 50003;
      rSalesLineArchive@1000000003 : Record 5108;
      RecRef@1000000005 : RecordRef;
      ShippingAgentCode@1000000006 : Code[10];
      ShippingAgent@1000000007 : Record 291;
      "**** HME *********************"@1000000008 : Integer;
      DPDSetupL@1000000009 : Record 50221;
      TestEvaluationToIntL@1000000010 : Integer;
    BEGIN
      //S/P1133
      FPCGeneralSetup.GET;
      //E/P1133

      //a/P0148
      InsertEntry := FALSE;

      SalesLine.RESET;
      IF SalesLine.GET(SalesLine."Document Type"::Order,p_OrderNo,p_LineNo) THEN
        IF (Purchasing.GET(SalesLine."Purchasing Code")) AND (Purchasing."Use New Order Status") THEN
          InsertEntry := TRUE;

      IF InsertEntry THEN BEGIN
        //S/P1117
        //S/P1133
        IF FPCGeneralSetup."Active Parcel Status History" IN
          [FPCGeneralSetup."Active Parcel Status History"::"Use Only Old DHL Parcel Status History",
          FPCGeneralSetup."Active Parcel Status History"::"Fill Both But Show And Use Old",
          FPCGeneralSetup."Active Parcel Status History"::"Fill Both But Show And Use New"]
        THEN BEGIN
        //E/P113
          CLEAR(LocRec);
          LocRec."Document No." := p_OrderNo;
          LocRec."Document Type" := LocRec."Document Type"::Order;
          LocRec."Document Line No." := p_LineNo;
          LocRec."DHL Shipment Code":=InTrackingID;
          LocRec."Docdata Status Description":=InTrackingID;
          LocRec."Time Stamp" := CURRENTDATETIME;
          //S/P1230
          // A/gob-lku/11.01.2013/P0734
          //LocRec."Shipping Agent" := FPCMgt.GetShippingAgentSalesLine(SalesLine,'DOCDATA');
          // E/gob-lku/11.01.2013/P0734
          ShippingAgent.RESET;
          ShippingAgent.SETRANGE("Docdata Shipping Company",DDLineInLoc."Transport Company");
          IF ShippingAgent.FINDFIRST THEN BEGIN
            ShippingAgentCode := ShippingAgent.Code;
            LocRec."Shipping Agent" := ShippingAgent.Code;
          END ELSE BEGIN
            LocRec."Shipping Agent" := FPCMgt.GetShippingAgentSalesLine(SalesLine,'DOCDATA');
            ShippingAgentCode := LocRec."Shipping Agent";
          END;
          //E/P1230
          // S/gob-lku/14.05.2013/P0912
          // S/gob-lku/21.05.2013/P0922
          //LocRec."Piece-Code (Identifier)" := InTrackingID;
          // E/gob-lku/21.05.2013/P0922
          // E/gob-lku/14.05.2013/P0912
          //H0875  18.02.14  MBY  ++++++++++++++++++++++++++++
          {
          //H0875  18.02.14  MBY  ----------------------------
          IF LocRec.INSERT THEN; //P0174/gob-sfe/13.08.2012
          //H0875  18.02.14  MBY  ++++++++++++++++++++++++++++
          }

          //H1268 19.06.14 DMA +++++++++++++++++++++++++++++++
          DPDSetupL.GET;
          IF DPDSetupL."Shipping Agent DPD" = ShippingAgentCode THEN BEGIN
            //H1416 28.07.14 DMA +++++++++++++++++++++++++++++++++++++++++++++++++
            //IF NOT EVALUATE(TestEvaluationToIntL,COPYSTR(InTrackingID, STRLEN(InTrackingID),1)) THEN BEGIN
            IF STRLEN(InTrackingID) >= 15 THEN BEGIN
            //H1416 28.07.14 DMA -------------------------------------------------
              LocRec."DHL Shipment Code":=COPYSTR(InTrackingID, 1, STRLEN(InTrackingID)-1);
              LocRec."Docdata Status Description":=COPYSTR(InTrackingID, 1, STRLEN(InTrackingID)-1);
            END;
          END;
          //H1268 19.06.14 DMA -------------------------------

          IF LocRec.INSERT(TRUE) THEN;
          //H0875  18.02.14  MBY  ----------------------------
        //S/P1133
        END;

        IF FPCGeneralSetup."Active Parcel Status History" IN
          [FPCGeneralSetup."Active Parcel Status History"::"Fill Both But Show And Use Old",
          FPCGeneralSetup."Active Parcel Status History"::"Fill Both But Show And Use New",
          FPCGeneralSetup."Active Parcel Status History"::"Use Only New Parcel Status History"]
        THEN BEGIN
        //E/P1133
          CLEAR(ShippingAgentCode);
          CLEAR(CUParcelStatusHistoryMgmt);
          IF InsertEntry THEN BEGIN
            RecRef.GETTABLE(SalesLine);
            //S/P1230
            //ShippingAgentCode := FPCMgt.GetShippingAgentSalesLine(SalesLine,'DOCDATA');
            ShippingAgent.RESET;
            ShippingAgent.SETRANGE("Docdata Shipping Company",DDLineInLoc."Transport Company");
            IF ShippingAgent.FINDFIRST THEN BEGIN
              ShippingAgentCode := ShippingAgent.Code;
              LocRec."Shipping Agent" := ShippingAgent.Code;
            END ELSE BEGIN
              LocRec."Shipping Agent" := FPCMgt.GetShippingAgentSalesLine(SalesLine,'DOCDATA');
              ShippingAgentCode := LocRec."Shipping Agent";
            END;
            //E/P1230
          END;
          IF InsertEntryArchive THEN BEGIN
            RecRef.GETTABLE(rSalesLineArchive);
            //S/P1230
              //E/P1230
            //ShippingAgentCode := FPCMgt.GetShippingAgentSalesLineArch(rSalesLineArchive,'DOCDATA');
            ShippingAgent.RESET;
            ShippingAgent.SETRANGE("Docdata Shipping Company",DDLineInLoc."Transport Company");
            IF ShippingAgent.FINDFIRST THEN BEGIN
              ShippingAgentCode := ShippingAgent.Code;
              LocRec."Shipping Agent" := ShippingAgent.Code;
            END ELSE BEGIN
              LocRec."Shipping Agent" := FPCMgt.GetShippingAgentSalesLineArch(rSalesLineArchive,'DOCDATA');
              ShippingAgentCode := LocRec."Shipping Agent";
            END;
            //E/P1230
          END;

          //H1268 19.06.14 DMA +++++++++++++++++++++++++++++++
          DPDSetupL.GET;
          IF DPDSetupL."Shipping Agent DPD" = ShippingAgentCode THEN BEGIN
            //H1416 28.07.14 DMA +++++++++++++++++++++++++++++++++++++++++++++++++
            //IF NOT EVALUATE(TestEvaluationToIntL,COPYSTR(InTrackingID, STRLEN(InTrackingID),1)) THEN BEGIN
            IF STRLEN(InTrackingID) >= 15 THEN BEGIN
            //H1416 28.07.14 DMA -------------------------------------------------
              LocRec."DHL Shipment Code":=COPYSTR(InTrackingID, 1, STRLEN(InTrackingID)-1);
              LocRec."Docdata Status Description":=COPYSTR(InTrackingID, 1, STRLEN(InTrackingID)-1);
              InTrackingID := COPYSTR(InTrackingID, 1, STRLEN(InTrackingID)-1);
            END;
          END;
          //H1268 19.06.14 DMA -------------------------------


          CUParcelStatusHistoryMgmt.FillHistoryByDocLine(
            RecRef,             // Rec
            0,                  // p_Command
            0,                  // p_InfoDirection::  Incoming,Outgoing
            3,                  // p_UsedInterface::  ,EDI,DHL,DocData,Drop Shipment,Rhenus,UPS
            ShippingAgentCode,  // p_ShippingAgentCode
            InTrackingID,       // p_TrackingCode
            '',                 // p_PieceCode
            '',                 // p_StatusCode
            '',                 // p_StatusRICCode
            '',                 // p_Comment
            0);                 // p_HowToHandleStatusDescription
          //S/P1129
          IF InsertEntryArchive THEN BEGIN
            CUParcelStatusHistoryMgmt.MoveParcelInfosToArchive(
              1,                                  // p_Command::All,SalesDoc,PurchDoc,Date,EntryNo
              rSalesLineArchive."Document No.",   // p_DocNo
              0,                                  // p_LineNo
              rSalesLineArchive."Document Type",  // p_DocType
              '',                                 // p_DateFilterString
              0);                                 // p_EntryNo
          END;
          //E/P1129
        //S/P1133
        END;
        //E/P1133
        //E/P1117
        SalesOrderShipmentsDHL.INIT;
        SalesOrderShipmentsDHL."DHL Shipment Number Code":=InTrackingID;
        SalesOrderShipmentsDHL."DHL Shipment Number":=InTrackingID;
        //a/P0651/gob-sfe/08.01.2013
        //SalesOrderShipmentsDHL."Shipping Agent Code":='DHL';
        SalesOrderShipmentsDHL."Shipping Agent Code":= FPCMgt.GetShippingAgentSalesLine(SalesLine,'DOCDATA');
        //e/P0651/gob-sfe/08.01.2013
        SalesOrderShipmentsDHL."SO No.":=p_OrderNo;
        SalesOrderShipmentsDHL."Number of Parcels":=DDLineInLoc."Qty. to Ship";
        SalesOrderShipmentsDHL."Shipment Date":=DDLineInLoc."Shipment Date";
        SalesOrderShipmentsDHL."Purchasing Code":=SalesLine."Purchasing Code";
        SalesOrderShipmentsDHL."Creation Date Time":=CURRENTDATETIME;
        IF SalesOrderShipmentsDHL.INSERT THEN; //P0174/gob-sfe/13.08.2012

        //H1268 20.06.14 DMA +++++++++++++++++++++++++++++++
        DPDSetupL.GET;
        IF DPDSetupL."Shipping Agent DPD" = ShippingAgentCode THEN BEGIN
          //H1416 28.07.14 DMA +++++++++++++++++++++++++++++++++++++++++++++++++
          //IF NOT EVALUATE(TestEvaluationToIntL,COPYSTR(InTrackingID, STRLEN(InTrackingID),1)) THEN BEGIN
          IF STRLEN(InTrackingID) >= 15 THEN BEGIN
          //H1416 28.07.14 DMA -------------------------------------------------
            SalesLine."DHL Shipment Number":=COPYSTR(InTrackingID, 1, STRLEN(InTrackingID)-1);
            SalesOrderShipmentsDHL."DHL Shipment Number Code":=COPYSTR(InTrackingID, 1, STRLEN(InTrackingID)-1);
          END;
        END ELSE BEGIN
        //H1268 20.06.14 DMA -------------------------------
          SalesLine."DHL Shipment Number":=InTrackingID;
        //H1268 20.06.14 DMA +++++++++++++++++++++++++++++++
        END;
        //H1268 20.06.14 DMA -------------------------------

        SalesLine.MODIFY;

      END;
      //E/P0148
    END;

    PROCEDURE CheckDoubleTransmission@1000000023(InCode@1000000000 : Code[20];DDLineIn@1000000002 : Record 50062) : Boolean;
    VAR
      DDHeaderLoc@1000000001 : Record 50061;
    BEGIN
      //P0460/gob-sfe/18.10.12
      DDHeaderLoc.SETCURRENTKEY("Trans. No.");
      DDHeaderLoc.SETRANGE("Trans. No.",InCode);
      DDHeaderLoc.SETFILTER("Entry No.",'<>%1',DDLineIn."Header Entry No.");
      IF DDHeaderLoc.ISEMPTY THEN
        EXIT(FALSE)
      ELSE
        EXIT(TRUE);
      //P0460/gob-sfe/18.10.12
    END;

    PROCEDURE SetSuppressMessage@1000000026();
    BEGIN
      SuppressMessage := TRUE;
    END;

    BEGIN
    {
      +----------------------------------------------+
      | GOB Software & Systeme                       |
      +----------------------------------------------+
      | Allgemeine Programmierung                    |
      | FP Commerce                                  |
      +----------------------------------------------+

      Version Bemerkung
      ------------------------------------------------
      V1.01   20.07.2012   SetOrderImportResult
      V1.02   23.07.2012   SetSupplierImportResult
      V1.03   31.07.2012   P0117  DDlog Protokollierung Bugfix
      V1.04   07.08.2012   P0140  Bugfix DD Logging
      V1.05   07.08.2012   P0148  DD Tracking for DHL
      V1.06   08.08.2012   P0155  Manifest bugfix
      V1.07   09.08.2012   P0164  Bugfix Order Import Result
      V1.08   13.08.2012   P0174  Bugfix Decimal/integer Import
      V1.09   15.08.2012   P0198  Bugfix "Assoc. Entry No." der Ausgangszeile
      V1.10   27.08.2012   P0231  Setzen Shipment Date in Ausgangszeile
      V1.01   05.10.2012   P0410  OrderImportResult korrekt einlesen
      V1.12   18.10.2012   P0460  Bugfixe PO Import
      V1.13   22.10.2012   P0475  Order Status Import Bugfix
      V1.14   25.10.2012   P0518  DHL Bugfix
      V1.15   27.11.2012   P0610  locktable(true)
      V1.16   05.12.2012   P0647  Cancel Feedback
      V1.17   08.01.2013   P0651  InsertDHLTracking
      V1.18   08.01.2013   P0725  DD Sendungsnr. in DHL Status History (ohne Manifest)
      V1.19   09.01.2013   P0730  DD Interim Tracking ID FIX
      V1.20   11.01.2013   P0734  Fill in Shipping Agent in Tbl 50021
      V1.21   12.02.2013   P0564  Fill Interface Process Log In Delivery
      V1.24   14.05.2013   P0912  Fill Piece Code Identifier in DHL Parcel Status History
      V1.25   21.05.2013   P0922  Fix DD Status Mail (undo V1.24)
      V1.26   24.05.2013   P0988  deactivate Order Status Log from DD
      V1.27   09.07.2013   P0966  IPL Backorder and not on stock set status back to pick
      V1.28   10.07.2013   P0988  only 15 not allowed for Purchase Orders
      V1.29   16.04.2014   P1230  Fill Shipping Agent from DD

      +--------------------------------------------+
      |                                            |
      |                  Home24                    |
      |     Cooperation GOB & Home24 NAV Team      |
      |                                            |
      +--------------------------------------------+

      Project No. Date      Shortcut  Description
      _____________________________________________
      P1117     25.09.13  gob-mlan    - Redesign of "DHL Parcel Status History"
                                      - Code within with //S/P1117/++S+++++++ and //E/P1117/--E-------
                                        will be replaced by the new code and/or it will be deactivated
      P1129     21.10.13  gob-mlan    - Redesign of "DHL Parcel Status History"
      P1117     05.11.13  gob-mlan    - Redesign of "DHL Parcel Status History"

      +--------------------------------------------+
      |                                            |
      |                  Home24                    |
      |       Internal Customizing by NAV-Team     |
      |                                            |
      +--------------------------------------------+

      Project No. Date     Shortcut  Description
      _____________________________________________
      *** Module: Miscellaneous
      H0594       02.10.13 ABR       Optional Import Inventory File
      H0875       18.02.14 MBY       Execute OnInsert trigger in "DHL Parcels Status History" table
      H1268       19.06.14 DMA       Correct DPD tracking link send by Docdata by removing final letter
      H1416       28.07.14 DMA       DPD Tracking number: always cut of digit 15 which is control code, CODECHANGE
      H1726       04.11.14 TST       Suppress Message
    }
    END.
  }
}

