OBJECT Codeunit 50243 DataMigration SalLineField II
{
  OBJECT-PROPERTIES
  {
    Date=10.04.14;
    Time=16:48:13;
    Version List=HME0584;
  }
  PROPERTIES
  {
    OnRun=BEGIN
            CommitEveryXthRecord := 1000;
            UpdateStatusEveryXthRecord := 100;
            OpenStatusWindow();

            // for the following fields values need to converted:
            // - Step 1: "Status Return Order"
            // - Step 2: "Customer accepted" (before "Prevention Accepted")

            CounterRecordsProcessed := 0;
            CLEAR(Company);
            IF Company.FIND('-') THEN BEGIN
              REPEAT
                SalesHeader.CHANGECOMPANY(Company.Name);
                SalesLine.CHANGECOMPANY(Company.Name);
                SalesHeaderArchive.CHANGECOMPANY(Company.Name);
                SalesLineArchive.CHANGECOMPANY(Company.Name);
                SalesShipmentHeader.CHANGECOMPANY(Company.Name);
                SalesShipmentLine.CHANGECOMPANY(Company.Name);
                SalesInvoiceHeader.CHANGECOMPANY(Company.Name);
                SalesInvoiceLine.CHANGECOMPANY(Company.Name);
                SalesCrMemoHeader.CHANGECOMPANY(Company.Name);
                SalesCrMemoLine.CHANGECOMPANY(Company.Name);

                CLEAR(SalesLineBuffer);
                SalesLineBuffer.SETCURRENTKEY(TableNo,CompanyName,"Document Type","Document No.",
                                              "Version No.","Doc. No. Occurrence","Line No.");
                SalesLineBuffer.SETRANGE(CompanyName,Company.Name);
                // next line for testing only:
                // SalesLineBuffer.SETRANGE(TableNo,115);

                IF SalesLineBuffer.FIND('-') THEN BEGIN
                  REPEAT
                    IF (TableNoLast <> SalesLineBuffer.TableNo) THEN BEGIN
                      TableNoLast := SalesLineBuffer.TableNo;
                      CLEAR(SalesLineBuffer2);
                      SalesLineBuffer2.SETCURRENTKEY(TableNo,CompanyName,"Document Type","Document No.",
                                                     "Version No.","Doc. No. Occurrence","Line No.");
                      SalesLineBuffer2.SETRANGE(CompanyName,Company.Name);
                      SalesLineBuffer2.SETRANGE(TableNo,TableNoLast);
                      TotalNoOfRecordsCurrentTable := SalesLineBuffer2.COUNT;
                      CounterRecordsChecked := 0;
                      CounterRecordsProcessed := 0;
                      DoCommitUpdateStatusWindow(TRUE);
                    END;
                    CounterRecordsChecked += 1;

                    // next lines for testing only
                    {
                    IF (CounterRecordsProcessed > 200) THEN BEGIN
                      COMMIT;
                      EXIT;
                    END;
                    }

                    //
                    // Step 1: Status Return Order
                    //
                    StatusWindow.UPDATE(2,SalesLineBuffer.TableNo);
                    CASE SalesLineBuffer."Status Return Order" OF

                      SalesLineBuffer."Status Return Order"::Requested,
                      SalesLineBuffer."Status Return Order"::"Requested DD",
                      SalesLineBuffer."Status Return Order"::"Requested Rhenus":
                        BEGIN
                          CASE SalesLineBuffer.TableNo OF
                            DATABASE::"Sales Header":
                              BEGIN
                                IF SalesHeader.GET(SalesLineBuffer."Document Type",SalesLineBuffer."Document No.") THEN BEGIN
                                  SalesHeader."Status Return Order" := SalesHeader."Status Return Order"::requested;
                                  SalesHeader.MODIFY;
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Line":
                              BEGIN
                                IF SalesLine.GET(SalesLineBuffer."Document Type",
                                                 SalesLineBuffer."Document No.",
                                                 SalesLineBuffer."Line No.")
                                THEN BEGIN
                                  SalesLine."Status Return Order" := SalesLine."Status Return Order"::requested;
                                  SalesLine.MODIFY;
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Header Archive":
                              BEGIN
                                IF SalesHeaderArchive.GET(SalesLineBuffer."Document Type",
                                                          SalesLineBuffer."Document No.",
                                                          SalesLineBuffer."Doc. No. Occurrence",
                                                          SalesLineBuffer."Version No.")
                                THEN BEGIN
                                  SalesHeaderArchive."Status Return Order" := SalesHeaderArchive."Status Return Order"::requested;
                                  SalesHeaderArchive.MODIFY;
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Line Archive":
                              BEGIN
                                IF SalesLineArchive.GET(SalesLineBuffer."Document Type",
                                                        SalesLineBuffer."Document No.",
                                                        SalesLineBuffer."Doc. No. Occurrence",
                                                        SalesLineBuffer."Version No.",
                                                        SalesLineBuffer."Line No.")
                                THEN BEGIN
                                  SalesLineArchive."Status Return Order" := SalesLineArchive."Status Return Order"::requested;
                                  SalesLineArchive.MODIFY;
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Shipment Header":
                              BEGIN
                                IF SalesShipmentHeader.GET(SalesLineBuffer."Document No.") THEN BEGIN
                                  SalesShipmentHeader."Status Return Order" := SalesShipmentHeader."Status Return Order"::requested;
                                  ModifyOnSalesHeaderLineTables.ModifySalesShipmentHeader(SalesShipmentHeader,FALSE);
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Shipment Line":
                              BEGIN
                                IF SalesShipmentLine.GET(SalesLineBuffer."Document No.",
                                                         SalesLineBuffer."Line No.")
                                THEN BEGIN
                                  SalesShipmentLine."Status Return Order" := SalesShipmentLine."Status Return Order"::requested;
                                  ModifyOnSalesHeaderLineTables.ModifySalesShipmentLine(SalesShipmentLine,FALSE);
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Invoice Header":
                              BEGIN
                                IF SalesInvoiceHeader.GET(SalesLineBuffer."Document No.") THEN BEGIN
                                  SalesInvoiceHeader."Status Return Order" := SalesInvoiceHeader."Status Return Order"::requested;
                                  ModifyOnSalesHeaderLineTables.ModifySalesInvoiceHeader(SalesInvoiceHeader,FALSE);
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Invoice Line":
                              BEGIN
                                IF SalesInvoiceLine.GET(SalesLineBuffer."Document No.",
                                                        SalesLineBuffer."Line No.")
                                THEN BEGIN
                                  SalesInvoiceLine."Status Return Order" := SalesInvoiceLine."Status Return Order"::requested;
                                  ModifyOnSalesHeaderLineTables.ModifySalesInvoiceLine(SalesInvoiceLine,FALSE);
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Cr.Memo Header":
                              BEGIN
                                IF SalesCrMemoHeader.GET(SalesLineBuffer."Document No.") THEN BEGIN
                                  SalesCrMemoHeader."Status Return Order" := SalesCrMemoHeader."Status Return Order"::requested;
                                  ModifyOnSalesHeaderLineTables.ModifySalesCrMemoHeader(SalesCrMemoHeader,FALSE);
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Cr.Memo Line":
                              BEGIN
                                IF SalesCrMemoLine.GET(SalesLineBuffer."Document No.",
                                                       SalesLineBuffer."Line No.")
                                THEN BEGIN
                                  SalesCrMemoLine."Status Return Order" := SalesCrMemoLine."Status Return Order"::requested;
                                  ModifyOnSalesHeaderLineTables.ModifySalesCrMemoLine(SalesCrMemoLine,FALSE);
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;
                          END;  // CASE SalesLineBuffer.TableNo OF
                        END;  // SalesLineBuffer."Status Return Order"::"requested DD",  BEGIN

                      SalesLineBuffer."Status Return Order"::"R…kfrage ans CC":
                        BEGIN
                          CASE SalesLineBuffer.TableNo OF
                            DATABASE::"Sales Header":
                              BEGIN
                                IF SalesHeader.GET(SalesLineBuffer."Document Type",SalesLineBuffer."Document No.") THEN BEGIN
                                  SalesHeader."Status Return Order" := SalesHeader."Status Return Order"::" ";
                                  SalesHeader.MODIFY;
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Line":
                              BEGIN
                                IF SalesLine.GET(SalesLineBuffer."Document Type",
                                                 SalesLineBuffer."Document No.",
                                                 SalesLineBuffer."Line No.")
                                THEN BEGIN
                                  SalesLine."Status Return Order" := SalesLine."Status Return Order"::" ";
                                  SalesLine.MODIFY;
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Header Archive":
                              BEGIN
                                IF SalesHeaderArchive.GET(SalesLineBuffer."Document Type",
                                                          SalesLineBuffer."Document No.",
                                                          SalesLineBuffer."Doc. No. Occurrence",
                                                          SalesLineBuffer."Version No.")
                                THEN BEGIN
                                  SalesHeaderArchive."Status Return Order" := SalesHeaderArchive."Status Return Order"::" ";
                                  SalesHeaderArchive.MODIFY;
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Line Archive":
                              BEGIN
                                IF SalesLineArchive.GET(SalesLineBuffer."Document Type",
                                                        SalesLineBuffer."Document No.",
                                                        SalesLineBuffer."Doc. No. Occurrence",
                                                        SalesLineBuffer."Version No.",
                                                        SalesLineBuffer."Line No.")
                                THEN BEGIN
                                  SalesLineArchive."Status Return Order" := SalesLineArchive."Status Return Order"::" ";
                                  SalesLineArchive.MODIFY;
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Shipment Header":
                              BEGIN
                                IF SalesShipmentHeader.GET(SalesLineBuffer."Document No.") THEN BEGIN
                                  SalesShipmentHeader."Status Return Order" := SalesShipmentHeader."Status Return Order"::" ";
                                  ModifyOnSalesHeaderLineTables.ModifySalesShipmentHeader(SalesShipmentHeader,FALSE);
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Shipment Line":
                              BEGIN
                                IF SalesShipmentLine.GET(SalesLineBuffer."Document No.",
                                                         SalesLineBuffer."Line No.")
                                THEN BEGIN
                                  SalesShipmentLine."Status Return Order" := SalesShipmentLine."Status Return Order"::" ";
                                  ModifyOnSalesHeaderLineTables.ModifySalesShipmentLine(SalesShipmentLine,FALSE);
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Invoice Header":
                              BEGIN
                                IF SalesInvoiceHeader.GET(SalesLineBuffer."Document No.") THEN BEGIN
                                  SalesInvoiceHeader."Status Return Order" := SalesInvoiceHeader."Status Return Order"::" ";
                                  ModifyOnSalesHeaderLineTables.ModifySalesInvoiceHeader(SalesInvoiceHeader,FALSE);
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Invoice Line":
                              BEGIN
                                IF SalesInvoiceLine.GET(SalesLineBuffer."Document No.",
                                                        SalesLineBuffer."Line No.")
                                THEN BEGIN
                                  SalesInvoiceLine."Status Return Order" := SalesInvoiceLine."Status Return Order"::" ";
                                  ModifyOnSalesHeaderLineTables.ModifySalesInvoiceLine(SalesInvoiceLine,FALSE);
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Cr.Memo Header":
                              BEGIN
                                IF SalesCrMemoHeader.GET(SalesLineBuffer."Document No.") THEN BEGIN
                                  SalesCrMemoHeader."Status Return Order" := SalesCrMemoHeader."Status Return Order"::" ";
                                  ModifyOnSalesHeaderLineTables.ModifySalesCrMemoHeader(SalesCrMemoHeader,FALSE);
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Cr.Memo Line":
                              BEGIN
                                IF SalesCrMemoLine.GET(SalesLineBuffer."Document No.",
                                                       SalesLineBuffer."Line No.")
                                THEN BEGIN
                                  SalesCrMemoLine."Status Return Order" := SalesCrMemoLine."Status Return Order"::" ";
                                  ModifyOnSalesHeaderLineTables.ModifySalesCrMemoLine(SalesCrMemoLine,FALSE);
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;
                          END;  // CASE SalesLineBuffer.TableNo OF
                        END;  // SalesLineBuffer."Status Return Order"::"R…k": BEGIN

                      SalesLineBuffer."Status Return Order"::"Warten auf auf Kundenantwort":
                        BEGIN
                          CASE SalesLineBuffer.TableNo OF
                            DATABASE::"Sales Header":
                              BEGIN
                                IF SalesHeader.GET(SalesLineBuffer."Document Type",SalesLineBuffer."Document No.") THEN BEGIN
                                  SalesHeader."Status Return Order" := SalesHeader."Status Return Order"::"Customer response open";
                                  SalesHeader.MODIFY;
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Line":
                              BEGIN
                                IF SalesLine.GET(SalesLineBuffer."Document Type",
                                                 SalesLineBuffer."Document No.",
                                                 SalesLineBuffer."Line No.")
                                THEN BEGIN
                                  SalesLine."Status Return Order" := SalesLine."Status Return Order"::"Customer response open";
                                  SalesLine.MODIFY;
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Header Archive":
                              BEGIN
                                IF SalesHeaderArchive.GET(SalesLineBuffer."Document Type",
                                                          SalesLineBuffer."Document No.",
                                                          SalesLineBuffer."Doc. No. Occurrence",
                                                          SalesLineBuffer."Version No.")
                                THEN BEGIN
                                  SalesHeaderArchive."Status Return Order" :=
                                    SalesHeaderArchive."Status Return Order"::"Customer response open";
                                  SalesHeaderArchive.MODIFY;
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Line Archive":
                              BEGIN
                                IF SalesLineArchive.GET(SalesLineBuffer."Document Type",
                                                        SalesLineBuffer."Document No.",
                                                        SalesLineBuffer."Doc. No. Occurrence",
                                                        SalesLineBuffer."Version No.",
                                                        SalesLineBuffer."Line No.")
                                THEN BEGIN
                                  SalesLineArchive."Status Return Order" := SalesLineArchive."Status Return Order"::"Customer response open";
                                  SalesLineArchive.MODIFY;
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Shipment Header":
                              BEGIN
                                IF SalesShipmentHeader.GET(SalesLineBuffer."Document No.") THEN BEGIN
                                  SalesShipmentHeader."Status Return Order" :=
                                    SalesShipmentHeader."Status Return Order"::"Customer response open";
                                  ModifyOnSalesHeaderLineTables.ModifySalesShipmentHeader(SalesShipmentHeader,FALSE);
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Shipment Line":
                              BEGIN
                                IF SalesShipmentLine.GET(SalesLineBuffer."Document No.",
                                                         SalesLineBuffer."Line No.")
                                THEN BEGIN
                                  SalesShipmentLine."Status Return Order" := SalesShipmentLine."Status Return Order"::"Customer response open";
                                  ModifyOnSalesHeaderLineTables.ModifySalesShipmentLine(SalesShipmentLine,FALSE);
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Invoice Header":
                              BEGIN
                                IF SalesInvoiceHeader.GET(SalesLineBuffer."Document No.") THEN BEGIN
                                  SalesInvoiceHeader."Status Return Order" :=
                                    SalesInvoiceHeader."Status Return Order"::"Customer response open";
                                  ModifyOnSalesHeaderLineTables.ModifySalesInvoiceHeader(SalesInvoiceHeader,FALSE);
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Invoice Line":
                              BEGIN
                                IF SalesInvoiceLine.GET(SalesLineBuffer."Document No.",
                                                        SalesLineBuffer."Line No.")
                                THEN BEGIN
                                  SalesInvoiceLine."Status Return Order" := SalesInvoiceLine."Status Return Order"::"Customer response open";
                                  ModifyOnSalesHeaderLineTables.ModifySalesInvoiceLine(SalesInvoiceLine,FALSE);
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Cr.Memo Header":
                              BEGIN
                                IF SalesCrMemoHeader.GET(SalesLineBuffer."Document No.") THEN BEGIN
                                  SalesCrMemoHeader."Status Return Order" := SalesCrMemoHeader."Status Return Order"::"Customer response open";
                                  ModifyOnSalesHeaderLineTables.ModifySalesCrMemoHeader(SalesCrMemoHeader,FALSE);
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Cr.Memo Line":
                              BEGIN
                                IF SalesCrMemoLine.GET(SalesLineBuffer."Document No.",
                                                       SalesLineBuffer."Line No.")
                                THEN BEGIN
                                  SalesCrMemoLine."Status Return Order" := SalesCrMemoLine."Status Return Order"::"Customer response open";
                                  ModifyOnSalesHeaderLineTables.ModifySalesCrMemoLine(SalesCrMemoLine,FALSE);
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;
                          END;  // CASE SalesLineBuffer.TableNo OF
                        END;  // SalesLineBuffer."Status Return Order"::"R…k": BEGIN

                      SalesLineBuffer."Status Return Order"::"Paketmarke versandt":
                        BEGIN
                          CASE SalesLineBuffer.TableNo OF
                            DATABASE::"Sales Header":
                              BEGIN
                                IF SalesHeader.GET(SalesLineBuffer."Document Type",SalesLineBuffer."Document No.") THEN BEGIN
                                  SalesHeader."Status Return Order" := SalesHeader."Status Return Order"::"Label sent";
                                  SalesHeader.MODIFY;
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Line":
                              BEGIN
                                IF SalesLine.GET(SalesLineBuffer."Document Type",
                                                 SalesLineBuffer."Document No.",
                                                 SalesLineBuffer."Line No.")
                                THEN BEGIN
                                  SalesLine."Status Return Order" := SalesLine."Status Return Order"::"Label sent";
                                  SalesLine.MODIFY;
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Header Archive":
                              BEGIN
                                IF SalesHeaderArchive.GET(SalesLineBuffer."Document Type",
                                                          SalesLineBuffer."Document No.",
                                                          SalesLineBuffer."Doc. No. Occurrence",
                                                          SalesLineBuffer."Version No.")
                                THEN BEGIN
                                  SalesHeaderArchive."Status Return Order" := SalesHeaderArchive."Status Return Order"::"Label sent";
                                  SalesHeaderArchive.MODIFY;
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Line Archive":
                              BEGIN
                                IF SalesLineArchive.GET(SalesLineBuffer."Document Type",
                                                        SalesLineBuffer."Document No.",
                                                        SalesLineBuffer."Doc. No. Occurrence",
                                                        SalesLineBuffer."Version No.",
                                                        SalesLineBuffer."Line No.")
                                THEN BEGIN
                                  SalesLineArchive."Status Return Order" := SalesLineArchive."Status Return Order"::"Label sent";
                                  SalesLineArchive.MODIFY;
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Shipment Header":
                              BEGIN
                                IF SalesShipmentHeader.GET(SalesLineBuffer."Document No.") THEN BEGIN
                                  SalesShipmentHeader."Status Return Order" := SalesShipmentHeader."Status Return Order"::"Label sent";
                                  ModifyOnSalesHeaderLineTables.ModifySalesShipmentHeader(SalesShipmentHeader,FALSE);
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Shipment Line":
                              BEGIN
                                IF SalesShipmentLine.GET(SalesLineBuffer."Document No.",
                                                         SalesLineBuffer."Line No.")
                                THEN BEGIN
                                  SalesShipmentLine."Status Return Order" := SalesShipmentLine."Status Return Order"::"Label sent";
                                  ModifyOnSalesHeaderLineTables.ModifySalesShipmentLine(SalesShipmentLine,FALSE);
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Invoice Header":
                              BEGIN
                                IF SalesInvoiceHeader.GET(SalesLineBuffer."Document No.") THEN BEGIN
                                  SalesInvoiceHeader."Status Return Order" := SalesInvoiceHeader."Status Return Order"::"Label sent";
                                  ModifyOnSalesHeaderLineTables.ModifySalesInvoiceHeader(SalesInvoiceHeader,FALSE);
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Invoice Line":
                              BEGIN
                                IF SalesInvoiceLine.GET(SalesLineBuffer."Document No.",
                                                        SalesLineBuffer."Line No.")
                                THEN BEGIN
                                  SalesInvoiceLine."Status Return Order" := SalesInvoiceLine."Status Return Order"::"Label sent";
                                  ModifyOnSalesHeaderLineTables.ModifySalesInvoiceLine(SalesInvoiceLine,FALSE);
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Cr.Memo Header":
                              BEGIN
                                IF SalesCrMemoHeader.GET(SalesLineBuffer."Document No.") THEN BEGIN
                                  SalesCrMemoHeader."Status Return Order" := SalesCrMemoHeader."Status Return Order"::"Label sent";
                                  ModifyOnSalesHeaderLineTables.ModifySalesCrMemoHeader(SalesCrMemoHeader,FALSE);
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Cr.Memo Line":
                              BEGIN
                                IF SalesCrMemoLine.GET(SalesLineBuffer."Document No.",
                                                       SalesLineBuffer."Line No.")
                                THEN BEGIN
                                  SalesCrMemoLine."Status Return Order" := SalesCrMemoLine."Status Return Order"::"Label sent";
                                  ModifyOnSalesHeaderLineTables.ModifySalesCrMemoLine(SalesCrMemoLine,FALSE);
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;
                          END;  // CASE SalesLineBuffer.TableNo OF
                        END;  // SalesLineBuffer."Status Return Order"::"R…k": BEGIN


                      SalesLineBuffer."Status Return Order"::"Eingegangen im Lager":
                        BEGIN
                          CASE SalesLineBuffer.TableNo OF
                            DATABASE::"Sales Header":
                              BEGIN
                                IF SalesHeader.GET(SalesLineBuffer."Document Type",SalesLineBuffer."Document No.") THEN BEGIN
                                  SalesHeader."Status Return Order" := SalesHeader."Status Return Order"::received;
                                  SalesHeader.MODIFY;
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Line":
                              BEGIN
                                IF SalesLine.GET(SalesLineBuffer."Document Type",
                                                 SalesLineBuffer."Document No.",
                                                 SalesLineBuffer."Line No.")
                                THEN BEGIN
                                  SalesLine."Status Return Order" := SalesLine."Status Return Order"::received;
                                  SalesLine.MODIFY;
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Header Archive":
                              BEGIN
                                IF SalesHeaderArchive.GET(SalesLineBuffer."Document Type",
                                                          SalesLineBuffer."Document No.",
                                                          SalesLineBuffer."Doc. No. Occurrence",
                                                          SalesLineBuffer."Version No.")
                                THEN BEGIN
                                  SalesHeaderArchive."Status Return Order" := SalesHeaderArchive."Status Return Order"::received;
                                  SalesHeaderArchive.MODIFY;
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Line Archive":
                              BEGIN
                                IF SalesLineArchive.GET(SalesLineBuffer."Document Type",
                                                        SalesLineBuffer."Document No.",
                                                        SalesLineBuffer."Doc. No. Occurrence",
                                                        SalesLineBuffer."Version No.",
                                                        SalesLineBuffer."Line No.")
                                THEN BEGIN
                                  SalesLineArchive."Status Return Order" := SalesLineArchive."Status Return Order"::received;
                                  SalesLineArchive.MODIFY;
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Shipment Header":
                              BEGIN
                                IF SalesShipmentHeader.GET(SalesLineBuffer."Document No.") THEN BEGIN
                                  SalesShipmentHeader."Status Return Order" := SalesShipmentHeader."Status Return Order"::received;
                                  ModifyOnSalesHeaderLineTables.ModifySalesShipmentHeader(SalesShipmentHeader,FALSE);
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Shipment Line":
                              BEGIN
                                IF SalesShipmentLine.GET(SalesLineBuffer."Document No.",
                                                         SalesLineBuffer."Line No.")
                                THEN BEGIN
                                  SalesShipmentLine."Status Return Order" := SalesShipmentLine."Status Return Order"::received;
                                  ModifyOnSalesHeaderLineTables.ModifySalesShipmentLine(SalesShipmentLine,FALSE);
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Invoice Header":
                              BEGIN
                                IF SalesInvoiceHeader.GET(SalesLineBuffer."Document No.") THEN BEGIN
                                  SalesInvoiceHeader."Status Return Order" := SalesInvoiceHeader."Status Return Order"::received;
                                  ModifyOnSalesHeaderLineTables.ModifySalesInvoiceHeader(SalesInvoiceHeader,FALSE);
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Invoice Line":
                              BEGIN
                                IF SalesInvoiceLine.GET(SalesLineBuffer."Document No.",
                                                        SalesLineBuffer."Line No.")
                                THEN BEGIN
                                  SalesInvoiceLine."Status Return Order" := SalesInvoiceLine."Status Return Order"::received;
                                  ModifyOnSalesHeaderLineTables.ModifySalesInvoiceLine(SalesInvoiceLine,FALSE);
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Cr.Memo Header":
                              BEGIN
                                IF SalesCrMemoHeader.GET(SalesLineBuffer."Document No.") THEN BEGIN
                                  SalesCrMemoHeader."Status Return Order" := SalesCrMemoHeader."Status Return Order"::received;
                                  ModifyOnSalesHeaderLineTables.ModifySalesCrMemoHeader(SalesCrMemoHeader,FALSE);
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Cr.Memo Line":
                              BEGIN
                                IF SalesCrMemoLine.GET(SalesLineBuffer."Document No.",
                                                       SalesLineBuffer."Line No.")
                                THEN BEGIN
                                  SalesCrMemoLine."Status Return Order" := SalesCrMemoLine."Status Return Order"::received;
                                  ModifyOnSalesHeaderLineTables.ModifySalesCrMemoLine(SalesCrMemoLine,FALSE);
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;
                          END;  // CASE SalesLineBuffer.TableNo OF
                        END;  // SalesLineBuffer."Status Return Order"::"R…k": BEGIN


                      SalesLineBuffer."Status Return Order"::Storniert,
                      SalesLineBuffer."Status Return Order"::Geschlossen,
                      SalesLineBuffer."Status Return Order"::"nicht erstattet":
                        BEGIN
                          CASE SalesLineBuffer.TableNo OF
                            DATABASE::"Sales Header":
                              BEGIN
                                IF SalesHeader.GET(SalesLineBuffer."Document Type",SalesLineBuffer."Document No.") THEN BEGIN
                                  SalesHeader."Status Return Order" := SalesHeader."Status Return Order"::aborted;
                                  SalesHeader.MODIFY;
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;
                            DATABASE::"Sales Line":
                              BEGIN
                                IF SalesLine.GET(SalesLineBuffer."Document Type",
                                                 SalesLineBuffer."Document No.",
                                                 SalesLineBuffer."Line No.")
                                THEN BEGIN
                                  SalesLine."Status Return Order" := SalesLine."Status Return Order"::aborted;
                                  SalesLine.MODIFY;
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Header Archive":
                              BEGIN
                                IF SalesHeaderArchive.GET(SalesLineBuffer."Document Type",
                                                          SalesLineBuffer."Document No.",
                                                          SalesLineBuffer."Doc. No. Occurrence",
                                                          SalesLineBuffer."Version No.")
                                THEN BEGIN
                                  SalesHeaderArchive."Status Return Order" := SalesHeaderArchive."Status Return Order"::aborted;
                                  SalesHeaderArchive.MODIFY;
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Line Archive":
                              BEGIN
                                IF SalesLineArchive.GET(SalesLineBuffer."Document Type",
                                                        SalesLineBuffer."Document No.",
                                                        SalesLineBuffer."Doc. No. Occurrence",
                                                        SalesLineBuffer."Version No.",
                                                        SalesLineBuffer."Line No.")
                                THEN BEGIN
                                  SalesLineArchive."Status Return Order" := SalesLineArchive."Status Return Order"::aborted;
                                  SalesLineArchive.MODIFY;
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Shipment Header":
                              BEGIN
                                IF SalesShipmentHeader.GET(SalesLineBuffer."Document No.") THEN BEGIN
                                  SalesShipmentHeader."Status Return Order" := SalesShipmentHeader."Status Return Order"::aborted;
                                  ModifyOnSalesHeaderLineTables.ModifySalesShipmentHeader(SalesShipmentHeader,FALSE);
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Shipment Line":
                              BEGIN
                                IF SalesShipmentLine.GET(SalesLineBuffer."Document No.",
                                                         SalesLineBuffer."Line No.")
                                THEN BEGIN
                                  SalesShipmentLine."Status Return Order" := SalesShipmentLine."Status Return Order"::aborted;
                                  ModifyOnSalesHeaderLineTables.ModifySalesShipmentLine(SalesShipmentLine,FALSE);
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Invoice Header":
                              BEGIN
                                IF SalesInvoiceHeader.GET(SalesLineBuffer."Document No.") THEN BEGIN
                                  SalesInvoiceHeader."Status Return Order" := SalesInvoiceHeader."Status Return Order"::aborted;
                                  ModifyOnSalesHeaderLineTables.ModifySalesInvoiceHeader(SalesInvoiceHeader,FALSE);
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Invoice Line":
                              BEGIN
                                IF SalesInvoiceLine.GET(SalesLineBuffer."Document No.",
                                                        SalesLineBuffer."Line No.")
                                THEN BEGIN
                                  SalesInvoiceLine."Status Return Order" := SalesInvoiceLine."Status Return Order"::aborted;
                                  ModifyOnSalesHeaderLineTables.ModifySalesInvoiceLine(SalesInvoiceLine,FALSE);
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Cr.Memo Header":
                              BEGIN
                                IF SalesCrMemoHeader.GET(SalesLineBuffer."Document No.") THEN BEGIN
                                  SalesCrMemoHeader."Status Return Order" := SalesCrMemoHeader."Status Return Order"::aborted;
                                  ModifyOnSalesHeaderLineTables.ModifySalesCrMemoHeader(SalesCrMemoHeader,FALSE);
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Cr.Memo Line":
                              BEGIN
                                IF SalesCrMemoLine.GET(SalesLineBuffer."Document No.",
                                                       SalesLineBuffer."Line No.")
                                THEN BEGIN
                                  SalesCrMemoLine."Status Return Order" := SalesCrMemoLine."Status Return Order"::aborted;
                                  ModifyOnSalesHeaderLineTables.ModifySalesCrMemoLine(SalesCrMemoLine,FALSE);
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;
                          END;  // CASE SalesLineBuffer.TableNo OF
                        END;  // SalesLineBuffer."Status Return Order"::storniert, BEGIN

                      SalesLineBuffer."Status Return Order"::Akzeptiert,
                      SalesLineBuffer."Status Return Order"::"Zur Auszahlung freigegeben":
                        BEGIN
                          CASE SalesLineBuffer.TableNo OF
                            DATABASE::"Sales Header":
                              BEGIN
                                IF SalesHeader.GET(SalesLineBuffer."Document Type",SalesLineBuffer."Document No.") THEN BEGIN
                                  SalesHeader."Status Return Order" := SalesHeader."Status Return Order"::finished;
                                  SalesHeader.MODIFY;
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;
                            DATABASE::"Sales Line":
                              BEGIN
                                IF SalesLine.GET(SalesLineBuffer."Document Type",
                                                 SalesLineBuffer."Document No.",
                                                 SalesLineBuffer."Line No.")
                                THEN BEGIN
                                  SalesLine."Status Return Order" := SalesLine."Status Return Order"::finished;
                                  SalesLine.MODIFY;
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Header Archive":
                              BEGIN
                                IF SalesHeaderArchive.GET(SalesLineBuffer."Document Type",
                                                          SalesLineBuffer."Document No.",
                                                          SalesLineBuffer."Doc. No. Occurrence",
                                                          SalesLineBuffer."Version No.")
                                THEN BEGIN
                                  SalesHeaderArchive."Status Return Order" := SalesHeaderArchive."Status Return Order"::finished;
                                  SalesHeaderArchive.MODIFY;
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Line Archive":
                              BEGIN
                                IF SalesLineArchive.GET(SalesLineBuffer."Document Type",
                                                        SalesLineBuffer."Document No.",
                                                        SalesLineBuffer."Doc. No. Occurrence",
                                                        SalesLineBuffer."Version No.",
                                                        SalesLineBuffer."Line No.")
                                THEN BEGIN
                                  SalesLineArchive."Status Return Order" := SalesLineArchive."Status Return Order"::finished;
                                  SalesLineArchive.MODIFY;
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Shipment Header":
                              BEGIN
                                IF SalesShipmentHeader.GET(SalesLineBuffer."Document No.") THEN BEGIN
                                  SalesShipmentHeader."Status Return Order" := SalesShipmentHeader."Status Return Order"::finished;
                                  ModifyOnSalesHeaderLineTables.ModifySalesShipmentHeader(SalesShipmentHeader,FALSE);
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Shipment Line":
                              BEGIN
                                IF SalesShipmentLine.GET(SalesLineBuffer."Document No.",
                                                         SalesLineBuffer."Line No.")
                                THEN BEGIN
                                  SalesShipmentLine."Status Return Order" := SalesShipmentLine."Status Return Order"::finished;
                                  ModifyOnSalesHeaderLineTables.ModifySalesShipmentLine(SalesShipmentLine,FALSE);
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Invoice Header":
                              BEGIN
                                IF SalesInvoiceHeader.GET(SalesLineBuffer."Document No.") THEN BEGIN
                                  SalesInvoiceHeader."Status Return Order" := SalesInvoiceHeader."Status Return Order"::finished;
                                  ModifyOnSalesHeaderLineTables.ModifySalesInvoiceHeader(SalesInvoiceHeader,FALSE);
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Invoice Line":
                              BEGIN
                                IF SalesInvoiceLine.GET(SalesLineBuffer."Document No.",
                                                        SalesLineBuffer."Line No.")
                                THEN BEGIN
                                  SalesInvoiceLine."Status Return Order" := SalesInvoiceLine."Status Return Order"::finished;
                                  ModifyOnSalesHeaderLineTables.ModifySalesInvoiceLine(SalesInvoiceLine,FALSE);
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Cr.Memo Header":
                              BEGIN
                                IF SalesCrMemoHeader.GET(SalesLineBuffer."Document No.") THEN BEGIN
                                  SalesCrMemoHeader."Status Return Order" := SalesCrMemoHeader."Status Return Order"::finished;
                                  ModifyOnSalesHeaderLineTables.ModifySalesCrMemoHeader(SalesCrMemoHeader,FALSE);
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Cr.Memo Line":
                              BEGIN
                                IF SalesCrMemoLine.GET(SalesLineBuffer."Document No.",
                                                       SalesLineBuffer."Line No.")
                                THEN BEGIN
                                  SalesCrMemoLine."Status Return Order" := SalesCrMemoLine."Status Return Order"::finished;
                                  ModifyOnSalesHeaderLineTables.ModifySalesCrMemoLine(SalesCrMemoLine,FALSE);
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;
                          END;  // CASE SalesLineBuffer.TableNo OF
                        END;  // SalesLineBuffer."Status Return Order"::"Akzeptiert",

                      SalesLineBuffer."Status Return Order"::"In Bearbeitung":
                        BEGIN
                          CASE SalesLineBuffer.TableNo OF
                            DATABASE::"Sales Header":
                              BEGIN
                                IF SalesHeader.GET(SalesLineBuffer."Document Type",SalesLineBuffer."Document No.") THEN BEGIN
                                  SalesHeader."Status Return Order" := SalesHeader."Status Return Order"::various;
                                  SalesHeader.MODIFY;
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Line":
                              BEGIN
                                IF SalesLine.GET(SalesLineBuffer."Document Type",
                                                 SalesLineBuffer."Document No.",
                                                 SalesLineBuffer."Line No.")
                                THEN BEGIN
                                  SalesLine."Status Return Order" := SalesLine."Status Return Order"::various;
                                  SalesLine.MODIFY;
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Header Archive":
                              BEGIN
                                IF SalesHeaderArchive.GET(SalesLineBuffer."Document Type",
                                                          SalesLineBuffer."Document No.",
                                                          SalesLineBuffer."Doc. No. Occurrence",
                                                          SalesLineBuffer."Version No.")
                                THEN BEGIN
                                  SalesHeaderArchive."Status Return Order" := SalesHeaderArchive."Status Return Order"::various;
                                  SalesHeaderArchive.MODIFY;
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Line Archive":
                              BEGIN
                                IF SalesLineArchive.GET(SalesLineBuffer."Document Type",
                                                        SalesLineBuffer."Document No.",
                                                        SalesLineBuffer."Doc. No. Occurrence",
                                                        SalesLineBuffer."Version No.",
                                                        SalesLineBuffer."Line No.")
                                THEN BEGIN
                                  SalesLineArchive."Status Return Order" := SalesLineArchive."Status Return Order"::various;
                                  SalesLineArchive.MODIFY;
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Shipment Header":
                              BEGIN
                                IF SalesShipmentHeader.GET(SalesLineBuffer."Document No.") THEN BEGIN
                                  SalesShipmentHeader."Status Return Order" := SalesShipmentHeader."Status Return Order"::various;
                                  ModifyOnSalesHeaderLineTables.ModifySalesShipmentHeader(SalesShipmentHeader,FALSE);
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Shipment Line":
                              BEGIN
                                IF SalesShipmentLine.GET(SalesLineBuffer."Document No.",
                                                         SalesLineBuffer."Line No.")
                                THEN BEGIN
                                  SalesShipmentLine."Status Return Order" := SalesShipmentLine."Status Return Order"::various;
                                  ModifyOnSalesHeaderLineTables.ModifySalesShipmentLine(SalesShipmentLine,FALSE);
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Invoice Header":
                              BEGIN
                                IF SalesInvoiceHeader.GET(SalesLineBuffer."Document No.") THEN BEGIN
                                  SalesInvoiceHeader."Status Return Order" := SalesInvoiceHeader."Status Return Order"::various;
                                  ModifyOnSalesHeaderLineTables.ModifySalesInvoiceHeader(SalesInvoiceHeader,FALSE);
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Invoice Line":
                              BEGIN
                                IF SalesInvoiceLine.GET(SalesLineBuffer."Document No.",
                                                        SalesLineBuffer."Line No.")
                                THEN BEGIN
                                  SalesInvoiceLine."Status Return Order" := SalesInvoiceLine."Status Return Order"::various;
                                  ModifyOnSalesHeaderLineTables.ModifySalesInvoiceLine(SalesInvoiceLine,FALSE);
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Cr.Memo Header":
                              BEGIN
                                IF SalesCrMemoHeader.GET(SalesLineBuffer."Document No.") THEN BEGIN
                                  SalesCrMemoHeader."Status Return Order" := SalesCrMemoHeader."Status Return Order"::various;
                                  ModifyOnSalesHeaderLineTables.ModifySalesCrMemoHeader(SalesCrMemoHeader,FALSE);
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Cr.Memo Line":
                              BEGIN
                                IF SalesCrMemoLine.GET(SalesLineBuffer."Document No.",
                                                       SalesLineBuffer."Line No.")
                                THEN BEGIN
                                  SalesCrMemoLine."Status Return Order" := SalesCrMemoLine."Status Return Order"::various;
                                  ModifyOnSalesHeaderLineTables.ModifySalesCrMemoLine(SalesCrMemoLine,FALSE);
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;
                          END;  // CASE SalesLineBuffer.TableNo OF
                        END;  // SalesLineBuffer."Status Return Order"::"R…k": BEGIN
                    END;  // CASE SalesLineBuffer."Status Return Order" OF

                    //
                    // Step 2: Offered Prevention / Prevention accepted => Customer Prevention
                    //
                    IF (SalesLineBuffer."Offered prevention" <> SalesLineBuffer."Offered prevention"::" ") OR
                       (SalesLineBuffer."Prevention accepted" <> SalesLineBuffer."Prevention accepted"::" ")
                    THEN BEGIN
                      CASE TRUE OF
                        (SalesLineBuffer."Offered prevention" = SalesLineBuffer."Offered prevention"::yes) AND
                        (SalesLineBuffer."Prevention accepted" = SalesLineBuffer."Prevention accepted"::" "):
                          BEGIN // Offered
                            CASE SalesLineBuffer.TableNo OF

                              DATABASE::"Sales Line":
                                BEGIN
                                  IF SalesLine.GET(SalesLineBuffer."Document Type",
                                                   SalesLineBuffer."Document No.",
                                                   SalesLineBuffer."Line No.")
                                  THEN BEGIN
                                    SalesLine."Customer Prevention" := SalesLine."Customer Prevention"::Offered;
                                    SalesLine.MODIFY;
                                    CounterRecordsProcessed += 1;
                                    DoCommitUpdateStatusWindow(FALSE);
                                  END;
                                END;

                              DATABASE::"Sales Line Archive":
                                BEGIN
                                  IF SalesLineArchive.GET(SalesLineBuffer."Document Type",
                                                          SalesLineBuffer."Document No.",
                                                          SalesLineBuffer."Doc. No. Occurrence",
                                                          SalesLineBuffer."Version No.",
                                                          SalesLineBuffer."Line No.")
                                  THEN BEGIN
                                    SalesLineArchive."Customer Prevention" := SalesLineArchive."Customer Prevention"::Offered;
                                    SalesLineArchive.MODIFY;
                                    CounterRecordsProcessed += 1;
                                    DoCommitUpdateStatusWindow(FALSE);
                                  END;
                                END;

                              DATABASE::"Sales Shipment Line":
                                BEGIN
                                  IF SalesShipmentLine.GET(SalesLineBuffer."Document No.",
                                                           SalesLineBuffer."Line No.")
                                  THEN BEGIN
                                    SalesShipmentLine."Customer Prevention" := SalesShipmentLine."Customer Prevention"::Offered;
                                    ModifyOnSalesHeaderLineTables.ModifySalesShipmentLine(SalesShipmentLine,FALSE);
                                    CounterRecordsProcessed += 1;
                                    DoCommitUpdateStatusWindow(FALSE);
                                  END;
                                END;

                              DATABASE::"Sales Invoice Line":
                                BEGIN
                                  IF SalesInvoiceLine.GET(SalesLineBuffer."Document No.",
                                                          SalesLineBuffer."Line No.")
                                  THEN BEGIN
                                    SalesInvoiceLine."Customer Prevention" := SalesInvoiceLine."Customer Prevention"::Offered;
                                    ModifyOnSalesHeaderLineTables.ModifySalesInvoiceLine(SalesInvoiceLine,FALSE);
                                    CounterRecordsProcessed += 1;
                                    DoCommitUpdateStatusWindow(FALSE);
                                  END;
                                END;

                              DATABASE::"Sales Cr.Memo Line":
                                BEGIN
                                  IF SalesCrMemoLine.GET(SalesLineBuffer."Document No.",
                                                         SalesLineBuffer."Line No.")
                                  THEN BEGIN
                                    SalesCrMemoLine."Customer Prevention" := SalesCrMemoLine."Customer Prevention"::Offered;
                                    ModifyOnSalesHeaderLineTables.ModifySalesCrMemoLine(SalesCrMemoLine,FALSE);
                                    CounterRecordsProcessed += 1;
                                    DoCommitUpdateStatusWindow(FALSE);
                                  END;
                                END;
                            END;  // CASE SalesLineBuffer.TableNo OF
                          END;

                        (SalesLineBuffer."Offered prevention" = SalesLineBuffer."Offered prevention"::yes) AND
                        (SalesLineBuffer."Prevention accepted" = SalesLineBuffer."Prevention accepted"::yes):
                          BEGIN // Accepted
                            CASE SalesLineBuffer.TableNo OF

                              DATABASE::"Sales Line":
                                BEGIN
                                  IF SalesLine.GET(SalesLineBuffer."Document Type",
                                                   SalesLineBuffer."Document No.",
                                                   SalesLineBuffer."Line No.")
                                  THEN BEGIN
                                    SalesLine."Customer Prevention" := SalesLine."Customer Prevention"::Accepted;
                                    SalesLine.MODIFY;
                                    CounterRecordsProcessed += 1;
                                    DoCommitUpdateStatusWindow(FALSE);
                                  END;
                                END;

                              DATABASE::"Sales Line Archive":
                                BEGIN
                                  IF SalesLineArchive.GET(SalesLineBuffer."Document Type",
                                                          SalesLineBuffer."Document No.",
                                                          SalesLineBuffer."Doc. No. Occurrence",
                                                          SalesLineBuffer."Version No.",
                                                          SalesLineBuffer."Line No.")
                                  THEN BEGIN
                                    SalesLineArchive."Customer Prevention" := SalesLineArchive."Customer Prevention"::Accepted;
                                    SalesLineArchive.MODIFY;
                                    CounterRecordsProcessed += 1;
                                    DoCommitUpdateStatusWindow(FALSE);
                                  END;
                                END;

                              DATABASE::"Sales Shipment Line":
                                BEGIN
                                  IF SalesShipmentLine.GET(SalesLineBuffer."Document No.",
                                                           SalesLineBuffer."Line No.")
                                  THEN BEGIN
                                    SalesShipmentLine."Customer Prevention" := SalesShipmentLine."Customer Prevention"::Accepted;
                                    ModifyOnSalesHeaderLineTables.ModifySalesShipmentLine(SalesShipmentLine,FALSE);
                                    CounterRecordsProcessed += 1;
                                    DoCommitUpdateStatusWindow(FALSE);
                                  END;
                                END;

                              DATABASE::"Sales Invoice Line":
                                BEGIN
                                  IF SalesInvoiceLine.GET(SalesLineBuffer."Document No.",
                                                          SalesLineBuffer."Line No.")
                                  THEN BEGIN
                                    SalesInvoiceLine."Customer Prevention" := SalesInvoiceLine."Customer Prevention"::Accepted;
                                    ModifyOnSalesHeaderLineTables.ModifySalesInvoiceLine(SalesInvoiceLine,FALSE);
                                    CounterRecordsProcessed += 1;
                                    DoCommitUpdateStatusWindow(FALSE);
                                  END;
                                END;

                              DATABASE::"Sales Cr.Memo Line":
                                BEGIN
                                  IF SalesCrMemoLine.GET(SalesLineBuffer."Document No.",
                                                         SalesLineBuffer."Line No.")
                                  THEN BEGIN
                                    SalesCrMemoLine."Customer Prevention" := SalesCrMemoLine."Customer Prevention"::Accepted;
                                    ModifyOnSalesHeaderLineTables.ModifySalesCrMemoLine(SalesCrMemoLine,FALSE);
                                    CounterRecordsProcessed += 1;
                                    DoCommitUpdateStatusWindow(FALSE);
                                  END;
                                END;
                            END;  // CASE SalesLineBuffer.TableNo OF
                          END;

                        (SalesLineBuffer."Offered prevention" = SalesLineBuffer."Offered prevention"::yes) AND
                        (SalesLineBuffer."Prevention accepted" = SalesLineBuffer."Prevention accepted"::no):
                          BEGIN // Declined
                            CASE SalesLineBuffer.TableNo OF

                              DATABASE::"Sales Line":
                                BEGIN
                                  IF SalesLine.GET(SalesLineBuffer."Document Type",
                                                   SalesLineBuffer."Document No.",
                                                   SalesLineBuffer."Line No.")
                                  THEN BEGIN
                                    SalesLine."Customer Prevention" := SalesLine."Customer Prevention"::Declined;
                                    SalesLine.MODIFY;
                                    CounterRecordsProcessed += 1;
                                    DoCommitUpdateStatusWindow(FALSE);
                                  END;
                                END;

                              DATABASE::"Sales Line Archive":
                                BEGIN
                                  IF SalesLineArchive.GET(SalesLineBuffer."Document Type",
                                                          SalesLineBuffer."Document No.",
                                                          SalesLineBuffer."Doc. No. Occurrence",
                                                          SalesLineBuffer."Version No.",
                                                          SalesLineBuffer."Line No.")
                                  THEN BEGIN
                                    SalesLineArchive."Customer Prevention" := SalesLineArchive."Customer Prevention"::Declined;
                                    SalesLineArchive.MODIFY;
                                    CounterRecordsProcessed += 1;
                                    DoCommitUpdateStatusWindow(FALSE);
                                  END;
                                END;

                              DATABASE::"Sales Shipment Line":
                                BEGIN
                                  IF SalesShipmentLine.GET(SalesLineBuffer."Document No.",
                                                           SalesLineBuffer."Line No.")
                                  THEN BEGIN
                                    SalesShipmentLine."Customer Prevention" := SalesShipmentLine."Customer Prevention"::Declined;
                                    ModifyOnSalesHeaderLineTables.ModifySalesShipmentLine(SalesShipmentLine,FALSE);
                                    CounterRecordsProcessed += 1;
                                    DoCommitUpdateStatusWindow(FALSE);
                                  END;
                                END;

                              DATABASE::"Sales Invoice Line":
                                BEGIN
                                  IF SalesInvoiceLine.GET(SalesLineBuffer."Document No.",
                                                          SalesLineBuffer."Line No.")
                                  THEN BEGIN
                                    SalesInvoiceLine."Customer Prevention" := SalesInvoiceLine."Customer Prevention"::Declined;
                                    ModifyOnSalesHeaderLineTables.ModifySalesInvoiceLine(SalesInvoiceLine,FALSE);
                                    CounterRecordsProcessed += 1;
                                    DoCommitUpdateStatusWindow(FALSE);
                                  END;
                                END;

                              DATABASE::"Sales Cr.Memo Line":
                                BEGIN
                                  IF SalesCrMemoLine.GET(SalesLineBuffer."Document No.",
                                                         SalesLineBuffer."Line No.")
                                  THEN BEGIN
                                    SalesCrMemoLine."Customer Prevention" := SalesCrMemoLine."Customer Prevention"::Declined;
                                    ModifyOnSalesHeaderLineTables.ModifySalesCrMemoLine(SalesCrMemoLine,FALSE);
                                    CounterRecordsProcessed += 1;
                                    DoCommitUpdateStatusWindow(FALSE);
                                  END;
                                END;
                            END;  // CASE SalesLineBuffer.TableNo OF
                          END;

                        ((SalesLineBuffer."Offered prevention" = SalesLineBuffer."Offered prevention"::no) AND
                         (SalesLineBuffer."Prevention accepted" = SalesLineBuffer."Prevention accepted"::" "))
                        OR
                        ((SalesLineBuffer."Offered prevention" = SalesLineBuffer."Offered prevention"::no) AND
                         (SalesLineBuffer."Prevention accepted" = SalesLineBuffer."Prevention accepted"::no)):
                          BEGIN // Not offered
                            CASE SalesLineBuffer.TableNo OF

                              DATABASE::"Sales Line":
                                BEGIN
                                  IF SalesLine.GET(SalesLineBuffer."Document Type",
                                                   SalesLineBuffer."Document No.",
                                                   SalesLineBuffer."Line No.")
                                  THEN BEGIN
                                    SalesLine."Customer Prevention" := SalesLine."Customer Prevention"::"Not offered";
                                    SalesLine.MODIFY;
                                    CounterRecordsProcessed += 1;
                                    DoCommitUpdateStatusWindow(FALSE);
                                  END;
                                END;

                              DATABASE::"Sales Line Archive":
                                BEGIN
                                  IF SalesLineArchive.GET(SalesLineBuffer."Document Type",
                                                          SalesLineBuffer."Document No.",
                                                          SalesLineBuffer."Doc. No. Occurrence",
                                                          SalesLineBuffer."Version No.",
                                                          SalesLineBuffer."Line No.")
                                  THEN BEGIN
                                    SalesLineArchive."Customer Prevention" := SalesLineArchive."Customer Prevention"::"Not offered";
                                    SalesLineArchive.MODIFY;
                                    CounterRecordsProcessed += 1;
                                    DoCommitUpdateStatusWindow(FALSE);
                                  END;
                                END;

                              DATABASE::"Sales Shipment Line":
                                BEGIN
                                  IF SalesShipmentLine.GET(SalesLineBuffer."Document No.",
                                                           SalesLineBuffer."Line No.")
                                  THEN BEGIN
                                    SalesShipmentLine."Customer Prevention" := SalesShipmentLine."Customer Prevention"::"Not offered";
                                    ModifyOnSalesHeaderLineTables.ModifySalesShipmentLine(SalesShipmentLine,FALSE);
                                    CounterRecordsProcessed += 1;
                                    DoCommitUpdateStatusWindow(FALSE);
                                  END;
                                END;

                              DATABASE::"Sales Invoice Line":
                                BEGIN
                                  IF SalesInvoiceLine.GET(SalesLineBuffer."Document No.",
                                                          SalesLineBuffer."Line No.")
                                  THEN BEGIN
                                    SalesInvoiceLine."Customer Prevention" := SalesInvoiceLine."Customer Prevention"::"Not offered";
                                    ModifyOnSalesHeaderLineTables.ModifySalesInvoiceLine(SalesInvoiceLine,FALSE);
                                    CounterRecordsProcessed += 1;
                                    DoCommitUpdateStatusWindow(FALSE);
                                  END;
                                END;

                              DATABASE::"Sales Cr.Memo Line":
                                BEGIN
                                  IF SalesCrMemoLine.GET(SalesLineBuffer."Document No.",
                                                         SalesLineBuffer."Line No.")
                                  THEN BEGIN
                                    SalesCrMemoLine."Customer Prevention" := SalesCrMemoLine."Customer Prevention"::"Not offered";
                                    ModifyOnSalesHeaderLineTables.ModifySalesCrMemoLine(SalesCrMemoLine,FALSE);
                                    CounterRecordsProcessed += 1;
                                    DoCommitUpdateStatusWindow(FALSE);
                                  END;
                                END;
                            END;  // CASE SalesLineBuffer.TableNo OF
                          END;

                        ELSE BEGIN // blank
                          CASE SalesLineBuffer.TableNo OF

                            DATABASE::"Sales Line":
                              BEGIN
                                IF SalesLine.GET(SalesLineBuffer."Document Type",
                                                 SalesLineBuffer."Document No.",
                                                 SalesLineBuffer."Line No.")
                                THEN BEGIN
                                  SalesLine."Customer Prevention" := SalesLine."Customer Prevention"::" ";
                                  SalesLine.MODIFY;
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Line Archive":
                              BEGIN
                                IF SalesLineArchive.GET(SalesLineBuffer."Document Type",
                                                        SalesLineBuffer."Document No.",
                                                        SalesLineBuffer."Doc. No. Occurrence",
                                                        SalesLineBuffer."Version No.",
                                                        SalesLineBuffer."Line No.")
                                THEN BEGIN
                                  SalesLineArchive."Customer Prevention" := SalesLineArchive."Customer Prevention"::" ";
                                  SalesLineArchive.MODIFY;
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Shipment Line":
                              BEGIN
                                IF SalesShipmentLine.GET(SalesLineBuffer."Document No.",
                                                         SalesLineBuffer."Line No.")
                                THEN BEGIN
                                  SalesShipmentLine."Customer Prevention" := SalesShipmentLine."Customer Prevention"::" ";
                                  ModifyOnSalesHeaderLineTables.ModifySalesShipmentLine(SalesShipmentLine,FALSE);
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Invoice Line":
                              BEGIN
                                IF SalesInvoiceLine.GET(SalesLineBuffer."Document No.",
                                                        SalesLineBuffer."Line No.")
                                THEN BEGIN
                                  SalesInvoiceLine."Customer Prevention" := SalesInvoiceLine."Customer Prevention"::" ";
                                  ModifyOnSalesHeaderLineTables.ModifySalesInvoiceLine(SalesInvoiceLine,FALSE);
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;

                            DATABASE::"Sales Cr.Memo Line":
                              BEGIN
                                IF SalesCrMemoLine.GET(SalesLineBuffer."Document No.",
                                                       SalesLineBuffer."Line No.")
                                THEN BEGIN
                                  SalesCrMemoLine."Customer Prevention" := SalesCrMemoLine."Customer Prevention"::" ";
                                  ModifyOnSalesHeaderLineTables.ModifySalesCrMemoLine(SalesCrMemoLine,FALSE);
                                  CounterRecordsProcessed += 1;
                                  DoCommitUpdateStatusWindow(FALSE);
                                END;
                              END;
                          END;  // CASE SalesLineBuffer.TableNo OF
                        END;  // ELSE BEGIN // blank
                      END;  // CASE TRUE OF
                    END;  // IF (SalesLineBuffer."Offered prevention" <> SalesLineBuffer."Offered prevention"::" ") OR


                    //
                    // Step 3: Header-ReturnType::Change Order => Is follow-up order
                    //
                    IF (SalesLineBuffer."Return Type" = 7) THEN BEGIN
                      CASE SalesLineBuffer.TableNo OF
                        DATABASE::"Sales Header":
                          BEGIN
                            IF SalesHeader.GET(SalesLineBuffer."Document Type",
                                               SalesLineBuffer."Document No.")
                            THEN BEGIN
                              SalesHeader."Is Follow-up Sales Order" := TRUE;
                              SalesHeader.MODIFY;
                              CounterRecordsProcessed += 1;
                              DoCommitUpdateStatusWindow(FALSE);
                            END;
                          END;
                        DATABASE::"Sales Header Archive":
                          BEGIN
                            IF SalesHeaderArchive.GET(SalesLineBuffer."Document Type",
                                                      SalesLineBuffer."Document No.",
                                                      SalesLineBuffer."Doc. No. Occurrence",
                                                      SalesLineBuffer."Version No.")
                            THEN BEGIN
                              SalesHeaderArchive."Is Follow-up Sales Order" := TRUE;
                              SalesHeaderArchive.MODIFY;
                              CounterRecordsProcessed += 1;
                              DoCommitUpdateStatusWindow(FALSE);
                            END;
                          END;
                      END;  // CASE SalesLineBuffer.TableNo OF
                    END;  // IF (SalesLineBuffer."Return Type" = 7) THEN BEGIN

                  UNTIL SalesLineBuffer.NEXT = 0;
                END;  // IF SalesLineBuffer.FIND('-') THEN BEGIN
              UNTIL Company.NEXT = 0;
            END;  // IF Company.FIND('-') THEN BEGIN
            CloseStatusWindow();
          END;

  }
  CODE
  {
    VAR
      Company@1000000002 : Record 2000000006;
      SalesLineBuffer@1000000003 : Record 50216;
      SalesLineBuffer2@1000000025 : Record 50216;
      SalesHeader@1000000022 : Record 36;
      SalesLine@1000000020 : Record 37;
      SalesHeaderArchive@1000000018 : Record 5107;
      SalesLineArchive@1000000016 : Record 5108;
      SalesCrMemoHeader@1000000013 : Record 114;
      SalesCrMemoLine@1000000011 : Record 115;
      SalesInvoiceHeader@1000000009 : Record 112;
      SalesInvoiceLine@1000000007 : Record 113;
      SalesShipmentHeader@1000000005 : Record 110;
      SalesShipmentLine@1000000001 : Record 111;
      ModifyOnSalesHeaderLineTables@1000000010 : Codeunit 50248;
      StartingDateTime@1000000019 : DateTime;
      StatusWindow@1000000015 : Dialog;
      RunTime@1000000021 : Duration;
      CommitEveryXthRecord@1000000004 : Integer;
      CounterRecordsChecked@1000000034 : Integer;
      CounterRecordsProcessed@1000000033 : Integer;
      ProgressIndicator@1000000000 : Integer;
      TableNoLast@1000000023 : Integer;
      TableNo@1000000008 : Integer;
      TotalNoOfRecordsCurrentTable@1000000026 : Integer;
      UpdateStatusEveryXthRecord@1000000006 : Integer;
      TextHME001@1000000014 : TextConst 'ENU=Convert TableFields';
      TextHME010@1000000012 : TextConst 'ENU=Ongoing process                    #1######################\';
      TextHME011@1000000032 : TextConst 'ENU=...currently processing Table      #2######################\';
      TextHME012@1000000031 : TextConst 'ENU=Total no. of records current Table #3######################\';
      TextHME013@1000000030 : TextConst 'ENU=No. of records processed sofar     #4######################\';
      TextHME014@1000000029 : TextConst 'ENU="                                   @5@@@@@@@@@@@@@@@@@@@@@@\\"';
      TextHME015@1000000028 : TextConst 'ENU=Starting time                      #6######################\';
      TextHME016@1000000027 : TextConst 'ENU=Run time                           #7######################';
      CurrentProcess@1000000017 : Text[1024];

    PROCEDURE CloseStatusWindow@1000000010();
    BEGIN
      // CloseStatusWindow
      IF CONFIRM('Execution completed. Do you wish to close the Status Window ?',FALSE) THEN BEGIN
        SLEEP(2000);
        StatusWindow.CLOSE;
      END;
    END;

    PROCEDURE OpenStatusWindow@1000000002();
    BEGIN
      // OpenStatusWindow
      StartingDateTime := CURRENTDATETIME;
      StatusWindow.OPEN(
        //TextHME010: 'Ongoing process                    #1######################\'+
        //TextHME011: '...currently processing Table      #2######################\'+
        //TextHME012: 'Total no. of records current Table #3######################\'+
        //TextHME013: 'No. of records processed sofar     #4######################\'+
        //TextHME014: '                                   @5@@@@@@@@@@@@@@@@@@@@@@\\'+
        //TextHME015: 'Starting time                      #6######################\'+
        //TextHME016: 'Run time                           #7######################',
        TextHME010+TextHME011+TextHME012+TextHME013+TextHME014+TextHME015+TextHME016,
        CurrentProcess,
        TableNoLast,
        TotalNoOfRecordsCurrentTable,
        CounterRecordsProcessed,
        ProgressIndicator,
        StartingDateTime,
        RunTime);

      CurrentProcess := TextHME001;
      StatusWindow.UPDATE(1,CurrentProcess);
      StatusWindow.UPDATE(6,StartingDateTime);
    END;

    PROCEDURE DoCommitUpdateStatusWindow@1000000006(BypassCounterV@1000000000 : Boolean);
    BEGIN
      // DoCommitUpdateStatusWindow
      IF BypassCounterV THEN BEGIN
        COMMIT;
        StatusWindow.UPDATE(3,TotalNoOfRecordsCurrentTable);
        StatusWindow.UPDATE(4,CounterRecordsProcessed);
        ProgressIndicator := ROUND(CounterRecordsChecked/TotalNoOfRecordsCurrentTable*10000,1);
        StatusWindow.UPDATE(5,ProgressIndicator);
        RunTime := CURRENTDATETIME - StartingDateTime;
        StatusWindow.UPDATE(7,RunTime);
      END ELSE BEGIN
        IF (CounterRecordsProcessed MOD CommitEveryXthRecord = 0) THEN BEGIN
          COMMIT;
        END;

        IF (CounterRecordsProcessed MOD UpdateStatusEveryXthRecord = 0) THEN BEGIN
          StatusWindow.UPDATE(3,TotalNoOfRecordsCurrentTable);
          StatusWindow.UPDATE(4,CounterRecordsProcessed);
          ProgressIndicator := ROUND(CounterRecordsChecked/TotalNoOfRecordsCurrentTable*10000,1);
          StatusWindow.UPDATE(5,ProgressIndicator);
          RunTime := CURRENTDATETIME - StartingDateTime;
          StatusWindow.UPDATE(7,RunTime);
        END;
      END;
    END;

    BEGIN
    {
      +--------------------------------------------+
      |                                            |
      |                  Home24                    |
      |       Internal Customizing by NAV-Team     |
      |                                            |
      +--------------------------------------------+

      Project No. Date     Shortcut  Description
      _____________________________________________

      H0584       28.02.14  HCN       Object created;
                                      Before running this object make sure that
                                      - C50234 has been executed
                                      - redesigned sales tables have been imported (objects)

      //H0584 28.02.14 HCN +++++++++++++++++++++++++++++
      //H0584 28.02.14 HCN -----------------------------
    }
    END.
  }
}

